
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mydomain.com/mysite/API/">
      
      
        <link rel="prev" href="../ChemicalReaction/">
      
      
        <link rel="next" href="../contacts/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>API reference - chemsynthcalc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="chemsynthcalc" class="md-header__button md-logo" aria-label="chemsynthcalc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            chemsynthcalc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Syrov-Egor/chemsynthcalc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="chemsynthcalc" class="md-nav__button md-logo" aria-label="chemsynthcalc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    chemsynthcalc
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Syrov-Egor/chemsynthcalc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ChemicalFormula/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ChemicalFormula
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ChemicalReaction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ChemicalReaction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc" class="md-nav__link">
    <span class="md-ellipsis">
      chemsynthcalc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc--chemsynthcalc" class="md-nav__link">
    <span class="md-ellipsis">
      chemsynthcalc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="chemsynthcalc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc--example-use" class="md-nav__link">
    <span class="md-ellipsis">
      Example use
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer" class="md-nav__link">
    <span class="md-ellipsis">
      balancer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="balancer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer" class="md-nav__link">
    <span class="md-ellipsis">
      Balancer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Balancer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer._intify_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      _intify_coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer.is_reaction_balanced" class="md-nav__link">
    <span class="md-ellipsis">
      is_reaction_balanced
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer._calculate_by_method" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_by_method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer.inv" class="md-nav__link">
    <span class="md-ellipsis">
      inv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer.gpinv" class="md-nav__link">
    <span class="md-ellipsis">
      gpinv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer.ppinv" class="md-nav__link">
    <span class="md-ellipsis">
      ppinv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer.comb" class="md-nav__link">
    <span class="md-ellipsis">
      comb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer.auto" class="md-nav__link">
    <span class="md-ellipsis">
      auto
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.balancing_algos" class="md-nav__link">
    <span class="md-ellipsis">
      balancing_algos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="balancing_algos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancing_algos.BalancingAlgorithms" class="md-nav__link">
    <span class="md-ellipsis">
      BalancingAlgorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BalancingAlgorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._inv_algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      _inv_algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._gpinv_algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      _gpinv_algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._ppinv_algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      _ppinv_algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._comb_algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      _comb_algorithm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors" class="md-nav__link">
    <span class="md-ellipsis">
      chem_errors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="chem_errors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.EmptyFormula" class="md-nav__link">
    <span class="md-ellipsis">
      EmptyFormula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.NoSuchAtom" class="md-nav__link">
    <span class="md-ellipsis">
      NoSuchAtom
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.InvalidCharacter" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidCharacter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.MoreThanOneAdduct" class="md-nav__link">
    <span class="md-ellipsis">
      MoreThanOneAdduct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.BracketsNotPaired" class="md-nav__link">
    <span class="md-ellipsis">
      BracketsNotPaired
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.EmptyReaction" class="md-nav__link">
    <span class="md-ellipsis">
      EmptyReaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.NoSuchMode" class="md-nav__link">
    <span class="md-ellipsis">
      NoSuchMode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.NoSuchAlgorithm" class="md-nav__link">
    <span class="md-ellipsis">
      NoSuchAlgorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.NoSeparator" class="md-nav__link">
    <span class="md-ellipsis">
      NoSeparator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.ReactionNotBalanced" class="md-nav__link">
    <span class="md-ellipsis">
      ReactionNotBalanced
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.ReactantProductDifference" class="md-nav__link">
    <span class="md-ellipsis">
      ReactantProductDifference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.BadCoeffiecients" class="md-nav__link">
    <span class="md-ellipsis">
      BadCoeffiecients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.BalancingError" class="md-nav__link">
    <span class="md-ellipsis">
      BalancingError
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output" class="md-nav__link">
    <span class="md-ellipsis">
      chem_output
    </span>
  </a>
  
    <nav class="md-nav" aria-label="chem_output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput" class="md-nav__link">
    <span class="md-ellipsis">
      ChemicalOutput
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChemicalOutput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput._round_values" class="md-nav__link">
    <span class="md-ellipsis">
      _round_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput._generate_filename" class="md-nav__link">
    <span class="md-ellipsis">
      _generate_filename
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput._print_additional_reaction_results" class="md-nav__link">
    <span class="md-ellipsis">
      _print_additional_reaction_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput._print_stream" class="md-nav__link">
    <span class="md-ellipsis">
      _print_stream
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput.print_results" class="md-nav__link">
    <span class="md-ellipsis">
      print_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput.write_to_txt" class="md-nav__link">
    <span class="md-ellipsis">
      write_to_txt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput.dump_to_json" class="md-nav__link">
    <span class="md-ellipsis">
      dump_to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput.write_to_json_file" class="md-nav__link">
    <span class="md-ellipsis">
      write_to_json_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula" class="md-nav__link">
    <span class="md-ellipsis">
      chemical_formula
    </span>
  </a>
  
    <nav class="md-nav" aria-label="chemical_formula">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula" class="md-nav__link">
    <span class="md-ellipsis">
      ChemicalFormula
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChemicalFormula">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.formula" class="md-nav__link">
    <span class="md-ellipsis">
      formula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.parsed_formula" class="md-nav__link">
    <span class="md-ellipsis">
      parsed_formula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.molar_mass" class="md-nav__link">
    <span class="md-ellipsis">
      molar_mass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.mass_percent" class="md-nav__link">
    <span class="md-ellipsis">
      mass_percent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.atomic_percent" class="md-nav__link">
    <span class="md-ellipsis">
      atomic_percent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.oxide_percent" class="md-nav__link">
    <span class="md-ellipsis">
      oxide_percent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.output_results" class="md-nav__link">
    <span class="md-ellipsis">
      output_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.print_results" class="md-nav__link">
    <span class="md-ellipsis">
      print_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.to_txt" class="md-nav__link">
    <span class="md-ellipsis">
      to_txt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.to_json_file" class="md-nav__link">
    <span class="md-ellipsis">
      to_json_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      chemical_reaction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="chemical_reaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction" class="md-nav__link">
    <span class="md-ellipsis">
      ChemicalReaction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChemicalReaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.reaction" class="md-nav__link">
    <span class="md-ellipsis">
      reaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.decomposed_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      decomposed_reaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction._calculated_target" class="md-nav__link">
    <span class="md-ellipsis">
      _calculated_target
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.chemformula_objs" class="md-nav__link">
    <span class="md-ellipsis">
      chemformula_objs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.parsed_formulas" class="md-nav__link">
    <span class="md-ellipsis">
      parsed_formulas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.matrix" class="md-nav__link">
    <span class="md-ellipsis">
      matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.balancer" class="md-nav__link">
    <span class="md-ellipsis">
      balancer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.molar_masses" class="md-nav__link">
    <span class="md-ellipsis">
      molar_masses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.normalized_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      normalized_coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.is_balanced" class="md-nav__link">
    <span class="md-ellipsis">
      is_balanced
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.final_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      final_reaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.final_reaction_normalized" class="md-nav__link">
    <span class="md-ellipsis">
      final_reaction_normalized
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.masses" class="md-nav__link">
    <span class="md-ellipsis">
      masses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.output_results" class="md-nav__link">
    <span class="md-ellipsis">
      output_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction._generate_final_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      _generate_final_reaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.print_results" class="md-nav__link">
    <span class="md-ellipsis">
      print_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.to_txt" class="md-nav__link">
    <span class="md-ellipsis">
      to_txt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.to_json_file" class="md-nav__link">
    <span class="md-ellipsis">
      to_json_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.coefs" class="md-nav__link">
    <span class="md-ellipsis">
      coefs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="coefs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.coefs.Coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      Coefficients
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Coefficients">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.coefs.Coefficients._calculate_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.coefs.Coefficients.coefficients_validation" class="md-nav__link">
    <span class="md-ellipsis">
      coefficients_validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.coefs.Coefficients._element_count_validation" class="md-nav__link">
    <span class="md-ellipsis">
      _element_count_validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.coefs.Coefficients.get_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      get_coefficients
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.formula" class="md-nav__link">
    <span class="md-ellipsis">
      formula
    </span>
  </a>
  
    <nav class="md-nav" aria-label="formula">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula.Formula" class="md-nav__link">
    <span class="md-ellipsis">
      Formula
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser" class="md-nav__link">
    <span class="md-ellipsis">
      formula_parser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="formula_parser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser.ChemicalFormulaParser" class="md-nav__link">
    <span class="md-ellipsis">
      ChemicalFormulaParser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChemicalFormulaParser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser.ChemicalFormulaParser._dictify" class="md-nav__link">
    <span class="md-ellipsis">
      _dictify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser.ChemicalFormulaParser._fuse" class="md-nav__link">
    <span class="md-ellipsis">
      _fuse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser.ChemicalFormulaParser._parse" class="md-nav__link">
    <span class="md-ellipsis">
      _parse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser.ChemicalFormulaParser._order_output_dict" class="md-nav__link">
    <span class="md-ellipsis">
      _order_output_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.parse_formula" class="md-nav__link">
    <span class="md-ellipsis">
      parse_formula
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator" class="md-nav__link">
    <span class="md-ellipsis">
      formula_validator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="formula_validator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator" class="md-nav__link">
    <span class="md-ellipsis">
      FormulaValidator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FormulaValidator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator._check_empty_formula" class="md-nav__link">
    <span class="md-ellipsis">
      _check_empty_formula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator._invalid_charachers" class="md-nav__link">
    <span class="md-ellipsis">
      _invalid_charachers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator._invalid_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      _invalid_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator._bracket_balance" class="md-nav__link">
    <span class="md-ellipsis">
      _bracket_balance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator._num_of_adducts" class="md-nav__link">
    <span class="md-ellipsis">
      _num_of_adducts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator.validate_formula" class="md-nav__link">
    <span class="md-ellipsis">
      validate_formula
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass" class="md-nav__link">
    <span class="md-ellipsis">
      molar_mass
    </span>
  </a>
  
    <nav class="md-nav" aria-label="molar_mass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.Oxide" class="md-nav__link">
    <span class="md-ellipsis">
      Oxide
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation" class="md-nav__link">
    <span class="md-ellipsis">
      MolarMassCalculation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MolarMassCalculation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation._calculate_atomic_masses" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_atomic_masses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation.calculate_molar_mass" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_molar_mass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation.calculate_mass_percent" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_mass_percent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation.calculate_atomic_percent" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_atomic_percent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation._custom_oxides_input" class="md-nav__link">
    <span class="md-ellipsis">
      _custom_oxides_input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation.calculate_oxide_percent" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_oxide_percent
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.periodic_table" class="md-nav__link">
    <span class="md-ellipsis">
      periodic_table
    </span>
  </a>
  
    <nav class="md-nav" aria-label="periodic_table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.periodic_table.Atom" class="md-nav__link">
    <span class="md-ellipsis">
      Atom
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.periodic_table.PeriodicTable" class="md-nav__link">
    <span class="md-ellipsis">
      PeriodicTable
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction" class="md-nav__link">
    <span class="md-ellipsis">
      reaction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction.Reaction" class="md-nav__link">
    <span class="md-ellipsis">
      Reaction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction.Reaction.extract_separator" class="md-nav__link">
    <span class="md-ellipsis">
      extract_separator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_decomposer" class="md-nav__link">
    <span class="md-ellipsis">
      reaction_decomposer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reaction_decomposer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_decomposer.ReactionDecomposer" class="md-nav__link">
    <span class="md-ellipsis">
      ReactionDecomposer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ReactionDecomposer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_decomposer.ReactionDecomposer.split_coefficient_from_formula" class="md-nav__link">
    <span class="md-ellipsis">
      split_coefficient_from_formula
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      reaction_matrix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reaction_matrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_matrix.ChemicalReactionMatrix" class="md-nav__link">
    <span class="md-ellipsis">
      ChemicalReactionMatrix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChemicalReactionMatrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_matrix.ChemicalReactionMatrix.create_reaction_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      create_reaction_matrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator" class="md-nav__link">
    <span class="md-ellipsis">
      reaction_validator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reaction_validator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator.ReactionValidator" class="md-nav__link">
    <span class="md-ellipsis">
      ReactionValidator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ReactionValidator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator.ReactionValidator._check_empty_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      _check_empty_reaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator.ReactionValidator._invalid_charachers" class="md-nav__link">
    <span class="md-ellipsis">
      _invalid_charachers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator.ReactionValidator._no_reaction_separator" class="md-nav__link">
    <span class="md-ellipsis">
      _no_reaction_separator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator.ReactionValidator._no_reactant_separator" class="md-nav__link">
    <span class="md-ellipsis">
      _no_reactant_separator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator.ReactionValidator.validate_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      validate_reaction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.utils.round_dict_content" class="md-nav__link">
    <span class="md-ellipsis">
      round_dict_content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.utils.to_integer" class="md-nav__link">
    <span class="md-ellipsis">
      to_integer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.utils.find_lcm" class="md-nav__link">
    <span class="md-ellipsis">
      find_lcm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.utils.find_gcd" class="md-nav__link">
    <span class="md-ellipsis">
      find_gcd
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contacts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contacts
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc" class="md-nav__link">
    <span class="md-ellipsis">
      chemsynthcalc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc--chemsynthcalc" class="md-nav__link">
    <span class="md-ellipsis">
      chemsynthcalc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="chemsynthcalc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc--example-use" class="md-nav__link">
    <span class="md-ellipsis">
      Example use
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer" class="md-nav__link">
    <span class="md-ellipsis">
      balancer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="balancer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer" class="md-nav__link">
    <span class="md-ellipsis">
      Balancer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Balancer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer._intify_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      _intify_coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer.is_reaction_balanced" class="md-nav__link">
    <span class="md-ellipsis">
      is_reaction_balanced
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer._calculate_by_method" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_by_method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer.inv" class="md-nav__link">
    <span class="md-ellipsis">
      inv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer.gpinv" class="md-nav__link">
    <span class="md-ellipsis">
      gpinv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer.ppinv" class="md-nav__link">
    <span class="md-ellipsis">
      ppinv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer.comb" class="md-nav__link">
    <span class="md-ellipsis">
      comb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancer.Balancer.auto" class="md-nav__link">
    <span class="md-ellipsis">
      auto
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.balancing_algos" class="md-nav__link">
    <span class="md-ellipsis">
      balancing_algos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="balancing_algos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancing_algos.BalancingAlgorithms" class="md-nav__link">
    <span class="md-ellipsis">
      BalancingAlgorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BalancingAlgorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._inv_algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      _inv_algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._gpinv_algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      _gpinv_algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._ppinv_algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      _ppinv_algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._comb_algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      _comb_algorithm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors" class="md-nav__link">
    <span class="md-ellipsis">
      chem_errors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="chem_errors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.EmptyFormula" class="md-nav__link">
    <span class="md-ellipsis">
      EmptyFormula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.NoSuchAtom" class="md-nav__link">
    <span class="md-ellipsis">
      NoSuchAtom
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.InvalidCharacter" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidCharacter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.MoreThanOneAdduct" class="md-nav__link">
    <span class="md-ellipsis">
      MoreThanOneAdduct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.BracketsNotPaired" class="md-nav__link">
    <span class="md-ellipsis">
      BracketsNotPaired
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.EmptyReaction" class="md-nav__link">
    <span class="md-ellipsis">
      EmptyReaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.NoSuchMode" class="md-nav__link">
    <span class="md-ellipsis">
      NoSuchMode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.NoSuchAlgorithm" class="md-nav__link">
    <span class="md-ellipsis">
      NoSuchAlgorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.NoSeparator" class="md-nav__link">
    <span class="md-ellipsis">
      NoSeparator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.ReactionNotBalanced" class="md-nav__link">
    <span class="md-ellipsis">
      ReactionNotBalanced
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.ReactantProductDifference" class="md-nav__link">
    <span class="md-ellipsis">
      ReactantProductDifference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.BadCoeffiecients" class="md-nav__link">
    <span class="md-ellipsis">
      BadCoeffiecients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_errors.BalancingError" class="md-nav__link">
    <span class="md-ellipsis">
      BalancingError
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output" class="md-nav__link">
    <span class="md-ellipsis">
      chem_output
    </span>
  </a>
  
    <nav class="md-nav" aria-label="chem_output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput" class="md-nav__link">
    <span class="md-ellipsis">
      ChemicalOutput
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChemicalOutput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput._round_values" class="md-nav__link">
    <span class="md-ellipsis">
      _round_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput._generate_filename" class="md-nav__link">
    <span class="md-ellipsis">
      _generate_filename
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput._print_additional_reaction_results" class="md-nav__link">
    <span class="md-ellipsis">
      _print_additional_reaction_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput._print_stream" class="md-nav__link">
    <span class="md-ellipsis">
      _print_stream
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput.print_results" class="md-nav__link">
    <span class="md-ellipsis">
      print_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput.write_to_txt" class="md-nav__link">
    <span class="md-ellipsis">
      write_to_txt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput.dump_to_json" class="md-nav__link">
    <span class="md-ellipsis">
      dump_to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chem_output.ChemicalOutput.write_to_json_file" class="md-nav__link">
    <span class="md-ellipsis">
      write_to_json_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula" class="md-nav__link">
    <span class="md-ellipsis">
      chemical_formula
    </span>
  </a>
  
    <nav class="md-nav" aria-label="chemical_formula">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula" class="md-nav__link">
    <span class="md-ellipsis">
      ChemicalFormula
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChemicalFormula">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.formula" class="md-nav__link">
    <span class="md-ellipsis">
      formula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.parsed_formula" class="md-nav__link">
    <span class="md-ellipsis">
      parsed_formula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.molar_mass" class="md-nav__link">
    <span class="md-ellipsis">
      molar_mass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.mass_percent" class="md-nav__link">
    <span class="md-ellipsis">
      mass_percent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.atomic_percent" class="md-nav__link">
    <span class="md-ellipsis">
      atomic_percent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.oxide_percent" class="md-nav__link">
    <span class="md-ellipsis">
      oxide_percent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.output_results" class="md-nav__link">
    <span class="md-ellipsis">
      output_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.print_results" class="md-nav__link">
    <span class="md-ellipsis">
      print_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.to_txt" class="md-nav__link">
    <span class="md-ellipsis">
      to_txt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_formula.ChemicalFormula.to_json_file" class="md-nav__link">
    <span class="md-ellipsis">
      to_json_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      chemical_reaction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="chemical_reaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction" class="md-nav__link">
    <span class="md-ellipsis">
      ChemicalReaction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChemicalReaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.reaction" class="md-nav__link">
    <span class="md-ellipsis">
      reaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.decomposed_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      decomposed_reaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction._calculated_target" class="md-nav__link">
    <span class="md-ellipsis">
      _calculated_target
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.chemformula_objs" class="md-nav__link">
    <span class="md-ellipsis">
      chemformula_objs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.parsed_formulas" class="md-nav__link">
    <span class="md-ellipsis">
      parsed_formulas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.matrix" class="md-nav__link">
    <span class="md-ellipsis">
      matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.balancer" class="md-nav__link">
    <span class="md-ellipsis">
      balancer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.molar_masses" class="md-nav__link">
    <span class="md-ellipsis">
      molar_masses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.normalized_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      normalized_coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.is_balanced" class="md-nav__link">
    <span class="md-ellipsis">
      is_balanced
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.final_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      final_reaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.final_reaction_normalized" class="md-nav__link">
    <span class="md-ellipsis">
      final_reaction_normalized
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.masses" class="md-nav__link">
    <span class="md-ellipsis">
      masses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.output_results" class="md-nav__link">
    <span class="md-ellipsis">
      output_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction._generate_final_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      _generate_final_reaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.print_results" class="md-nav__link">
    <span class="md-ellipsis">
      print_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.to_txt" class="md-nav__link">
    <span class="md-ellipsis">
      to_txt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.chemical_reaction.ChemicalReaction.to_json_file" class="md-nav__link">
    <span class="md-ellipsis">
      to_json_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.coefs" class="md-nav__link">
    <span class="md-ellipsis">
      coefs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="coefs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.coefs.Coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      Coefficients
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Coefficients">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.coefs.Coefficients._calculate_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.coefs.Coefficients.coefficients_validation" class="md-nav__link">
    <span class="md-ellipsis">
      coefficients_validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.coefs.Coefficients._element_count_validation" class="md-nav__link">
    <span class="md-ellipsis">
      _element_count_validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.coefs.Coefficients.get_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      get_coefficients
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.formula" class="md-nav__link">
    <span class="md-ellipsis">
      formula
    </span>
  </a>
  
    <nav class="md-nav" aria-label="formula">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula.Formula" class="md-nav__link">
    <span class="md-ellipsis">
      Formula
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser" class="md-nav__link">
    <span class="md-ellipsis">
      formula_parser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="formula_parser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser.ChemicalFormulaParser" class="md-nav__link">
    <span class="md-ellipsis">
      ChemicalFormulaParser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChemicalFormulaParser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser.ChemicalFormulaParser._dictify" class="md-nav__link">
    <span class="md-ellipsis">
      _dictify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser.ChemicalFormulaParser._fuse" class="md-nav__link">
    <span class="md-ellipsis">
      _fuse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser.ChemicalFormulaParser._parse" class="md-nav__link">
    <span class="md-ellipsis">
      _parse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser.ChemicalFormulaParser._order_output_dict" class="md-nav__link">
    <span class="md-ellipsis">
      _order_output_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.parse_formula" class="md-nav__link">
    <span class="md-ellipsis">
      parse_formula
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator" class="md-nav__link">
    <span class="md-ellipsis">
      formula_validator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="formula_validator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator" class="md-nav__link">
    <span class="md-ellipsis">
      FormulaValidator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FormulaValidator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator._check_empty_formula" class="md-nav__link">
    <span class="md-ellipsis">
      _check_empty_formula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator._invalid_charachers" class="md-nav__link">
    <span class="md-ellipsis">
      _invalid_charachers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator._invalid_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      _invalid_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator._bracket_balance" class="md-nav__link">
    <span class="md-ellipsis">
      _bracket_balance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator._num_of_adducts" class="md-nav__link">
    <span class="md-ellipsis">
      _num_of_adducts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.formula_validator.FormulaValidator.validate_formula" class="md-nav__link">
    <span class="md-ellipsis">
      validate_formula
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass" class="md-nav__link">
    <span class="md-ellipsis">
      molar_mass
    </span>
  </a>
  
    <nav class="md-nav" aria-label="molar_mass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.Oxide" class="md-nav__link">
    <span class="md-ellipsis">
      Oxide
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation" class="md-nav__link">
    <span class="md-ellipsis">
      MolarMassCalculation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MolarMassCalculation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation._calculate_atomic_masses" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_atomic_masses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation.calculate_molar_mass" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_molar_mass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation.calculate_mass_percent" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_mass_percent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation.calculate_atomic_percent" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_atomic_percent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation._custom_oxides_input" class="md-nav__link">
    <span class="md-ellipsis">
      _custom_oxides_input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.molar_mass.MolarMassCalculation.calculate_oxide_percent" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_oxide_percent
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.periodic_table" class="md-nav__link">
    <span class="md-ellipsis">
      periodic_table
    </span>
  </a>
  
    <nav class="md-nav" aria-label="periodic_table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.periodic_table.Atom" class="md-nav__link">
    <span class="md-ellipsis">
      Atom
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.periodic_table.PeriodicTable" class="md-nav__link">
    <span class="md-ellipsis">
      PeriodicTable
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction" class="md-nav__link">
    <span class="md-ellipsis">
      reaction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction.Reaction" class="md-nav__link">
    <span class="md-ellipsis">
      Reaction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction.Reaction.extract_separator" class="md-nav__link">
    <span class="md-ellipsis">
      extract_separator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_decomposer" class="md-nav__link">
    <span class="md-ellipsis">
      reaction_decomposer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reaction_decomposer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_decomposer.ReactionDecomposer" class="md-nav__link">
    <span class="md-ellipsis">
      ReactionDecomposer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ReactionDecomposer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_decomposer.ReactionDecomposer.split_coefficient_from_formula" class="md-nav__link">
    <span class="md-ellipsis">
      split_coefficient_from_formula
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      reaction_matrix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reaction_matrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_matrix.ChemicalReactionMatrix" class="md-nav__link">
    <span class="md-ellipsis">
      ChemicalReactionMatrix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChemicalReactionMatrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_matrix.ChemicalReactionMatrix.create_reaction_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      create_reaction_matrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator" class="md-nav__link">
    <span class="md-ellipsis">
      reaction_validator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reaction_validator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator.ReactionValidator" class="md-nav__link">
    <span class="md-ellipsis">
      ReactionValidator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ReactionValidator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator.ReactionValidator._check_empty_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      _check_empty_reaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator.ReactionValidator._invalid_charachers" class="md-nav__link">
    <span class="md-ellipsis">
      _invalid_charachers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator.ReactionValidator._no_reaction_separator" class="md-nav__link">
    <span class="md-ellipsis">
      _no_reaction_separator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator.ReactionValidator._no_reactant_separator" class="md-nav__link">
    <span class="md-ellipsis">
      _no_reactant_separator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.reaction_validator.ReactionValidator.validate_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      validate_reaction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemsynthcalc.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.utils.round_dict_content" class="md-nav__link">
    <span class="md-ellipsis">
      round_dict_content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.utils.to_integer" class="md-nav__link">
    <span class="md-ellipsis">
      to_integer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.utils.find_lcm" class="md-nav__link">
    <span class="md-ellipsis">
      find_lcm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chemsynthcalc.utils.find_gcd" class="md-nav__link">
    <span class="md-ellipsis">
      find_gcd
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="api-reference">API reference</h1>


<div class="doc doc-object doc-module">



<a id="chemsynthcalc"></a>
    <div class="doc doc-contents first">

        <h2 id="chemsynthcalc--chemsynthcalc">chemsynthcalc</h2>
<p>Python package for calculating the masses of substances required for chemical synthesis directly from the reaction string.
It includes solutions for all intermediate steps, including chemical formula parsing, molar mass calculation and reaction
balancing with different matrix methods.</p>
<h3 id="chemsynthcalc--example-use">Example use</h3>
<p>Let's say that we need to prepare 3 grams of <a href="https://en.wikipedia.org/wiki/Yttrium_barium_copper_oxide">YBCO</a> by solid-state synthesis from respective carbonates. The reaction string will look something like this (to simplify, let's leave it without oxygen nonstoichiometry):</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">chemsynthcalc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChemicalReaction</span>

<span class="n">reaction_string</span> <span class="o">=</span> <span class="s2">&quot;BaCO3 + Y2(CO3)3 + CuCO3 + O2 → YBa2Cu3O7 + CO2&quot;</span>
</code></pre></div>
<p>Now, we can create a chemical reaction object of the <code>ChemicalReaction</code> class, which will be used in the calculation. We need to specify the arguments for our particular case:
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span>
    <span class="n">reaction</span> <span class="o">=</span> <span class="n">reaction_string</span><span class="p">,</span> <span class="c1"># our reaction string</span>
    <span class="n">target</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># index of target compound in the product list</span>
    <span class="n">target_mass</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="c1"># desired mass of target compound,</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;balance&quot;</span> <span class="c1"># mode of coefficients calculations,</span>
<span class="p">)</span>
</code></pre></div></p>
<p>Now, to perform the automatic calculation, all we need to do is to put:
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">reaction</span><span class="o">.</span><span class="n">print_results</span><span class="p">(</span><span class="n">print_rounding_order</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="c1"># assuming that we use analytical balances with 4 digit presicion</span>
</code></pre></div></p>
<p>And we get our output in the terminal:
<div class="highlight"><pre><span></span><code>initial reaction: BaCO3+Y2(CO3)3+CuCO3+O2→YBa2Cu3O7+CO2
reaction matrix:
 [[1. 0. 0. 0. 2. 0.]
 [1. 3. 1. 0. 0. 1.]
 [3. 9. 3. 2. 7. 2.]
 [0. 2. 0. 0. 1. 0.]
 [0. 0. 1. 0. 3. 0.]]
mode: balance
formulas: [&#39;BaCO3&#39;, &#39;Y2(CO3)3&#39;, &#39;CuCO3&#39;, &#39;O2&#39;, &#39;YBa2Cu3O7&#39;, &#39;CO2&#39;]
coefficients: [8, 2, 12, 1, 4, 26]
normalized coefficients: [2, 0.5, 3, 0.25, 1, 6.5]
algorithm: inverse
is balanced: True
final reaction: 8BaCO3+2Y2(CO3)3+12CuCO3+O2→4YBa2Cu3O7+26CO2
final reaction normalized: 2BaCO3+0.5Y2(CO3)3+3CuCO3+0.25O2→YBa2Cu3O7+6.5CO2
molar masses: [197.335, 357.835676, 123.554, 31.998, 666.190838, 44.009]
target: YBa2Cu3O7
masses: [1.7773, 0.8057, 1.6692, 0.036, 3.0, 1.2882]
BaCO3: M = 197.3350 g/mol, m = 1.7773 g
Y2(CO3)3: M = 357.8357 g/mol, m = 0.8057 g
CuCO3: M = 123.5540 g/mol, m = 1.6692 g
O2: M = 31.9980 g/mol, m = 0.0360 g
YBa2Cu3O7: M = 666.1908 g/mol, m = 3.0000 g
CO2: M = 44.0090 g/mol, m = 1.2882 g
</code></pre></div></p>









  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.balancer" class="doc doc-heading">
            <code>balancer</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.balancer.Balancer" class="doc doc-heading">
            <code>Balancer</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BalancingAlgorithms (chemsynthcalc.balancing_algos.BalancingAlgorithms)" href="#chemsynthcalc.balancing_algos.BalancingAlgorithms">BalancingAlgorithms</a></code></p>


        <p>A class for balancing chemical equations automatically by different matrix methods.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>matrix</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reaction matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>separator_pos</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Position of the reaction separator (usually the separator is "=")</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>round_precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coefficients rounding precision</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>intify</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Determines whether the coefficients should be integers</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.balancer.Balancer.coef_limit">coef_limit</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>max integer coefficient for         <a class="autorefs autorefs-internal" title="_intify_coefficients(coefficients, limit)" href="#chemsynthcalc.balancer.Balancer._intify_coefficients">_intify_coefficients</a> method</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/balancer.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Balancer</span><span class="p">(</span><span class="n">BalancingAlgorithms</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for balancing chemical equations automatically by different matrix methods.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        matrix (npt.NDArray[np.float64]): Reaction matrix</span>
<span class="sd">        separator_pos (int): Position of the reaction separator (usually the separator is &quot;=&quot;)</span>
<span class="sd">        round_precision (int): Coefficients rounding precision</span>
<span class="sd">        intify (bool): Determines whether the coefficients should be integers</span>

<span class="sd">    Attributes:</span>
<span class="sd">        coef_limit (int): max integer coefficient for \</span>
<span class="sd">        [_intify_coefficients][chemsynthcalc.balancer.Balancer._intify_coefficients] method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">matrix</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">separator_pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">round_precision</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">intify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">separator_pos</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">round_precision</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">round_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">round_precision</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;precision &lt;= 0&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">intify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">intify</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coef_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1_000_000</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Balancer object for matrix </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Balancer(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">separator_pos</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">round_precision</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">intify</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_intify_coefficients</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reduce the coefficients to integers by finding the greatest common divider.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            coefficients (list): List of coefficients to intify</span>
<span class="sd">            limit (int): Upper limit (max int coef)</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of intified coefficients</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">initial_coefficients</span> <span class="o">=</span> <span class="n">coefficients</span>
        <span class="n">frac</span> <span class="o">=</span> <span class="p">[</span><span class="n">Fraction</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coefficients</span><span class="p">]</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">int</span><span class="p">(</span>
                <span class="n">fr</span><span class="o">.</span><span class="n">numerator</span>
                <span class="o">*</span> <span class="n">find_lcm</span><span class="p">([</span><span class="n">fr</span><span class="o">.</span><span class="n">denominator</span> <span class="k">for</span> <span class="n">fr</span> <span class="ow">in</span> <span class="n">frac</span><span class="p">])</span>
                <span class="o">/</span> <span class="n">fr</span><span class="o">.</span><span class="n">denominator</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">fr</span> <span class="ow">in</span> <span class="n">frac</span>
        <span class="p">]</span>
        <span class="n">coefficients</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span> <span class="o">/</span> <span class="n">find_gcd</span><span class="p">(</span><span class="n">vals</span><span class="p">))</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">limit</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coefficients</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">initial_coefficients</span>
        <span class="k">return</span> <span class="n">coefficients</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_reaction_balanced</span><span class="p">(</span>
        <span class="n">reactant_matrix</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">product_matrix</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if reaction is balanced by multiplying reactant matrix and product matrix</span>
<span class="sd">        by the respective coefficient vector. Method is static to call it outside of balancer</span>
<span class="sd">        instance.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            reactant_matrix (npt.NDArray[np.float64]): Matrix of reactants property generated by [ChemicalReaction][chemsynthcalc.chemical_reaction.ChemicalReaction] class</span>
<span class="sd">            product_matrix (npt.NDArray[np.float64]): Matrix of products property generated by [ChemicalReaction][chemsynthcalc.chemical_reaction.ChemicalReaction] class</span>
<span class="sd">            coefficients (list[float] | list[int]): Coefficients</span>
<span class="sd">            tolerance (float): tolerance limit for the *np.allclose* function</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if balanced within tolerance</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; reaction = ChemicalReaction(&quot;NH4ClO4+HNO3+HCl=HClO4+NOCl+N2O+N2O3+H2O+Cl2&quot;)</span>
<span class="sd">            &gt;&gt;&gt; Balancer.is_reaction_balanced(reaction.reactant_matrix, reaction.product_matrix, [64, 167, 137, 80, 43, 64, 30, 240, 39])</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; reaction = ChemicalReaction(&quot;H2+O2=H2O&quot;)</span>
<span class="sd">            &gt;&gt;&gt; Balancer.is_reaction_balanced(reaction.reactant_matrix, reaction.product_matrix, [2,2,2])</span>
<span class="sd">            False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">reactants</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span>
                <span class="n">reactant_matrix</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)[:</span> <span class="n">reactant_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">products</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span>
                <span class="n">product_matrix</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)[</span><span class="n">reactant_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
                <span class="n">reactants</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">products</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">rtol</span><span class="o">=</span><span class="n">tolerance</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_by_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the coefficients list by a specific method.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            method (str): One of 4 currently implemented methods (inv, gpinv, ppinv, comb)</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of coefficients</span>

<span class="sd">        Raise:</span>
<span class="sd">            ValueError if method is not found. &lt;br /&gt;</span>
<span class="sd">            [BalancingError][chemsynthcalc.chem_errors.BalancingError] if can&#39;t balance reaction by specified method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">method</span><span class="p">:</span>

            <span class="k">case</span> <span class="s2">&quot;inv&quot;</span><span class="p">:</span>
                <span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_inv_algorithm</span><span class="p">(),</span> <span class="n">decimals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">round_precision</span>
                <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># type: ignore</span>

            <span class="k">case</span> <span class="s2">&quot;gpinv&quot;</span><span class="p">:</span>
                <span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_gpinv_algorithm</span><span class="p">(),</span> <span class="n">decimals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">round_precision</span> <span class="o">+</span> <span class="mi">2</span>
                <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># type: ignore</span>

            <span class="k">case</span> <span class="s2">&quot;ppinv&quot;</span><span class="p">:</span>
                <span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_ppinv_algorithm</span><span class="p">(),</span> <span class="n">decimals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">round_precision</span> <span class="o">+</span> <span class="mi">2</span>
                <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># type: ignore</span>

            <span class="k">case</span> <span class="s2">&quot;comb&quot;</span><span class="p">:</span>
                <span class="n">res</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comb_algorithm</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">BalancingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t balance reaction by </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> method&quot;</span><span class="p">)</span>

            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No method </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">Balancer</span><span class="o">.</span><span class="n">is_reaction_balanced</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="n">coefficients</span>
            <span class="p">)</span>
            <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coefficients</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">intify</span><span class="p">:</span>
                <span class="n">intified</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intify_coefficients</span><span class="p">(</span><span class="n">coefficients</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coef_limit</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">coef_limit</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">intified</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">intified</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">coefficients</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">coefficients</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BalancingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t balance reaction by </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> method&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A high-level function call to compute coefficients by Thorne method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of coefficients</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_by_method</span><span class="p">(</span><span class="s2">&quot;inv&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">gpinv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A high-level function call to compute coefficients by</span>
<span class="sd">        Risteski general pseudoinverse method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of coefficients</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_by_method</span><span class="p">(</span><span class="s2">&quot;gpinv&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ppinv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A high-level function call to compute coefficients by</span>
<span class="sd">        Risteski partial pseudoinverse method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of coefficients</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_by_method</span><span class="p">(</span><span class="s2">&quot;ppinv&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">comb</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A high-level function call to compute coefficients by</span>
<span class="sd">        combinatorial method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of coefficients</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_by_method</span><span class="p">(</span><span class="s2">&quot;comb&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">auto</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A high-level function call to automatically compute coefficients</span>
<span class="sd">        by sequentially calling inv, gpinv, ppinv methods.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of coefficients</span>

<span class="sd">        Raise:</span>
<span class="sd">            [BalancingError][chemsynthcalc.chem_errors.BalancingError] if can&#39;t balance reaction by any method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv</span><span class="p">(),</span> <span class="s2">&quot;inverse&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gpinv</span><span class="p">(),</span> <span class="s2">&quot;general pseudoinverse&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gpinv</span><span class="p">(),</span> <span class="s2">&quot;partial pseudoinverse&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BalancingError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t balance this reaction by any method&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.balancer.Balancer._intify_coefficients" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_intify_coefficients</span><span class="p">(</span><span class="n">coefficients</span><span class="p">,</span> <span class="n">limit</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Reduce the coefficients to integers by finding the greatest common divider.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>coefficients</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of coefficients to intify</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>limit</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper limit (max int coef)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>] | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of intified coefficients</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/balancer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_intify_coefficients</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reduce the coefficients to integers by finding the greatest common divider.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        coefficients (list): List of coefficients to intify</span>
<span class="sd">        limit (int): Upper limit (max int coef)</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of intified coefficients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">initial_coefficients</span> <span class="o">=</span> <span class="n">coefficients</span>
    <span class="n">frac</span> <span class="o">=</span> <span class="p">[</span><span class="n">Fraction</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coefficients</span><span class="p">]</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">int</span><span class="p">(</span>
            <span class="n">fr</span><span class="o">.</span><span class="n">numerator</span>
            <span class="o">*</span> <span class="n">find_lcm</span><span class="p">([</span><span class="n">fr</span><span class="o">.</span><span class="n">denominator</span> <span class="k">for</span> <span class="n">fr</span> <span class="ow">in</span> <span class="n">frac</span><span class="p">])</span>
            <span class="o">/</span> <span class="n">fr</span><span class="o">.</span><span class="n">denominator</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">fr</span> <span class="ow">in</span> <span class="n">frac</span>
    <span class="p">]</span>
    <span class="n">coefficients</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span> <span class="o">/</span> <span class="n">find_gcd</span><span class="p">(</span><span class="n">vals</span><span class="p">))</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">limit</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coefficients</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">initial_coefficients</span>
    <span class="k">return</span> <span class="n">coefficients</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.balancer.Balancer.is_reaction_balanced" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_reaction_balanced</span><span class="p">(</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">product_matrix</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Checks if reaction is balanced by multiplying reactant matrix and product matrix
by the respective coefficient vector. Method is static to call it outside of balancer
instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>reactant_matrix</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix of reactants property generated by <a class="autorefs autorefs-internal" href="#chemsynthcalc.chemical_reaction.ChemicalReaction">ChemicalReaction</a> class</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>product_matrix</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix of products property generated by <a class="autorefs autorefs-internal" href="#chemsynthcalc.chemical_reaction.ChemicalReaction">ChemicalReaction</a> class</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coefficients</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>] | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coefficients</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tolerance</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tolerance limit for the <em>np.allclose</em> function</p>
              </div>
            </td>
            <td>
                  <code>1e-08</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if balanced within tolerance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;NH4ClO4+HNO3+HCl=HClO4+NOCl+N2O+N2O3+H2O+Cl2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="o">.</span><span class="n">is_reaction_balanced</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">39</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;H2+O2=H2O&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="o">.</span><span class="n">is_reaction_balanced</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">False</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/balancer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_reaction_balanced</span><span class="p">(</span>
    <span class="n">reactant_matrix</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">product_matrix</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if reaction is balanced by multiplying reactant matrix and product matrix</span>
<span class="sd">    by the respective coefficient vector. Method is static to call it outside of balancer</span>
<span class="sd">    instance.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        reactant_matrix (npt.NDArray[np.float64]): Matrix of reactants property generated by [ChemicalReaction][chemsynthcalc.chemical_reaction.ChemicalReaction] class</span>
<span class="sd">        product_matrix (npt.NDArray[np.float64]): Matrix of products property generated by [ChemicalReaction][chemsynthcalc.chemical_reaction.ChemicalReaction] class</span>
<span class="sd">        coefficients (list[float] | list[int]): Coefficients</span>
<span class="sd">        tolerance (float): tolerance limit for the *np.allclose* function</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if balanced within tolerance</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; reaction = ChemicalReaction(&quot;NH4ClO4+HNO3+HCl=HClO4+NOCl+N2O+N2O3+H2O+Cl2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; Balancer.is_reaction_balanced(reaction.reactant_matrix, reaction.product_matrix, [64, 167, 137, 80, 43, 64, 30, 240, 39])</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; reaction = ChemicalReaction(&quot;H2+O2=H2O&quot;)</span>
<span class="sd">        &gt;&gt;&gt; Balancer.is_reaction_balanced(reaction.reactant_matrix, reaction.product_matrix, [2,2,2])</span>
<span class="sd">        False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">reactants</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span>
            <span class="n">reactant_matrix</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)[:</span> <span class="n">reactant_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">products</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span>
            <span class="n">product_matrix</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)[</span><span class="n">reactant_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
            <span class="n">reactants</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">products</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">rtol</span><span class="o">=</span><span class="n">tolerance</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.balancer.Balancer._calculate_by_method" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_by_method</span><span class="p">(</span><span class="n">method</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Compute the coefficients list by a specific method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>One of 4 currently implemented methods (inv, gpinv, ppinv, comb)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>] | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of coefficients</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="raise" open>
  <summary>Raise</summary>
  <p>ValueError if method is not found. <br />
<a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.BalancingError">BalancingError</a> if can't balance reaction by specified method.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/balancer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_by_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the coefficients list by a specific method.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        method (str): One of 4 currently implemented methods (inv, gpinv, ppinv, comb)</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of coefficients</span>

<span class="sd">    Raise:</span>
<span class="sd">        ValueError if method is not found. &lt;br /&gt;</span>
<span class="sd">        [BalancingError][chemsynthcalc.chem_errors.BalancingError] if can&#39;t balance reaction by specified method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">method</span><span class="p">:</span>

        <span class="k">case</span> <span class="s2">&quot;inv&quot;</span><span class="p">:</span>
            <span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_inv_algorithm</span><span class="p">(),</span> <span class="n">decimals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">round_precision</span>
            <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># type: ignore</span>

        <span class="k">case</span> <span class="s2">&quot;gpinv&quot;</span><span class="p">:</span>
            <span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_gpinv_algorithm</span><span class="p">(),</span> <span class="n">decimals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">round_precision</span> <span class="o">+</span> <span class="mi">2</span>
            <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># type: ignore</span>

        <span class="k">case</span> <span class="s2">&quot;ppinv&quot;</span><span class="p">:</span>
            <span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ppinv_algorithm</span><span class="p">(),</span> <span class="n">decimals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">round_precision</span> <span class="o">+</span> <span class="mi">2</span>
            <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># type: ignore</span>

        <span class="k">case</span> <span class="s2">&quot;comb&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comb_algorithm</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">BalancingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t balance reaction by </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> method&quot;</span><span class="p">)</span>

        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No method </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">Balancer</span><span class="o">.</span><span class="n">is_reaction_balanced</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="n">coefficients</span>
        <span class="p">)</span>
        <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coefficients</span><span class="p">)</span>
        <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">intify</span><span class="p">:</span>
            <span class="n">intified</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intify_coefficients</span><span class="p">(</span><span class="n">coefficients</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coef_limit</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">coef_limit</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">intified</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">intified</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">coefficients</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">coefficients</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BalancingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t balance reaction by </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> method&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.balancer.Balancer.inv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">inv</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>A high-level function call to compute coefficients by Thorne method.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>] | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of coefficients</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/balancer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A high-level function call to compute coefficients by Thorne method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of coefficients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_by_method</span><span class="p">(</span><span class="s2">&quot;inv&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.balancer.Balancer.gpinv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gpinv</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>A high-level function call to compute coefficients by
Risteski general pseudoinverse method.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>] | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of coefficients</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/balancer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">gpinv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A high-level function call to compute coefficients by</span>
<span class="sd">    Risteski general pseudoinverse method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of coefficients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_by_method</span><span class="p">(</span><span class="s2">&quot;gpinv&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.balancer.Balancer.ppinv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ppinv</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>A high-level function call to compute coefficients by
Risteski partial pseudoinverse method.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>] | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of coefficients</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/balancer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ppinv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A high-level function call to compute coefficients by</span>
<span class="sd">    Risteski partial pseudoinverse method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of coefficients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_by_method</span><span class="p">(</span><span class="s2">&quot;ppinv&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.balancer.Balancer.comb" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">comb</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>A high-level function call to compute coefficients by
combinatorial method.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>] | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of coefficients</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/balancer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">comb</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A high-level function call to compute coefficients by</span>
<span class="sd">    combinatorial method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of coefficients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_by_method</span><span class="p">(</span><span class="s2">&quot;comb&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.balancer.Balancer.auto" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">auto</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>A high-level function call to automatically compute coefficients
by sequentially calling inv, gpinv, ppinv methods.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>] | <span title="list">list</span>[<span title="int">int</span>], <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of coefficients</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="raise" open>
  <summary>Raise</summary>
  <p><a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.BalancingError">BalancingError</a> if can't balance reaction by any method.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/balancer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">auto</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A high-level function call to automatically compute coefficients</span>
<span class="sd">    by sequentially calling inv, gpinv, ppinv methods.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of coefficients</span>

<span class="sd">    Raise:</span>
<span class="sd">        [BalancingError][chemsynthcalc.chem_errors.BalancingError] if can&#39;t balance reaction by any method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv</span><span class="p">(),</span> <span class="s2">&quot;inverse&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gpinv</span><span class="p">(),</span> <span class="s2">&quot;general pseudoinverse&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gpinv</span><span class="p">(),</span> <span class="s2">&quot;partial pseudoinverse&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BalancingError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t balance this reaction by any method&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.balancing_algos" class="doc doc-heading">
            <code>balancing_algos</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.balancing_algos.BalancingAlgorithms" class="doc doc-heading">
            <code>BalancingAlgorithms</code>


</h3>


    <div class="doc doc-contents ">


        <p>A collection of functions for balancing chemical reactions</p>
<p>Currently implemented: Thorne algorithm (see
<a class="autorefs autorefs-internal" title="_inv_algorithm()" href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._inv_algorithm">_inv_algorithm</a> method for details),
Risteski general pseudo-inverse algorithm (see
<a class="autorefs autorefs-internal" title="_gpinv_algorithm()" href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._gpinv_algorithm">_gpinv_algorithm</a> method for details),
Risteski partial pseudo-inverse algorithm (see
<a class="autorefs autorefs-internal" title="_ppinv_algorithm()" href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._ppinv_algorithm">_ppinv_algorithm</a> method for details),
and naive combinational search algorithm (see
<a class="autorefs autorefs-internal" title="_comb_algorithm(max_number_of_iterations=100000000.0)" href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._comb_algorithm">_comb_algorithm</a> method for details).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>matrix</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reaction matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>separator_pos</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Position of the reaction separator (usually the separator is "=")</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.balancing_algos.BalancingAlgorithms.reactant_matrix">reactant_matrix</span></code></td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A matrix of the left part of the equation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.balancing_algos.BalancingAlgorithms.product_matrix">product_matrix</span></code></td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A matrix of the right part of the equation</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Why use
<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.pinv.html">scipy.linalg.pinv</a>,
when
<a href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.pinv.html">numpy.linalg.pinv</a>
is doing the same thing and does not require the whole SciPy import?</p>
<p>There are some peculiar reaction cases where
(especially for <a class="autorefs autorefs-internal" title="_ppinv_algorithm()" href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._ppinv_algorithm">_ppinv_algorithm</a> method)
the results for <a href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.pinv.html">numpy.linalg.pinv</a>
differs from system to system (np version, OS, python version etc.). My understanding is that the cause of
this behaviour lies in small differences for pinv algorithm in numpy C-libraries and BLAS-libraries,
hence the difference.
To avoid this, a more consistent method
<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.pinv.html">scipy.linalg.pinv</a> was used.</p>
</details>






              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/balancing_algos.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BalancingAlgorithms</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A collection of functions for balancing chemical reactions</span>

<span class="sd">    Currently implemented: Thorne algorithm (see</span>
<span class="sd">    [_inv_algorithm][chemsynthcalc.balancing_algos.BalancingAlgorithms._inv_algorithm] method for details),</span>
<span class="sd">    Risteski general pseudo-inverse algorithm (see</span>
<span class="sd">    [_gpinv_algorithm][chemsynthcalc.balancing_algos.BalancingAlgorithms._gpinv_algorithm] method for details),</span>
<span class="sd">    Risteski partial pseudo-inverse algorithm (see</span>
<span class="sd">    [_ppinv_algorithm][chemsynthcalc.balancing_algos.BalancingAlgorithms._ppinv_algorithm] method for details),</span>
<span class="sd">    and naive combinational search algorithm (see</span>
<span class="sd">    [_comb_algorithm][chemsynthcalc.balancing_algos.BalancingAlgorithms._comb_algorithm] method for details).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        matrix (npt.NDArray[np.float64]): Reaction matrix</span>
<span class="sd">        separator_pos (int): Position of the reaction separator (usually the separator is &quot;=&quot;)</span>

<span class="sd">    Attributes:</span>
<span class="sd">        reactant_matrix (npt.NDArray[np.float64]): A matrix of the left part of the equation</span>
<span class="sd">        product_matrix (npt.NDArray[np.float64]): A matrix of the right part of the equation</span>

<span class="sd">    Note:</span>
<span class="sd">        Why use</span>
<span class="sd">        [scipy.linalg.pinv](https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.pinv.html),</span>
<span class="sd">        when</span>
<span class="sd">        [numpy.linalg.pinv](https://numpy.org/doc/stable/reference/generated/numpy.linalg.pinv.html)</span>
<span class="sd">        is doing the same thing and does not require the whole SciPy import?</span>

<span class="sd">        There are some peculiar reaction cases where</span>
<span class="sd">        (especially for [_ppinv_algorithm][chemsynthcalc.balancing_algos.BalancingAlgorithms._ppinv_algorithm] method)</span>
<span class="sd">        the results for [numpy.linalg.pinv](https://numpy.org/doc/stable/reference/generated/numpy.linalg.pinv.html)</span>
<span class="sd">        differs from system to system (np version, OS, python version etc.). My understanding is that the cause of</span>
<span class="sd">        this behaviour lies in small differences for pinv algorithm in numpy C-libraries and BLAS-libraries,</span>
<span class="sd">        hence the difference.</span>
<span class="sd">        To avoid this, a more consistent method</span>
<span class="sd">        [scipy.linalg.pinv](https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.pinv.html) was used.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">separator_pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separator_pos</span> <span class="o">=</span> <span class="n">separator_pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span><span class="p">[</span>
            <span class="p">:,</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator_pos</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span><span class="p">[</span>
            <span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator_pos</span> <span class="p">:</span>
        <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_inv_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Matrix inverse algorithm for reaction balancing.</span>

<span class="sd">        A reaction matrix inverse algorithm proposed by [Thorne](https://arxiv.org/abs/1110.4321).</span>
<span class="sd">        The calculation is based on the nullity, or dimensionality, of the matrix.</span>

<span class="sd">        The algorithm can be described in steps:</span>

<span class="sd">        1) If the number of rows is greater than the number of columns, \</span>
<span class="sd">        add zero columns until the matrix becomes square \</span>
<span class="sd">        (Note: this is a modification of the original \</span>
<span class="sd">        Thorne method described in the article).</span>

<span class="sd">        2) If reaction matrix is square (which means that the number \</span>
<span class="sd">        of atoms involved is equal to the number of compounds) than \</span>
<span class="sd">        we turn matrix in its row-echelon form by singular value \</span>
<span class="sd">        decomposition.</span>

<span class="sd">        3) Calculation of the nullity of the matrix, which is \</span>
<span class="sd">        basically number of compounds minus rank of the matrix.</span>

<span class="sd">        4) Create a  matrix augumented by nullity number of rows \</span>
<span class="sd">        of flipped identity matrix. If any rows are zeros, \</span>
<span class="sd">        replace them with identity matrix rows.</span>

<span class="sd">        5) Inverse the augumented matrix.</span>

<span class="sd">        6) Exctract and transpose rightmost column.</span>

<span class="sd">        7) Normalize this value with the absolute min value of the vector.</span>

<span class="sd">        8) Round up float operations errors.</span>

<span class="sd">        The absolute values of this vector are coefficients of the</span>
<span class="sd">        reaction.</span>

<span class="sd">        Note:</span>
<span class="sd">            While this method works great for reactions with 0 and 1</span>
<span class="sd">            nullity, it generally cannot work with nullities 2 and higher.</span>
<span class="sd">            Thorne claims that for higher nullities, a nullity number</span>
<span class="sd">            of vectors should be extracted, and each of them contains</span>
<span class="sd">            a set of correct coefficients. However, if number of rows in</span>
<span class="sd">            the flipped augmentation identity matrix is 2 or more, one can</span>
<span class="sd">            easily see that each vector will contain nullity-1 zeroes,</span>
<span class="sd">            therefore they cannot be a correct vector of coefficients.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A 1D NumPy array of calculated coefficients</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reaction_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span>

        <span class="k">if</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">zeros_added</span> <span class="o">=</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">zero_columns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">zeros_added</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">reaction_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">reaction_matrix</span><span class="p">,</span> <span class="n">zero_columns</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zeros_added</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">reaction_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">reaction_matrix</span><span class="p">)</span>

        <span class="n">number_of_cols</span> <span class="o">=</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">reaction_matrix</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-100</span><span class="p">)</span>
        <span class="n">nullity</span> <span class="o">=</span> <span class="n">number_of_cols</span> <span class="o">-</span> <span class="n">rank</span>
        <span class="n">augument</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])[:</span><span class="n">nullity</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">augumented_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">reaction_matrix</span><span class="p">,</span> <span class="n">augument</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">augumented_matrix</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">augumented_matrix</span> <span class="o">=</span> <span class="n">augumented_matrix</span><span class="p">[</span>
                <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">augumented_matrix</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="n">inversed_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">augumented_matrix</span><span class="p">)</span>
        <span class="n">vector</span> <span class="o">=</span> <span class="n">inversed_matrix</span><span class="p">[:,</span> <span class="o">-</span><span class="n">zeros_added</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
        <span class="n">vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vector</span><span class="p">)))</span>
        <span class="n">vector</span> <span class="o">=</span> <span class="n">vector</span><span class="p">[</span><span class="n">vector</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">coefs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">coefs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_gpinv_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Matrix gerenal pseudoinverse algorithm for reaction balancing.</span>

<span class="sd">        A reaction matrix pseudoinverse algorithm</span>
<span class="sd">        proposed by [Risteski](http://koreascience.or.kr/article/JAKO201314358624990.page).</span>
<span class="sd">        There are other articles and methods of chemical</span>
<span class="sd">        equation balancing by this author, however, this particular</span>
<span class="sd">        algorithm seems to be most convenient for matrix calculations.</span>
<span class="sd">        The algorithm can be described in steps:</span>

<span class="sd">        1) Stack reactant matrix and negative product matrix.</span>

<span class="sd">        2) Calculate MP pseudoinverse of this matrix.</span>

<span class="sd">        3) Calculate coefficients by formula:</span>
<span class="sd">        x = (I – A+A)a, where x is the coefficients vector,</span>
<span class="sd">        I - identity matrix, A+ - MP inverse, A - matrix,</span>
<span class="sd">        a - arbitrary vector (in this case, vector of ones).</span>

<span class="sd">        Note:</span>
<span class="sd">            This method is more general than Thorne&#39;s method, although it has some</span>
<span class="sd">            peculiarities of its own. First of all, the output of this method is float array,</span>
<span class="sd">            so, to generate an int coefs list, it needs to be converted, which is</span>
<span class="sd">            not always leads to a good result. Secondly, MP pseudoinverse</span>
<span class="sd">            is sensetive to row order in the reaction matrix. The rows should</span>
<span class="sd">            be ordered by atoms apperances in the reaction string.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A 1D NumPy array of calculated coefficients</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">))</span>
        <span class="n">inverse</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">coefs</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">inverse</span> <span class="o">@</span> <span class="n">matrix</span><span class="p">)</span> <span class="o">@</span> <span class="n">a</span>
        <span class="k">return</span> <span class="n">coefs</span><span class="o">.</span><span class="n">flat</span><span class="p">[:]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_ppinv_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Matrix partial pseudoinverse algorithm for reaction balancing.</span>

<span class="sd">        A reaction matrix pseudoinverse algorithm also</span>
<span class="sd">        proposed by [Risteski](https://www.koreascience.or.kr/article/JAKO200802727293429.page).</span>
<span class="sd">        The method is founded on virtue of the solution of a</span>
<span class="sd">        Diophantine matrix equation by using of a Moore-Penrose</span>
<span class="sd">        pseudoinverse matrix.</span>

<span class="sd">        The algorithm can be described in steps:</span>

<span class="sd">        1) Take the Moore-Penrose pseudoinverse of the reactant matrix.</span>

<span class="sd">        2) Create a G matrix in the form of (I-AA^-)B, where</span>
<span class="sd">        I is the identity matrix, A is the reactant matrix, A^- is</span>
<span class="sd">        the MP pseudoinverse of A and B is the product matrix.</span>

<span class="sd">        3) Then, the vector y (coefficients of products) is equal to</span>
<span class="sd">        (I-G^-G)u.</span>

<span class="sd">        4) Vector x (coefficients of reactants) is equal to</span>
<span class="sd">        A^-By + (I-A^-A)v, where u and v are columns of ones.</span>

<span class="sd">        Note:</span>
<span class="sd">            While this algorithm and</span>
<span class="sd">            [_gpinv_algorithm][chemsynthcalc.balancing_algos.BalancingAlgorithms._gpinv_algorithm]</span>
<span class="sd">            are very similar, there are some differences in output results.</span>
<span class="sd">            This method exists mostly for legacy purposes, like balancing</span>
<span class="sd">            some reactions according to [Risteski](https://www.koreascience.or.kr/article/JAKO200802727293429.page).</span>

<span class="sd">        Returns:</span>
<span class="sd">            A 1D NumPy array of calculated coefficients</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">MP_inverse</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">)</span>
        <span class="n">g_matrix</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactant_matrix</span> <span class="o">@</span> <span class="n">MP_inverse</span>
        <span class="p">)</span>
        <span class="n">g_matrix</span> <span class="o">=</span> <span class="n">g_matrix</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">product_matrix</span>
        <span class="n">y_multiply</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">g_matrix</span><span class="p">)</span> <span class="o">@</span> <span class="n">g_matrix</span>
        <span class="n">y_vector</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">y_multiply</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">y_multiply</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">y_multiply</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">)</span>
        <span class="n">x_multiply</span> <span class="o">=</span> <span class="n">MP_inverse</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactant_matrix</span>
        <span class="n">x_multiply</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">x_multiply</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">x_multiply</span>
        <span class="p">)</span> <span class="o">+</span> <span class="n">MP_inverse</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">product_matrix</span> <span class="o">@</span> <span class="n">y_vector</span><span class="o">.</span><span class="n">T</span>
        <span class="n">x_vector</span> <span class="o">=</span> <span class="n">x_multiply</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
        <span class="n">coefs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">x_vector</span><span class="p">,</span> <span class="n">y_vector</span><span class="p">))))</span>
        <span class="k">return</span> <span class="n">coefs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_comb_algorithm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">max_number_of_iterations</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e8</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Matrix combinatorial algorithm for reaction balancing.</span>

<span class="sd">        Finds a solution solution of a Diophantine matrix equation</span>
<span class="sd">        by simply enumerating of all possible solutions of number_of_iterations</span>
<span class="sd">        coefficients. The solution space is created by Cartesian product</span>
<span class="sd">        (in this case, *np.meshgrid* function), and therefore it is very</span>
<span class="sd">        limited by memory. There must a better, clever and fast solution</span>
<span class="sd">        to this!</span>

<span class="sd">        Important:</span>
<span class="sd">            Only for integer coefficients less than 128. Only for reactions</span>
<span class="sd">            with total compound count &lt;=10.</span>
<span class="sd">            A GPU-accelerated version of this method can be done by importing</span>
<span class="sd">            CuPy and replacing np. with cp.</span>

<span class="sd">        Note:</span>
<span class="sd">            All possible variations of coefficients vectors are</span>
<span class="sd">            combinations = max_coefficients**number_of_compounds,</span>
<span class="sd">            therefore this method is most effective for reaction with</span>
<span class="sd">            small numbers of compounds.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A 1D NumPy array of calculated coefficients of None if can&#39;t compute</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">byte</span> <span class="o">=</span> <span class="mi">127</span>
        <span class="n">number_of_compounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">number_of_compounds</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sorry, this method is only for n of compound &lt;=10&quot;</span><span class="p">)</span>

        <span class="n">number_of_iterations</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
            <span class="n">max_number_of_iterations</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">number_of_compounds</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">number_of_iterations</span> <span class="o">&gt;</span> <span class="n">byte</span><span class="p">:</span>
            <span class="n">number_of_iterations</span> <span class="o">=</span> <span class="n">byte</span>

        <span class="n">trans_reaction_matrix</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">lenght</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">old_reactants</span> <span class="o">=</span> <span class="n">trans_reaction_matrix</span><span class="p">[:</span><span class="n">lenght</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;ushort&quot;</span><span class="p">)</span>
        <span class="n">old_products</span> <span class="o">=</span> <span class="n">trans_reaction_matrix</span><span class="p">[</span><span class="n">lenght</span><span class="p">:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;ushort&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">number_of_iterations</span> <span class="o">+</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">cart_array</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;ubyte&quot;</span><span class="p">),)</span> <span class="o">*</span> <span class="n">number_of_compounds</span>
            <span class="n">permuted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="n">cart_array</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;ubyte&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">number_of_compounds</span>
            <span class="p">)</span>
            <span class="nb">filter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;ubyte&quot;</span><span class="p">)</span>
            <span class="n">permuted</span> <span class="o">=</span> <span class="n">permuted</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">permuted</span> <span class="o">==</span> <span class="nb">filter</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
            <span class="c1"># print(&quot;calculating max coef %s of %s&quot; % (i-1, number_of_iterations), end=&#39;\r&#39;, flush=False)</span>
            <span class="n">reactants_vectors</span> <span class="o">=</span> <span class="n">permuted</span><span class="p">[:,</span> <span class="p">:</span><span class="n">lenght</span><span class="p">]</span>
            <span class="n">products_vectors</span> <span class="o">=</span> <span class="n">permuted</span><span class="p">[:,</span> <span class="n">lenght</span><span class="p">:]</span>
            <span class="k">del</span> <span class="n">permuted</span>
            <span class="n">reactants</span> <span class="o">=</span> <span class="p">(</span><span class="n">old_reactants</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">reactants_vectors</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">products</span> <span class="o">=</span> <span class="p">(</span><span class="n">old_products</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">products_vectors</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">reactants</span><span class="p">,</span> <span class="n">products</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">reactants</span>
            <span class="k">del</span> <span class="n">products</span>
            <span class="n">where</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">diff</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">where</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">where</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="n">where</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="n">where</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="c1"># print(&quot;&quot;)</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                        <span class="p">(</span>
                            <span class="n">reactants_vectors</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                            <span class="n">products_vectors</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
        <span class="c1"># print(&quot;&quot;)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.balancing_algos.BalancingAlgorithms._inv_algorithm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_inv_algorithm</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Matrix inverse algorithm for reaction balancing.</p>
<p>A reaction matrix inverse algorithm proposed by <a href="https://arxiv.org/abs/1110.4321">Thorne</a>.
The calculation is based on the nullity, or dimensionality, of the matrix.</p>
<p>The algorithm can be described in steps:</p>
<p>1) If the number of rows is greater than the number of columns,         add zero columns until the matrix becomes square         (Note: this is a modification of the original         Thorne method described in the article).</p>
<p>2) If reaction matrix is square (which means that the number         of atoms involved is equal to the number of compounds) than         we turn matrix in its row-echelon form by singular value         decomposition.</p>
<p>3) Calculation of the nullity of the matrix, which is         basically number of compounds minus rank of the matrix.</p>
<p>4) Create a  matrix augumented by nullity number of rows         of flipped identity matrix. If any rows are zeros,         replace them with identity matrix rows.</p>
<p>5) Inverse the augumented matrix.</p>
<p>6) Exctract and transpose rightmost column.</p>
<p>7) Normalize this value with the absolute min value of the vector.</p>
<p>8) Round up float operations errors.</p>
<p>The absolute values of this vector are coefficients of the
reaction.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>While this method works great for reactions with 0 and 1
nullity, it generally cannot work with nullities 2 and higher.
Thorne claims that for higher nullities, a nullity number
of vectors should be extracted, and each of them contains
a set of correct coefficients. However, if number of rows in
the flipped augmentation identity matrix is 2 or more, one can
easily see that each vector will contain nullity-1 zeroes,
therefore they cannot be a correct vector of coefficients.</p>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D NumPy array of calculated coefficients</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/balancing_algos.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_inv_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix inverse algorithm for reaction balancing.</span>

<span class="sd">    A reaction matrix inverse algorithm proposed by [Thorne](https://arxiv.org/abs/1110.4321).</span>
<span class="sd">    The calculation is based on the nullity, or dimensionality, of the matrix.</span>

<span class="sd">    The algorithm can be described in steps:</span>

<span class="sd">    1) If the number of rows is greater than the number of columns, \</span>
<span class="sd">    add zero columns until the matrix becomes square \</span>
<span class="sd">    (Note: this is a modification of the original \</span>
<span class="sd">    Thorne method described in the article).</span>

<span class="sd">    2) If reaction matrix is square (which means that the number \</span>
<span class="sd">    of atoms involved is equal to the number of compounds) than \</span>
<span class="sd">    we turn matrix in its row-echelon form by singular value \</span>
<span class="sd">    decomposition.</span>

<span class="sd">    3) Calculation of the nullity of the matrix, which is \</span>
<span class="sd">    basically number of compounds minus rank of the matrix.</span>

<span class="sd">    4) Create a  matrix augumented by nullity number of rows \</span>
<span class="sd">    of flipped identity matrix. If any rows are zeros, \</span>
<span class="sd">    replace them with identity matrix rows.</span>

<span class="sd">    5) Inverse the augumented matrix.</span>

<span class="sd">    6) Exctract and transpose rightmost column.</span>

<span class="sd">    7) Normalize this value with the absolute min value of the vector.</span>

<span class="sd">    8) Round up float operations errors.</span>

<span class="sd">    The absolute values of this vector are coefficients of the</span>
<span class="sd">    reaction.</span>

<span class="sd">    Note:</span>
<span class="sd">        While this method works great for reactions with 0 and 1</span>
<span class="sd">        nullity, it generally cannot work with nullities 2 and higher.</span>
<span class="sd">        Thorne claims that for higher nullities, a nullity number</span>
<span class="sd">        of vectors should be extracted, and each of them contains</span>
<span class="sd">        a set of correct coefficients. However, if number of rows in</span>
<span class="sd">        the flipped augmentation identity matrix is 2 or more, one can</span>
<span class="sd">        easily see that each vector will contain nullity-1 zeroes,</span>
<span class="sd">        therefore they cannot be a correct vector of coefficients.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A 1D NumPy array of calculated coefficients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reaction_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span>

    <span class="k">if</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">zeros_added</span> <span class="o">=</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">zero_columns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">zeros_added</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">reaction_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">reaction_matrix</span><span class="p">,</span> <span class="n">zero_columns</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">zeros_added</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">reaction_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">reaction_matrix</span><span class="p">)</span>

    <span class="n">number_of_cols</span> <span class="o">=</span> <span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">rank</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">reaction_matrix</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-100</span><span class="p">)</span>
    <span class="n">nullity</span> <span class="o">=</span> <span class="n">number_of_cols</span> <span class="o">-</span> <span class="n">rank</span>
    <span class="n">augument</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])[:</span><span class="n">nullity</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">augumented_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">reaction_matrix</span><span class="p">,</span> <span class="n">augument</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">augumented_matrix</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">augumented_matrix</span> <span class="o">=</span> <span class="n">augumented_matrix</span><span class="p">[</span>
            <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">augumented_matrix</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="n">inversed_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">augumented_matrix</span><span class="p">)</span>
    <span class="n">vector</span> <span class="o">=</span> <span class="n">inversed_matrix</span><span class="p">[:,</span> <span class="o">-</span><span class="n">zeros_added</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
    <span class="n">vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vector</span><span class="p">)))</span>
    <span class="n">vector</span> <span class="o">=</span> <span class="n">vector</span><span class="p">[</span><span class="n">vector</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">coefs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">coefs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.balancing_algos.BalancingAlgorithms._gpinv_algorithm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_gpinv_algorithm</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Matrix gerenal pseudoinverse algorithm for reaction balancing.</p>
<p>A reaction matrix pseudoinverse algorithm
proposed by <a href="http://koreascience.or.kr/article/JAKO201314358624990.page">Risteski</a>.
There are other articles and methods of chemical
equation balancing by this author, however, this particular
algorithm seems to be most convenient for matrix calculations.
The algorithm can be described in steps:</p>
<p>1) Stack reactant matrix and negative product matrix.</p>
<p>2) Calculate MP pseudoinverse of this matrix.</p>
<p>3) Calculate coefficients by formula:
x = (I – A+A)a, where x is the coefficients vector,
I - identity matrix, A+ - MP inverse, A - matrix,
a - arbitrary vector (in this case, vector of ones).</p>


<details class="note" open>
  <summary>Note</summary>
  <p>This method is more general than Thorne's method, although it has some
peculiarities of its own. First of all, the output of this method is float array,
so, to generate an int coefs list, it needs to be converted, which is
not always leads to a good result. Secondly, MP pseudoinverse
is sensetive to row order in the reaction matrix. The rows should
be ordered by atoms apperances in the reaction string.</p>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D NumPy array of calculated coefficients</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/balancing_algos.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_gpinv_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Matrix gerenal pseudoinverse algorithm for reaction balancing.</span>

<span class="sd">    A reaction matrix pseudoinverse algorithm</span>
<span class="sd">    proposed by [Risteski](http://koreascience.or.kr/article/JAKO201314358624990.page).</span>
<span class="sd">    There are other articles and methods of chemical</span>
<span class="sd">    equation balancing by this author, however, this particular</span>
<span class="sd">    algorithm seems to be most convenient for matrix calculations.</span>
<span class="sd">    The algorithm can be described in steps:</span>

<span class="sd">    1) Stack reactant matrix and negative product matrix.</span>

<span class="sd">    2) Calculate MP pseudoinverse of this matrix.</span>

<span class="sd">    3) Calculate coefficients by formula:</span>
<span class="sd">    x = (I – A+A)a, where x is the coefficients vector,</span>
<span class="sd">    I - identity matrix, A+ - MP inverse, A - matrix,</span>
<span class="sd">    a - arbitrary vector (in this case, vector of ones).</span>

<span class="sd">    Note:</span>
<span class="sd">        This method is more general than Thorne&#39;s method, although it has some</span>
<span class="sd">        peculiarities of its own. First of all, the output of this method is float array,</span>
<span class="sd">        so, to generate an int coefs list, it needs to be converted, which is</span>
<span class="sd">        not always leads to a good result. Secondly, MP pseudoinverse</span>
<span class="sd">        is sensetive to row order in the reaction matrix. The rows should</span>
<span class="sd">        be ordered by atoms apperances in the reaction string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A 1D NumPy array of calculated coefficients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">))</span>
    <span class="n">inverse</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">coefs</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">inverse</span> <span class="o">@</span> <span class="n">matrix</span><span class="p">)</span> <span class="o">@</span> <span class="n">a</span>
    <span class="k">return</span> <span class="n">coefs</span><span class="o">.</span><span class="n">flat</span><span class="p">[:]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.balancing_algos.BalancingAlgorithms._ppinv_algorithm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_ppinv_algorithm</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Matrix partial pseudoinverse algorithm for reaction balancing.</p>
<p>A reaction matrix pseudoinverse algorithm also
proposed by <a href="https://www.koreascience.or.kr/article/JAKO200802727293429.page">Risteski</a>.
The method is founded on virtue of the solution of a
Diophantine matrix equation by using of a Moore-Penrose
pseudoinverse matrix.</p>
<p>The algorithm can be described in steps:</p>
<p>1) Take the Moore-Penrose pseudoinverse of the reactant matrix.</p>
<p>2) Create a G matrix in the form of (I-AA^-)B, where
I is the identity matrix, A is the reactant matrix, A^- is
the MP pseudoinverse of A and B is the product matrix.</p>
<p>3) Then, the vector y (coefficients of products) is equal to
(I-G^-G)u.</p>
<p>4) Vector x (coefficients of reactants) is equal to
A^-By + (I-A^-A)v, where u and v are columns of ones.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>While this algorithm and
<a class="autorefs autorefs-internal" title="_gpinv_algorithm()" href="#chemsynthcalc.balancing_algos.BalancingAlgorithms._gpinv_algorithm">_gpinv_algorithm</a>
are very similar, there are some differences in output results.
This method exists mostly for legacy purposes, like balancing
some reactions according to <a href="https://www.koreascience.or.kr/article/JAKO200802727293429.page">Risteski</a>.</p>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D NumPy array of calculated coefficients</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/balancing_algos.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_ppinv_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Matrix partial pseudoinverse algorithm for reaction balancing.</span>

<span class="sd">    A reaction matrix pseudoinverse algorithm also</span>
<span class="sd">    proposed by [Risteski](https://www.koreascience.or.kr/article/JAKO200802727293429.page).</span>
<span class="sd">    The method is founded on virtue of the solution of a</span>
<span class="sd">    Diophantine matrix equation by using of a Moore-Penrose</span>
<span class="sd">    pseudoinverse matrix.</span>

<span class="sd">    The algorithm can be described in steps:</span>

<span class="sd">    1) Take the Moore-Penrose pseudoinverse of the reactant matrix.</span>

<span class="sd">    2) Create a G matrix in the form of (I-AA^-)B, where</span>
<span class="sd">    I is the identity matrix, A is the reactant matrix, A^- is</span>
<span class="sd">    the MP pseudoinverse of A and B is the product matrix.</span>

<span class="sd">    3) Then, the vector y (coefficients of products) is equal to</span>
<span class="sd">    (I-G^-G)u.</span>

<span class="sd">    4) Vector x (coefficients of reactants) is equal to</span>
<span class="sd">    A^-By + (I-A^-A)v, where u and v are columns of ones.</span>

<span class="sd">    Note:</span>
<span class="sd">        While this algorithm and</span>
<span class="sd">        [_gpinv_algorithm][chemsynthcalc.balancing_algos.BalancingAlgorithms._gpinv_algorithm]</span>
<span class="sd">        are very similar, there are some differences in output results.</span>
<span class="sd">        This method exists mostly for legacy purposes, like balancing</span>
<span class="sd">        some reactions according to [Risteski](https://www.koreascience.or.kr/article/JAKO200802727293429.page).</span>

<span class="sd">    Returns:</span>
<span class="sd">        A 1D NumPy array of calculated coefficients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">MP_inverse</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">)</span>
    <span class="n">g_matrix</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactant_matrix</span> <span class="o">@</span> <span class="n">MP_inverse</span>
    <span class="p">)</span>
    <span class="n">g_matrix</span> <span class="o">=</span> <span class="n">g_matrix</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">product_matrix</span>
    <span class="n">y_multiply</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">g_matrix</span><span class="p">)</span> <span class="o">@</span> <span class="n">g_matrix</span>
    <span class="n">y_vector</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">y_multiply</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">y_multiply</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">y_multiply</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="n">x_multiply</span> <span class="o">=</span> <span class="n">MP_inverse</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactant_matrix</span>
    <span class="n">x_multiply</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">x_multiply</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">x_multiply</span>
    <span class="p">)</span> <span class="o">+</span> <span class="n">MP_inverse</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">product_matrix</span> <span class="o">@</span> <span class="n">y_vector</span><span class="o">.</span><span class="n">T</span>
    <span class="n">x_vector</span> <span class="o">=</span> <span class="n">x_multiply</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
    <span class="n">coefs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">x_vector</span><span class="p">,</span> <span class="n">y_vector</span><span class="p">))))</span>
    <span class="k">return</span> <span class="n">coefs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.balancing_algos.BalancingAlgorithms._comb_algorithm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_comb_algorithm</span><span class="p">(</span><span class="n">max_number_of_iterations</span><span class="o">=</span><span class="mf">100000000.0</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Matrix combinatorial algorithm for reaction balancing.</p>
<p>Finds a solution solution of a Diophantine matrix equation
by simply enumerating of all possible solutions of number_of_iterations
coefficients. The solution space is created by Cartesian product
(in this case, <em>np.meshgrid</em> function), and therefore it is very
limited by memory. There must a better, clever and fast solution
to this!</p>


<details class="important" open>
  <summary>Important</summary>
  <p>Only for integer coefficients less than 128. Only for reactions
with total compound count &lt;=10.
A GPU-accelerated version of this method can be done by importing
CuPy and replacing np. with cp.</p>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>All possible variations of coefficients vectors are
combinations = max_coefficients**number_of_compounds,
therefore this method is most effective for reaction with
small numbers of compounds.</p>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.int32">int32</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D NumPy array of calculated coefficients of None if can't compute</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/balancing_algos.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_comb_algorithm</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">max_number_of_iterations</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e8</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Matrix combinatorial algorithm for reaction balancing.</span>

<span class="sd">    Finds a solution solution of a Diophantine matrix equation</span>
<span class="sd">    by simply enumerating of all possible solutions of number_of_iterations</span>
<span class="sd">    coefficients. The solution space is created by Cartesian product</span>
<span class="sd">    (in this case, *np.meshgrid* function), and therefore it is very</span>
<span class="sd">    limited by memory. There must a better, clever and fast solution</span>
<span class="sd">    to this!</span>

<span class="sd">    Important:</span>
<span class="sd">        Only for integer coefficients less than 128. Only for reactions</span>
<span class="sd">        with total compound count &lt;=10.</span>
<span class="sd">        A GPU-accelerated version of this method can be done by importing</span>
<span class="sd">        CuPy and replacing np. with cp.</span>

<span class="sd">    Note:</span>
<span class="sd">        All possible variations of coefficients vectors are</span>
<span class="sd">        combinations = max_coefficients**number_of_compounds,</span>
<span class="sd">        therefore this method is most effective for reaction with</span>
<span class="sd">        small numbers of compounds.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A 1D NumPy array of calculated coefficients of None if can&#39;t compute</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">byte</span> <span class="o">=</span> <span class="mi">127</span>
    <span class="n">number_of_compounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">number_of_compounds</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sorry, this method is only for n of compound &lt;=10&quot;</span><span class="p">)</span>

    <span class="n">number_of_iterations</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
        <span class="n">max_number_of_iterations</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">number_of_compounds</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">number_of_iterations</span> <span class="o">&gt;</span> <span class="n">byte</span><span class="p">:</span>
        <span class="n">number_of_iterations</span> <span class="o">=</span> <span class="n">byte</span>

    <span class="n">trans_reaction_matrix</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">lenght</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">old_reactants</span> <span class="o">=</span> <span class="n">trans_reaction_matrix</span><span class="p">[:</span><span class="n">lenght</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;ushort&quot;</span><span class="p">)</span>
    <span class="n">old_products</span> <span class="o">=</span> <span class="n">trans_reaction_matrix</span><span class="p">[</span><span class="n">lenght</span><span class="p">:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;ushort&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">number_of_iterations</span> <span class="o">+</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">cart_array</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;ubyte&quot;</span><span class="p">),)</span> <span class="o">*</span> <span class="n">number_of_compounds</span>
        <span class="n">permuted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="n">cart_array</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;ubyte&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">number_of_compounds</span>
        <span class="p">)</span>
        <span class="nb">filter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;ubyte&quot;</span><span class="p">)</span>
        <span class="n">permuted</span> <span class="o">=</span> <span class="n">permuted</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">permuted</span> <span class="o">==</span> <span class="nb">filter</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
        <span class="c1"># print(&quot;calculating max coef %s of %s&quot; % (i-1, number_of_iterations), end=&#39;\r&#39;, flush=False)</span>
        <span class="n">reactants_vectors</span> <span class="o">=</span> <span class="n">permuted</span><span class="p">[:,</span> <span class="p">:</span><span class="n">lenght</span><span class="p">]</span>
        <span class="n">products_vectors</span> <span class="o">=</span> <span class="n">permuted</span><span class="p">[:,</span> <span class="n">lenght</span><span class="p">:]</span>
        <span class="k">del</span> <span class="n">permuted</span>
        <span class="n">reactants</span> <span class="o">=</span> <span class="p">(</span><span class="n">old_reactants</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">reactants_vectors</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">products</span> <span class="o">=</span> <span class="p">(</span><span class="n">old_products</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">products_vectors</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">reactants</span><span class="p">,</span> <span class="n">products</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">reactants</span>
        <span class="k">del</span> <span class="n">products</span>
        <span class="n">where</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">diff</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">where</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">where</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">where</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">where</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># print(&quot;&quot;)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">reactants_vectors</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                        <span class="n">products_vectors</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
    <span class="c1"># print(&quot;&quot;)</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.chem_errors" class="doc doc-heading">
            <code>chem_errors</code>


</h2>

    <div class="doc doc-contents ">

        <p>Module that contains custom errors for use in <code>ChemSynthCalc</code></p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_errors.EmptyFormula" class="doc doc-heading">
            <code>EmptyFormula</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>The formula string is empty</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">EmptyFormula</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The formula string is empty</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_errors.NoSuchAtom" class="doc doc-heading">
            <code>NoSuchAtom</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Found atom(s) that are not in the periodic table.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NoSuchAtom</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Found atom(s) that are not in the periodic table.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_errors.InvalidCharacter" class="doc doc-heading">
            <code>InvalidCharacter</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Found some characters that do not belong in the
chemical formula or reaction.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">InvalidCharacter</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Found some characters that do not belong in the</span>
<span class="sd">    chemical formula or reaction.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_errors.MoreThanOneAdduct" class="doc doc-heading">
            <code>MoreThanOneAdduct</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>There is more than one adduct (*).</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MoreThanOneAdduct</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    There is more than one adduct (*).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_errors.BracketsNotPaired" class="doc doc-heading">
            <code>BracketsNotPaired</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Some brackets do not come in pairs.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BracketsNotPaired</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Some brackets do not come in pairs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_errors.EmptyReaction" class="doc doc-heading">
            <code>EmptyReaction</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>The reaction string is empty</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">EmptyReaction</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The reaction string is empty</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_errors.NoSuchMode" class="doc doc-heading">
            <code>NoSuchMode</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Invalid calculation mode detected.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NoSuchMode</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Invalid calculation mode detected.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_errors.NoSuchAlgorithm" class="doc doc-heading">
            <code>NoSuchAlgorithm</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Invalid calculation algorithm detected.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NoSuchAlgorithm</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Invalid calculation algorithm detected.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_errors.NoSeparator" class="doc doc-heading">
            <code>NoSeparator</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>No separator was found in the reaction string.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NoSeparator</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    No separator was found in the reaction string.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_errors.ReactionNotBalanced" class="doc doc-heading">
            <code>ReactionNotBalanced</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>This reaction is not balanced.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ReactionNotBalanced</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This reaction is not balanced.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_errors.ReactantProductDifference" class="doc doc-heading">
            <code>ReactantProductDifference</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>The elements in reaction are not evenly
distributed in reactants and products:
some of atoms are only in one part of
reaction.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ReactantProductDifference</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The elements in reaction are not evenly</span>
<span class="sd">    distributed in reactants and products:</span>
<span class="sd">    some of atoms are only in one part of</span>
<span class="sd">    reaction.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_errors.BadCoeffiecients" class="doc doc-heading">
            <code>BadCoeffiecients</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>The coefficients are not not compliant
(they have no physical meaning).</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BadCoeffiecients</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The coefficients are not not compliant</span>
<span class="sd">    (they have no physical meaning).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_errors.BalancingError" class="doc doc-heading">
            <code>BalancingError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Can't balance reaction by this method</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BalancingError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Can&#39;t balance reaction by this method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.chem_output" class="doc doc-heading">
            <code>chem_output</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chem_output.ChemicalOutput" class="doc doc-heading">
            <code>ChemicalOutput</code>


</h3>


    <div class="doc doc-contents ">


        <p>Methods of this class prepare output from
<a class="autorefs autorefs-internal" href="#chemsynthcalc.chemical_formula.ChemicalFormula">ChemicalFormula</a>
and
<a class="autorefs autorefs-internal" href="#chemsynthcalc.chemical_reaction.ChemicalReaction">ChemicalReaction</a>
objects and output it in different ways.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>output</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output dictionary</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How many decimal places to print out</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of object ("formula" or "reaction")</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.chem_output.ChemicalOutput.rounded_values">rounded_values</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output dictionary rounded to print_precision</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.chem_output.ChemicalOutput.original_stdout">original_stdout</span></code></td>
            <td>
                  <code><span title="TextIO">TextIO</span> | <span title="Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default stdout</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="raise" open>
  <summary>Raise</summary>
  <p>ValueError if print_precision &lt;= 0 <br / >
ValueError if obj is not "ChemicalFormula" or "ChemicalReaction"</p>
</details>






              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chem_output.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChemicalOutput</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Methods of this class prepare output from</span>
<span class="sd">    [ChemicalFormula][chemsynthcalc.chemical_formula.ChemicalFormula]</span>
<span class="sd">    and</span>
<span class="sd">    [ChemicalReaction][chemsynthcalc.chemical_reaction.ChemicalReaction]</span>
<span class="sd">    objects and output it in different ways.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        output (dict[str, object]): Output dictionary</span>
<span class="sd">        print_precision (int): How many decimal places to print out</span>
<span class="sd">        obj (str): Type of object (&quot;formula&quot; or &quot;reaction&quot;)</span>

<span class="sd">    Attributes:</span>
<span class="sd">        rounded_values (dict[str, object]): Output dictionary rounded to print_precision</span>
<span class="sd">        original_stdout (TextIO | Any): Default stdout</span>

<span class="sd">    Raise:</span>
<span class="sd">        ValueError if print_precision &lt;= 0 &lt;br / &gt;</span>
<span class="sd">        ValueError if obj is not &quot;ChemicalFormula&quot; or &quot;ChemicalReaction&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">],</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">print_precision</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">print_precision</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;precision &lt;= 0&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">obj</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;ChemicalFormula&quot;</span><span class="p">,</span> <span class="s2">&quot;ChemicalReaction&quot;</span><span class="p">}:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No object of a class: </span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rounded_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round_values</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_round_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Round values of output dictionary to the print_precision.</span>
<span class="sd">        Rounding is different depending on the type of the value.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Rounded dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rounded_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                <span class="n">rounded_value</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">rounded_value</span> <span class="o">=</span> <span class="n">round_dict_content</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;masses&quot;</span><span class="p">:</span>
                <span class="n">rounded_value</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;reaction matrix&quot;</span><span class="p">:</span>
                <span class="n">rounded_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array2string</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rounded_value</span> <span class="o">=</span> <span class="n">value</span>

            <span class="n">rounded_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">name</span><span class="p">:</span> <span class="n">rounded_value</span><span class="p">})</span>  <span class="c1"># type: ignore</span>

        <span class="k">return</span> <span class="n">rounded_dict</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a filename for an output file in the form of:</span>
<span class="sd">        &quot;CSC_object type_formula or target_nanosec since the Epoch.txt or json&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            String of a filename</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">==</span> <span class="s2">&quot;ChemicalFormula&quot;</span><span class="p">:</span>
            <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;CSC_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;formula&quot;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;CSC_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;target&quot;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">filename</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_print_additional_reaction_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print output masses in a user-friendly human-readable format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">formula</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="s2">&quot;formulas&quot;</span><span class="p">]):</span>  <span class="c1"># type: ignore</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: M = </span><span class="si">%s</span><span class="s2"> g/mol, m = </span><span class="si">%s</span><span class="s2"> g&quot;</span>
                <span class="o">%</span> <span class="p">(</span>
                    <span class="n">formula</span><span class="p">,</span>
                    <span class="s2">&quot;%.</span><span class="si">{0}</span><span class="s2">f&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">)</span>
                    <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="s2">&quot;molar masses&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
                    <span class="s2">&quot;%.</span><span class="si">{0}</span><span class="s2">f&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">)</span>
                    <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="s2">&quot;masses&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_print_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Final print stream that can go to different outputs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">rounded_value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rounded_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;reaction matrix&quot;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">rounded_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">rounded_value</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">==</span> <span class="s2">&quot;ChemicalReaction&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_print_additional_reaction_results</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print a final result of calculations in stdout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_stdout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_stream</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_to_txt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Export the final result of the calculations in a txt file.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            filename (str): filename string (should end with .txt)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_filename</span><span class="p">(</span><span class="s2">&quot;txt&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">file</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_print_stream</span><span class="p">()</span>

        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_stdout</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dump_to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Serialization of output into JSON object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A JSON-type object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rounded_values</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_to_json_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Export a final result of calculations in a JSON file.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            filename (str): filename string (should end with .json)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_filename</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dump_to_json</span><span class="p">()),</span> <span class="n">file</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chem_output.ChemicalOutput._round_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_round_values</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Round values of output dictionary to the print_precision.
Rounding is different depending on the type of the value.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rounded dictionary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chem_output.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_round_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Round values of output dictionary to the print_precision.</span>
<span class="sd">    Rounding is different depending on the type of the value.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Rounded dictionary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rounded_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">rounded_value</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">rounded_value</span> <span class="o">=</span> <span class="n">round_dict_content</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;masses&quot;</span><span class="p">:</span>
            <span class="n">rounded_value</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;reaction matrix&quot;</span><span class="p">:</span>
            <span class="n">rounded_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array2string</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rounded_value</span> <span class="o">=</span> <span class="n">value</span>

        <span class="n">rounded_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">name</span><span class="p">:</span> <span class="n">rounded_value</span><span class="p">})</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="n">rounded_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chem_output.ChemicalOutput._generate_filename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_generate_filename</span><span class="p">(</span><span class="n">file_type</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generates a filename for an output file in the form of:
"CSC_object type_formula or target_nanosec since the Epoch.txt or json"</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String of a filename</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chem_output.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_generate_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a filename for an output file in the form of:</span>
<span class="sd">    &quot;CSC_object type_formula or target_nanosec since the Epoch.txt or json&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        String of a filename</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">==</span> <span class="s2">&quot;ChemicalFormula&quot;</span><span class="p">:</span>
        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;CSC_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;formula&quot;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;CSC_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;target&quot;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">filename</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chem_output.ChemicalOutput._print_additional_reaction_results" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_print_additional_reaction_results</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Print output masses in a user-friendly human-readable format.</p>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chem_output.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_print_additional_reaction_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print output masses in a user-friendly human-readable format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">formula</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="s2">&quot;formulas&quot;</span><span class="p">]):</span>  <span class="c1"># type: ignore</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: M = </span><span class="si">%s</span><span class="s2"> g/mol, m = </span><span class="si">%s</span><span class="s2"> g&quot;</span>
            <span class="o">%</span> <span class="p">(</span>
                <span class="n">formula</span><span class="p">,</span>
                <span class="s2">&quot;%.</span><span class="si">{0}</span><span class="s2">f&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">)</span>
                <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="s2">&quot;molar masses&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
                <span class="s2">&quot;%.</span><span class="si">{0}</span><span class="s2">f&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">)</span>
                <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="s2">&quot;masses&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_precision</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chem_output.ChemicalOutput._print_stream" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_print_stream</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Final print stream that can go to different outputs.</p>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chem_output.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_print_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Final print stream that can go to different outputs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">rounded_value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rounded_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;reaction matrix&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">rounded_value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">rounded_value</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">==</span> <span class="s2">&quot;ChemicalReaction&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_additional_reaction_results</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chem_output.ChemicalOutput.print_results" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_results</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Print a final result of calculations in stdout.</p>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chem_output.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print a final result of calculations in stdout.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_stdout</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_print_stream</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chem_output.ChemicalOutput.write_to_txt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_to_txt</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Export the final result of the calculations in a txt file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename string (should end with .txt)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chem_output.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_to_txt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export the final result of the calculations in a txt file.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        filename (str): filename string (should end with .txt)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_filename</span><span class="p">(</span><span class="s2">&quot;txt&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_stream</span><span class="p">()</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_stdout</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chem_output.ChemicalOutput.dump_to_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dump_to_json</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Serialization of output into JSON object.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A JSON-type object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chem_output.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dump_to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Serialization of output into JSON object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A JSON-type object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rounded_values</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chem_output.ChemicalOutput.write_to_json_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_to_json_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Export a final result of calculations in a JSON file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename string (should end with .json)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chem_output.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_to_json_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export a final result of calculations in a JSON file.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        filename (str): filename string (should end with .json)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_filename</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dump_to_json</span><span class="p">()),</span> <span class="n">file</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.chemical_formula" class="doc doc-heading">
            <code>chemical_formula</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chemical_formula.ChemicalFormula" class="doc doc-heading">
            <code>ChemicalFormula</code>


</h3>


    <div class="doc doc-contents ">


        <p>A class for operations on a single chemical formula.</p>
<p>It constructs with a formula string and can calculate
parsed formula, molar mass, mass percent, atomic percent,
oxide percent from this string using
<a class="autorefs autorefs-internal" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser">ChemicalFormulaParser</a> and
<a class="autorefs autorefs-internal" href="#chemsynthcalc.molar_mass.MolarMassCalculation">MolarMassCalculation</a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>formula</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String of chemical formula</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>*custom_oxides</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="str">str</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An arbitrary number of non-default oxide formulas</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value of rounding precision (8 by default)</p>
              </div>
            </td>
            <td>
                  <code>8</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="raise" open>
  <summary>Raise</summary>
  <p>ValueError: if precision &lt;= 0</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span>
<span class="go">H2O</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">molar_mass</span>
<span class="go">18.015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mass_percent</span>
<span class="go">{&#39;H&#39;: 11.19067444, &#39;O&#39;: 88.80932556}</span>
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chemical_formula.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChemicalFormula</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class for operations on a single chemical formula.</span>

<span class="sd">    It constructs with a formula string and can calculate</span>
<span class="sd">    parsed formula, molar mass, mass percent, atomic percent,</span>
<span class="sd">    oxide percent from this string using</span>
<span class="sd">    [ChemicalFormulaParser][chemsynthcalc.formula_parser.ChemicalFormulaParser] and</span>
<span class="sd">    [MolarMassCalculation][chemsynthcalc.molar_mass.MolarMassCalculation].</span>

<span class="sd">    Parameters:</span>
<span class="sd">        formula (str): String of chemical formula</span>
<span class="sd">        *custom_oxides (tuple[str, ...]): An arbitrary number of non-default oxide formulas</span>
<span class="sd">        precision (int): Value of rounding precision (8 by default)</span>

<span class="sd">    Raise:</span>
<span class="sd">        ValueError: if precision &lt;= 0</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; ChemicalFormula(&quot;H2O&quot;)</span>
<span class="sd">        H2O</span>
<span class="sd">        &gt;&gt;&gt; ChemicalFormula(&quot;H2O&quot;).molar_mass</span>
<span class="sd">        18.015</span>
<span class="sd">        &gt;&gt;&gt; ChemicalFormula(&quot;H2O&quot;).mass_percent</span>
<span class="sd">        {&#39;H&#39;: 11.19067444, &#39;O&#39;: 88.80932556}</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">formula</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">custom_oxides</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">FormulaValidator</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span><span class="o">.</span><span class="n">validate_formula</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_formula</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">formula</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">precision</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">precision</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;precision &lt;= 0&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">custom_oxides</span> <span class="o">=</span> <span class="n">custom_oxides</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ChemicalFormula(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">formula</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A string of chemical formula.</span>
<span class="sd">        It is made a property to be relatively immutable.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The formula string</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalFormula(&quot;K2SO4&quot;).formula</span>
<span class="sd">            K2SO4</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_formula</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parsed_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Formula parsed into dictionary keeping the initial atom order.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Parsed dictionary representation of formula string created \</span>
<span class="sd">            by [ChemicalFormulaParser][chemsynthcalc.formula_parser.ChemicalFormulaParser]</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalFormula(&quot;K2SO4&quot;).parsed_formula</span>
<span class="sd">            {&#39;K&#39;: 2.0, &#39;S&#39;: 1.0, &#39;O&#39;: 4.0}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parsed</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChemicalFormulaParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)</span><span class="o">.</span><span class="n">parse_formula</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">round_dict_content</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span> <span class="n">plus</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">molar_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Molar mass of the compound.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The [molar mass](https://en.wikipedia.org/wiki/Molar_mass) \</span>
<span class="sd">            of the formula (in g/mol), calculated from \</span>
<span class="sd">            parsed the formula using [MolarMassCalculation][chemsynthcalc.molar_mass.MolarMassCalculation].</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalFormula(&quot;K2SO4&quot;).molar_mass</span>
<span class="sd">            174.252</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span>
            <span class="n">MolarMassCalculation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="p">)</span><span class="o">.</span><span class="n">calculate_molar_mass</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mass_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The percentage of mass of atoms in the formula.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A mass percent or \</span>
<span class="sd">            [relative mass fraction](https://en.wikipedia.org/wiki/Mass_fraction_(chemistry)) \</span>
<span class="sd">            of atoms in parsed chemical formula. The values of \</span>
<span class="sd">            mass content are in % (with 100% sum), not fraction. </span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalFormula(&quot;K2SO4&quot;).mass_percent</span>
<span class="sd">            {&#39;K&#39;: 44.87523816, &#39;S&#39;: 18.39864105, &#39;O&#39;: 36.72612079}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">MolarMassCalculation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="p">)</span><span class="o">.</span><span class="n">calculate_mass_percent</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">round_dict_content</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atomic_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Atomic percents of atoms in the formula.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An atomic percent or \</span>
<span class="sd">            [relative mole fraction](https://en.wikipedia.org/wiki/Mole_fraction) \</span>
<span class="sd">            dictionary of atoms in a parsed chemical formula. \</span>
<span class="sd">            The values of mole content are in % (with 100% sum), \</span>
<span class="sd">            not fraction.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalFormula(&quot;K2SO4&quot;).atomic_percent</span>
<span class="sd">            {&#39;K&#39;: 28.57142857, &#39;S&#39;: 14.28571429, &#39;O&#39;: 57.14285714}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">MolarMassCalculation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="p">)</span><span class="o">.</span><span class="n">calculate_atomic_percent</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">round_dict_content</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">oxide_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Oxide percents of metals in formula. Custom oxide formulas can be provided</span>
<span class="sd">        with object init.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An oxide percent or \</span>
<span class="sd">            [oxide fraction](https://d32ogoqmya1dw8.cloudfront.net/files/introgeo/studio/examples/minex02.pdf) \</span>
<span class="sd">            dictionary of atoms in parsed chemical formula. Oxide types are listed \</span>
<span class="sd">            in the [chemsynthcalc.periodic_table][] file and can be changed to \</span>
<span class="sd">            any oxide formula. The values of oxide content \</span>
<span class="sd">            are in % (with 100% sum), not fraction.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalFormula(&quot;K2SO4&quot;).oxide_percent</span>
<span class="sd">            {&#39;K2O&#39;: 54.05676836, &#39;SO3&#39;: 45.94323164}</span>
<span class="sd">            &gt;&gt;&gt; ChemicalFormula(&quot;K2FeO4&quot;, &quot;FeO3&quot;).oxide_percent</span>
<span class="sd">            {&#39;K2O&#39;: 47.56434404, &#39;FeO3&#39;: 52.43565596}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">MolarMassCalculation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="p">)</span><span class="o">.</span><span class="n">calculate_oxide_percent</span><span class="p">(</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_oxides</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">round_dict_content</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">output_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dictionary of the calculation result output for class.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Output dictionary for all properties listed above</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalFormula(&quot;K2SO4&quot;).output_results</span>
<span class="sd">            {&#39;formula&#39;: &#39;K2SO4&#39;, &#39;parsed formula&#39;: {&#39;K&#39;: 2.0, &#39;S&#39;: 1.0, &#39;O&#39;: 4.0},</span>
<span class="sd">            &#39;molar mass&#39;: 174.252, &#39;mass percent&#39;: {&#39;K&#39;: 44.87523816, &#39;S&#39;: 18.39864105, &#39;O&#39;: 36.72612079},</span>
<span class="sd">            &#39;atomic percent&#39;: {&#39;K&#39;: 28.57142857, &#39;S&#39;: 14.28571429, &#39;O&#39;: 57.14285714},</span>
<span class="sd">            &#39;oxide percent&#39;: {&#39;K2O&#39;: 54.05676836, &#39;SO3&#39;: 45.94323164}}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;formula&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">,</span>
            <span class="s2">&quot;parsed formula&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="p">,</span>
            <span class="s2">&quot;molar mass&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span><span class="p">,</span>
            <span class="s2">&quot;mass percent&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_percent</span><span class="p">,</span>
            <span class="s2">&quot;atomic percent&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomic_percent</span><span class="p">,</span>
            <span class="s2">&quot;oxide percent&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">oxide_percent</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print a final result of calculations in stdout.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            print_precision (int): print precision (4 digits by default)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ChemicalOutput</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="p">)</span><span class="o">.</span><span class="n">print_results</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_txt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Export the final result of the calculations in a txt file.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            filename (str): filename string (should end with .txt)</span>
<span class="sd">            print_precision (int): print precision (4 digits by default)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ChemicalOutput</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="p">)</span><span class="o">.</span><span class="n">write_to_txt</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Serialization of output into JSON object.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            print_precision (int): print precision (4 digits by default)</span>

<span class="sd">        Returns:</span>
<span class="sd">            A JSON-type object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ChemicalOutput</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="p">)</span><span class="o">.</span><span class="n">dump_to_json</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_json_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Export a final result of calculations in a JSON file.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            filename (str): filename string (should end with .json)</span>
<span class="sd">            print_precision (int): print precision (4 digits by default)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ChemicalOutput</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="p">)</span><span class="o">.</span><span class="n">write_to_json_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_formula.ChemicalFormula.formula" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">formula</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A string of chemical formula.
It is made a property to be relatively immutable.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The formula string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;K2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">formula</span>
<span class="go">K2SO4</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_formula.ChemicalFormula.parsed_formula" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parsed_formula</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Formula parsed into dictionary keeping the initial atom order.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parsed dictionary representation of formula string created             by <a class="autorefs autorefs-internal" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser">ChemicalFormulaParser</a></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;K2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parsed_formula</span>
<span class="go">{&#39;K&#39;: 2.0, &#39;S&#39;: 1.0, &#39;O&#39;: 4.0}</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_formula.ChemicalFormula.molar_mass" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">molar_mass</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Molar mass of the compound.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The <a href="https://en.wikipedia.org/wiki/Molar_mass">molar mass</a>             of the formula (in g/mol), calculated from             parsed the formula using <a class="autorefs autorefs-internal" href="#chemsynthcalc.molar_mass.MolarMassCalculation">MolarMassCalculation</a>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;K2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">molar_mass</span>
<span class="go">174.252</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_formula.ChemicalFormula.mass_percent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mass_percent</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The percentage of mass of atoms in the formula.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A mass percent or             <a href="https://en.wikipedia.org/wiki/Mass_fraction_(chemistry)">relative mass fraction</a>             of atoms in parsed chemical formula. The values of             mass content are in % (with 100% sum), not fraction. </p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;K2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mass_percent</span>
<span class="go">{&#39;K&#39;: 44.87523816, &#39;S&#39;: 18.39864105, &#39;O&#39;: 36.72612079}</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_formula.ChemicalFormula.atomic_percent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atomic_percent</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Atomic percents of atoms in the formula.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An atomic percent or             <a href="https://en.wikipedia.org/wiki/Mole_fraction">relative mole fraction</a>             dictionary of atoms in a parsed chemical formula.             The values of mole content are in % (with 100% sum),             not fraction.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;K2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">atomic_percent</span>
<span class="go">{&#39;K&#39;: 28.57142857, &#39;S&#39;: 14.28571429, &#39;O&#39;: 57.14285714}</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_formula.ChemicalFormula.oxide_percent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">oxide_percent</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Oxide percents of metals in formula. Custom oxide formulas can be provided
with object init.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An oxide percent or             <a href="https://d32ogoqmya1dw8.cloudfront.net/files/introgeo/studio/examples/minex02.pdf">oxide fraction</a>             dictionary of atoms in parsed chemical formula. Oxide types are listed             in the <a class="autorefs autorefs-internal" title="periodic_table" href="#chemsynthcalc.periodic_table">chemsynthcalc.periodic_table</a> file and can be changed to             any oxide formula. The values of oxide content             are in % (with 100% sum), not fraction.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;K2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">oxide_percent</span>
<span class="go">{&#39;K2O&#39;: 54.05676836, &#39;SO3&#39;: 45.94323164}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;K2FeO4&quot;</span><span class="p">,</span> <span class="s2">&quot;FeO3&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">oxide_percent</span>
<span class="go">{&#39;K2O&#39;: 47.56434404, &#39;FeO3&#39;: 52.43565596}</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_formula.ChemicalFormula.output_results" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">output_results</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Dictionary of the calculation result output for class.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output dictionary for all properties listed above</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;K2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">output_results</span>
<span class="go">{&#39;formula&#39;: &#39;K2SO4&#39;, &#39;parsed formula&#39;: {&#39;K&#39;: 2.0, &#39;S&#39;: 1.0, &#39;O&#39;: 4.0},</span>
<span class="go">&#39;molar mass&#39;: 174.252, &#39;mass percent&#39;: {&#39;K&#39;: 44.87523816, &#39;S&#39;: 18.39864105, &#39;O&#39;: 36.72612079},</span>
<span class="go">&#39;atomic percent&#39;: {&#39;K&#39;: 28.57142857, &#39;S&#39;: 14.28571429, &#39;O&#39;: 57.14285714},</span>
<span class="go">&#39;oxide percent&#39;: {&#39;K2O&#39;: 54.05676836, &#39;SO3&#39;: 45.94323164}}</span>
</code></pre></div>

    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chemical_formula.ChemicalFormula.print_results" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_results</span><span class="p">(</span><span class="n">print_precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Print a final result of calculations in stdout.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>print_precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>print precision (4 digits by default)</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chemical_formula.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print a final result of calculations in stdout.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        print_precision (int): print precision (4 digits by default)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ChemicalOutput</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="p">)</span><span class="o">.</span><span class="n">print_results</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chemical_formula.ChemicalFormula.to_txt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_txt</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">print_precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Export the final result of the calculations in a txt file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename string (should end with .txt)</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>print precision (4 digits by default)</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chemical_formula.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_txt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export the final result of the calculations in a txt file.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        filename (str): filename string (should end with .txt)</span>
<span class="sd">        print_precision (int): print precision (4 digits by default)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ChemicalOutput</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="p">)</span><span class="o">.</span><span class="n">write_to_txt</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chemical_formula.ChemicalFormula.to_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_json</span><span class="p">(</span><span class="n">print_precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Serialization of output into JSON object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>print_precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>print precision (4 digits by default)</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A JSON-type object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chemical_formula.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Serialization of output into JSON object.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        print_precision (int): print precision (4 digits by default)</span>

<span class="sd">    Returns:</span>
<span class="sd">        A JSON-type object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ChemicalOutput</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="p">)</span><span class="o">.</span><span class="n">dump_to_json</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chemical_formula.ChemicalFormula.to_json_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_json_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">print_precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Export a final result of calculations in a JSON file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename string (should end with .json)</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>print precision (4 digits by default)</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chemical_formula.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_json_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export a final result of calculations in a JSON file.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        filename (str): filename string (should end with .json)</span>
<span class="sd">        print_precision (int): print precision (4 digits by default)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ChemicalOutput</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="p">)</span><span class="o">.</span><span class="n">write_to_json_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.chemical_reaction" class="doc doc-heading">
            <code>chemical_reaction</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.chemical_reaction.ChemicalReaction" class="doc doc-heading">
            <code>ChemicalReaction</code>


</h3>


    <div class="doc doc-contents ">


        <p>A class that represents a chemical reaction and do operations on it.</p>
<p>There are three calculation modes:</p>
<ol>
<li>
<p>The "force" mode is used when a user enters coefficients
in the reaction string and wants the masses to be calculated
whether the reaction is balanced or not.</p>
</li>
<li>
<p>"check" mode is the same as force, but with reaction
balance checks.</p>
</li>
<li>
<p>"balance" mode  tries to automatically calculate
coefficients from the reaction string.</p>
</li>
</ol>


<details class="important" open>
  <summary>Important</summary>
  <p>Unlike other properties of this class, the <a class="autorefs autorefs-internal" title="coefficients

  
      cached
      property
  " href="#chemsynthcalc.chemical_reaction.ChemicalReaction.coefficients">coefficients</a>
property can be set directly.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>reaction</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A reaction string</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mode</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coefficients calculation mode</p>
              </div>
            </td>
            <td>
                  <code>&#39;balance&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of target compound (0 by default, or first compound in the products), can be negative (limited by reactant)</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_mass</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Desired mass of target compound (in grams)</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value of rounding precision (8 by default)</p>
              </div>
            </td>
            <td>
                  <code>8</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>intify</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Is it required to convert the coefficients to integer values?</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.chemical_reaction.ChemicalReaction.algorithm">algorithm</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Currently used calculation algorithm</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="raise" open>
  <summary>Raise</summary>
  <p>ValueError if precision or target mass &lt;= 0</p>
</details>






              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/chemical_reaction.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChemicalReaction</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class that represents a chemical reaction and do operations on it.</span>

<span class="sd">    There are three calculation modes:</span>

<span class="sd">    1. The &quot;force&quot; mode is used when a user enters coefficients</span>
<span class="sd">    in the reaction string and wants the masses to be calculated</span>
<span class="sd">    whether the reaction is balanced or not.</span>

<span class="sd">    2. &quot;check&quot; mode is the same as force, but with reaction</span>
<span class="sd">    balance checks.</span>

<span class="sd">    3. &quot;balance&quot; mode  tries to automatically calculate</span>
<span class="sd">    coefficients from the reaction string.</span>

<span class="sd">    Important:</span>
<span class="sd">        Unlike other properties of this class, the [coefficients][chemsynthcalc.chemical_reaction.ChemicalReaction.coefficients]</span>
<span class="sd">        property can be set directly.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        reaction (str): A reaction string</span>
<span class="sd">        mode (str): Coefficients calculation mode</span>
<span class="sd">        target (int): Index of target compound (0 by default, or first compound in the products), can be negative (limited by reactant)</span>
<span class="sd">        target_mass (float): Desired mass of target compound (in grams)</span>
<span class="sd">        precision (int): Value of rounding precision (8 by default)</span>
<span class="sd">        intify (bool): Is it required to convert the coefficients to integer values?</span>

<span class="sd">    Attributes:</span>
<span class="sd">        algorithm (str): Currently used calculation algorithm</span>

<span class="sd">    Raise:</span>
<span class="sd">        ValueError if precision or target mass &lt;= 0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">reaction</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;balance&quot;</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">target_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
        <span class="n">intify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ReactionValidator</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span><span class="o">.</span><span class="n">validate_reaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_reaction</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">precision</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">precision</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;precision &lt;= 0&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">target_mass</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">target_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">target_mass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;target mass &lt;= 0&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">intify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">intify</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;user&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_target</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">target</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ChemicalReaction(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_target</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_mass</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">intify</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">reaction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A string of chemical reaction.</span>
<span class="sd">        It is made a property to be relatively immutable.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The reaction string</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;H2+O2=H2O&quot;).reaction</span>
<span class="sd">            H2+O2=H2O</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_reaction</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">decomposed_reaction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ReactionDecomposer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Decomposition of chemical reaction string and extraction of</span>
<span class="sd">        reaction separator, reactants, products and initial coefficients.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A ReactionDecomposer object</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;H2+O2=H2O&quot;).decomposed_reaction</span>
<span class="sd">            separator: =; reactants: [&#39;H2&#39;, &#39;O2&#39;]; products: [&#39;H2O&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ReactionDecomposer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_calculated_target</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if initial_target is in the reaction&#39;s compounds range,</span>
<span class="sd">        and calculates the usable target integer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Final target</span>

<span class="sd">        Raise:</span>
<span class="sd">            IndexError if The target integer is not in the range</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;H2+O2=H2O&quot;)._calculated_target</span>
<span class="sd">            2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">high</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">products</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">low</span> <span class="o">=</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_target</span> <span class="o">&lt;=</span> <span class="n">high</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_target</span> <span class="o">&gt;=</span> <span class="n">low</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_target</span> <span class="o">-</span> <span class="n">low</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The target integer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_target</span><span class="si">}</span><span class="s2"> should be in range </span><span class="si">{</span><span class="n">low</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">high</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">chemformula_objs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ChemicalFormula</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Decomposition of a list of formulas from the decomposed_reaction.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Every compound as ChemicalFormula object</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;H2+O2=H2O&quot;).chemformula_objs</span>
<span class="sd">            [ChemicalFormula(&#39;H2&#39;, 8), ChemicalFormula(&#39;O2&#39;, 8), ChemicalFormula(&#39;H2O&#39;, 8)]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">ChemicalFormula</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">formula</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">compounds</span>
        <span class="p">]</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parsed_formulas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of formulas parsed by [ChemicalFormulaParser][chemsynthcalc.formula_parser.ChemicalFormulaParser]</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;).parsed_formulas</span>
<span class="sd">            [{&#39;K&#39;: 1.0, &#39;Mn&#39;: 1.0, &#39;O&#39;: 4.0}, {&#39;H&#39;: 1.0, &#39;Cl&#39;: 1.0}, {&#39;Mn&#39;: 1.0, &#39;Cl&#39;: 2.0}, {&#39;Cl&#39;: 2.0}, {&#39;H&#39;: 2.0, &#39;O&#39;: 1.0}, {&#39;K&#39;: 1.0, &#39;Cl&#39;: 1.0}]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">compound</span><span class="o">.</span><span class="n">parsed_formula</span> <span class="k">for</span> <span class="n">compound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemformula_objs</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Chemical reaction matrix.</span>

<span class="sd">        The first implementation of reaction matrix method is probably</span>
<span class="sd">        belongs to [Blakley](https://doi.org/10.1021/ed059p728). In general,</span>
<span class="sd">        a chemical reaction matrix is composed of the coefficients of each</span>
<span class="sd">        atom in each compound, giving a 2D array. The matrix composes</span>
<span class="sd">        naturally from previously parsed formulas.</span>

<span class="sd">        Returns:</span>
<span class="sd">            2D array of each atom amount in each formula</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;).matrix</span>
<span class="sd">            [[1. 0. 0. 0. 0. 1.]  (K)</span>
<span class="sd">            [1. 0. 1. 0. 0. 0.]   (Mn)</span>
<span class="sd">            [4. 0. 0. 0. 1. 0.]   (O)</span>
<span class="sd">            [0. 1. 0. 0. 2. 0.]   (H)</span>
<span class="sd">            [0. 1. 2. 2. 0. 1.]]  (Cl)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ChemicalReactionMatrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_formulas</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">balancer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Balancer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A balancer to  automatically balance chemical reaction by different matrix methods.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A Balancer object</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;).balancer</span>
<span class="sd">            Balancer object for matrix</span>
<span class="sd">            [[1. 0. 0. 0. 0. 1.]</span>
<span class="sd">            [1. 0. 1. 0. 0. 0.]</span>
<span class="sd">            [4. 0. 0. 0. 1. 0.]</span>
<span class="sd">            [0. 1. 0. 0. 2. 0.]</span>
<span class="sd">            [0. 1. 2. 2. 0. 1.]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Balancer</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span>
            <span class="n">intify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intify</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">molar_masses</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of molar masses (in g/mol)</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of molar masses of each compound in [chemformula_objs][chemsynthcalc.chemical_reaction.ChemicalReaction.chemformula_objs]&quot;</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;).molar_masses</span>
<span class="sd">            [158.032043, 36.458, 125.838043, 70.9, 18.015, 74.548]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">compound</span><span class="o">.</span><span class="n">molar_mass</span> <span class="k">for</span> <span class="n">compound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemformula_objs</span><span class="p">]</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Coefficients of the chemical reaction. Can be calculated (balance mode),</span>
<span class="sd">        striped off the initial reaction string (force or check modes) or set directly.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of coefficients</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;, mode=&quot;balance&quot;).coefficients</span>
<span class="sd">            [2, 16, 2, 5, 8, 2]</span>
<span class="sd">            &gt;&gt;&gt; reaction = ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;, mode=&quot;check&quot;)</span>
<span class="sd">            &gt;&gt;&gt; reaction.coefficients = [2, 16, 2, 5, 8, 2]</span>
<span class="sd">            &gt;&gt;&gt; reaction.coefficients</span>
<span class="sd">            [2, 16, 2, 5, 8, 2]</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;2H2+2O2=H2O&quot;, mode=&quot;force&quot;).coefficients</span>
<span class="sd">            [2, 2, 1]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coefs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">Coefficients</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parsed_formulas</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">balancer</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">get_coefficients</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">coefs</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">normalized_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of coefficients normalized on target compound.</span>

<span class="sd">        Target coefficient = 1.0</span>

<span class="sd">        Returns:</span>
<span class="sd">            Normalized coefficients</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;).normalized_coefficients</span>
<span class="sd">            [1, 8, 1, 2.5, 4, 1]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Coefficients</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parsed_formulas</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">balancer</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">coefficients_validation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span>

        <span class="n">target_compound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_calculated_target</span><span class="p">]</span>
        <span class="n">normalized_coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">coef</span> <span class="o">/</span> <span class="n">target_compound</span> <span class="k">for</span> <span class="n">coef</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">is_integer</span><span class="p">()</span> <span class="k">else</span> <span class="nb">round</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">normalized_coefficients</span>
        <span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_balanced</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is the reaction balanced with the current coefficients?</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the reaction is balanced</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;).is_balanced</span>
<span class="sd">            True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Balancer</span><span class="o">.</span><span class="n">is_reaction_balanced</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">balancer</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">balancer</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_final_reaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coefs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Final reaction string with connotated formulas and calculated coefficients.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            coefs ( list[float | int] | list[int]): list of coefficients</span>

<span class="sd">        Returns:</span>
<span class="sd">            String of the final reaction</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;)._generate_final_reaction([2, 16, 2, 5, 8, 2])</span>
<span class="sd">            2KMnO4+16HCl=2MnCl2+5Cl2+8H2O+2KCl</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">final_reaction</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">coefs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">compound</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">coefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">coefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">1.0</span>
                <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">compound</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">compound</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">compounds</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">final_reaction</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactant_separator</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">final_reaction</span>
        <span class="p">)</span>
        <span class="n">final_reaction</span> <span class="o">=</span> <span class="n">final_reaction</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactant_separator</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">separator</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">final_reaction</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">final_reaction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Final representation of the reaction with coefficients.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A string of the final reaction</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;).final_reaction</span>
<span class="sd">            2KMnO4+16HCl=2MnCl2+5Cl2+8H2O+2KCl</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_final_reaction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">final_reaction_normalized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Final representation of the reaction with normalized coefficients.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A string of the normalized final reaction</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;).final_reaction_normalized</span>
<span class="sd">            KMnO4+8HCl=MnCl2+2.5Cl2+4H2O+KCl</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_final_reaction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalized_coefficients</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">masses</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of masses of compounds (in grams).</span>

<span class="sd">        List of masses of the of formulas in reaction</span>
<span class="sd">        calculated with coefficients obtained by any of the 3 methods.</span>
<span class="sd">        Calculates masses by calculating amount of substance nu (nu=mass/molar mass).</span>
<span class="sd">        Coefficients of reaction are normalized to the target. After nu of target compound is</span>
<span class="sd">        calculated, it broadcasted to other compounds (with respect to their coefficients).</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of masses of compounds</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;).masses</span>
<span class="sd">            [1.25583678, 2.31777285, 1.0, 1.40855655, 0.57264082, 0.59241226]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_mass</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">molar_masses</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_calculated_target</span><span class="p">]</span>
        <span class="n">masses</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">round</span><span class="p">(</span><span class="n">molar</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalized_coefficients</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">molar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molar_masses</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">masses</span>

    <span class="nd">@property</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">output_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Collection of every output of calculated ChemicalReaction properties.</span>

<span class="sd">        Returns:</span>
<span class="sd">            All outputs collected in one dictionary.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;).output_results</span>
<span class="sd">            {&#39;initial reaction&#39;: &#39;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&#39;,</span>
<span class="sd">            &#39;reaction matrix&#39;: array([[1., 0., 0., 0., 0., 1.],</span>
<span class="sd">            [1., 0., 1., 0., 0., 0.],</span>
<span class="sd">            [4., 0., 0., 0., 1., 0.],</span>
<span class="sd">            [0., 1., 0., 0., 2., 0.],</span>
<span class="sd">            [0., 1., 2., 2., 0., 1.]]),</span>
<span class="sd">            &#39;mode&#39;: &#39;balance&#39;,</span>
<span class="sd">            &#39;formulas&#39;: [&#39;KMnO4&#39;, &#39;HCl&#39;, &#39;MnCl2&#39;, &#39;Cl2&#39;, &#39;H2O&#39;, &#39;KCl&#39;],</span>
<span class="sd">            &#39;coefficients&#39;: [2, 16, 2, 5, 8, 2],</span>
<span class="sd">            &#39;normalized coefficients&#39;: [1, 8, 1, 2.5, 4, 1],</span>
<span class="sd">            &#39;algorithm&#39;: &#39;inverse&#39;,</span>
<span class="sd">            &#39;is balanced&#39;: True,</span>
<span class="sd">            &#39;final reaction&#39;: &#39;2KMnO4+16HCl=2MnCl2+5Cl2+8H2O+2KCl&#39;,</span>
<span class="sd">            &#39;final reaction normalized&#39;: &#39;KMnO4+8HCl=MnCl2+2.5Cl2+4H2O+KCl&#39;,</span>
<span class="sd">            &#39;molar masses&#39;: [158.032043, 36.458, 125.838043, 70.9, 18.015, 74.548],</span>
<span class="sd">            &#39;target&#39;: &#39;MnCl2&#39;,</span>
<span class="sd">            &#39;masses&#39;: [1.25583678, 2.31777285, 1.0, 1.40855655, 0.57264082, 0.59241226]}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;initial reaction&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">,</span>
            <span class="s2">&quot;reaction matrix&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span>
            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
            <span class="s2">&quot;formulas&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span>
            <span class="s2">&quot;coefficients&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">,</span>
            <span class="s2">&quot;normalized coefficients&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalized_coefficients</span><span class="p">,</span>
            <span class="s2">&quot;algorithm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">,</span>
            <span class="s2">&quot;is balanced&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">,</span>
            <span class="s2">&quot;final reaction&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_reaction</span><span class="p">,</span>
            <span class="s2">&quot;final reaction normalized&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_reaction_normalized</span><span class="p">,</span>
            <span class="s2">&quot;molar masses&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">molar_masses</span><span class="p">,</span>
            <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">compounds</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_calculated_target</span><span class="p">],</span>
            <span class="s2">&quot;masses&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">masses</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print a final result of calculations in stdout.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            print_precision (int): print precision (4 digits by default)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ChemicalOutput</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="p">)</span><span class="o">.</span><span class="n">print_results</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_txt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Export the final result of the calculations in a txt file.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            filename (str): filename string (should end with .txt)</span>
<span class="sd">            print_precision (int): print precision (4 digits by default)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ChemicalOutput</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="p">)</span><span class="o">.</span><span class="n">write_to_txt</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Serialization of output into JSON object.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            print_precision (int): print precision (4 digits by default)</span>

<span class="sd">        Returns:</span>
<span class="sd">            A JSON-type object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ChemicalOutput</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="p">)</span><span class="o">.</span><span class="n">dump_to_json</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_json_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Export a final result of calculations in a JSON file.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            filename (str): filename string (should end with .json)</span>
<span class="sd">            print_precision (int): print precision (4 digits by default)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ChemicalOutput</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="p">)</span><span class="o">.</span><span class="n">write_to_json_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.reaction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reaction</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A string of chemical reaction.
It is made a property to be relatively immutable.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reaction string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;H2+O2=H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reaction</span>
<span class="go">H2+O2=H2O</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.decomposed_reaction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">decomposed_reaction</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Decomposition of chemical reaction string and extraction of
reaction separator, reactants, products and initial coefficients.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ReactionDecomposer (chemsynthcalc.reaction_decomposer.ReactionDecomposer)" href="#chemsynthcalc.reaction_decomposer.ReactionDecomposer">ReactionDecomposer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ReactionDecomposer object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;H2+O2=H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">decomposed_reaction</span>
<span class="go">separator: =; reactants: [&#39;H2&#39;, &#39;O2&#39;]; products: [&#39;H2O&#39;]</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction._calculated_target" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculated_target</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Checks if initial_target is in the reaction's compounds range,
and calculates the usable target integer.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Final target</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="raise" open>
  <summary>Raise</summary>
  <p>IndexError if The target integer is not in the range</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;H2+O2=H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">_calculated_target</span>
<span class="go">2</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.chemformula_objs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">chemformula_objs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Decomposition of a list of formulas from the decomposed_reaction.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="ChemicalFormula (chemsynthcalc.chemical_formula.ChemicalFormula)" href="#chemsynthcalc.chemical_formula.ChemicalFormula">ChemicalFormula</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Every compound as ChemicalFormula object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;H2+O2=H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">chemformula_objs</span>
<span class="go">[ChemicalFormula(&#39;H2&#39;, 8), ChemicalFormula(&#39;O2&#39;, 8), ChemicalFormula(&#39;H2O&#39;, 8)]</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.parsed_formulas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parsed_formulas</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>List of formulas parsed by <a class="autorefs autorefs-internal" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser">ChemicalFormulaParser</a></p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parsed_formulas</span>
<span class="go">[{&#39;K&#39;: 1.0, &#39;Mn&#39;: 1.0, &#39;O&#39;: 4.0}, {&#39;H&#39;: 1.0, &#39;Cl&#39;: 1.0}, {&#39;Mn&#39;: 1.0, &#39;Cl&#39;: 2.0}, {&#39;Cl&#39;: 2.0}, {&#39;H&#39;: 2.0, &#39;O&#39;: 1.0}, {&#39;K&#39;: 1.0, &#39;Cl&#39;: 1.0}]</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matrix</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Chemical reaction matrix.</p>
<p>The first implementation of reaction matrix method is probably
belongs to <a href="https://doi.org/10.1021/ed059p728">Blakley</a>. In general,
a chemical reaction matrix is composed of the coefficients of each
atom in each compound, giving a 2D array. The matrix composes
naturally from previously parsed formulas.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>2D array of each atom amount in each formula</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span>
<span class="go">[[1. 0. 0. 0. 0. 1.]  (K)</span>
<span class="go">[1. 0. 1. 0. 0. 0.]   (Mn)</span>
<span class="go">[4. 0. 0. 0. 1. 0.]   (O)</span>
<span class="go">[0. 1. 0. 0. 2. 0.]   (H)</span>
<span class="go">[0. 1. 2. 2. 0. 1.]]  (Cl)</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.balancer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">balancer</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A balancer to  automatically balance chemical reaction by different matrix methods.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Balancer (chemsynthcalc.balancer.Balancer)" href="#chemsynthcalc.balancer.Balancer">Balancer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Balancer object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">balancer</span>
<span class="go">Balancer object for matrix</span>
<span class="go">[[1. 0. 0. 0. 0. 1.]</span>
<span class="go">[1. 0. 1. 0. 0. 0.]</span>
<span class="go">[4. 0. 0. 0. 1. 0.]</span>
<span class="go">[0. 1. 0. 0. 2. 0.]</span>
<span class="go">[0. 1. 2. 2. 0. 1.]]</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.molar_masses" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">molar_masses</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>List of molar masses (in g/mol)</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of molar masses of each compound in <a class="autorefs autorefs-internal" title="chemformula_objs

  
      cached
      property
  " href="#chemsynthcalc.chemical_reaction.ChemicalReaction.chemformula_objs">chemformula_objs</a>"</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">molar_masses</span>
<span class="go">[158.032043, 36.458, 125.838043, 70.9, 18.015, 74.548]</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.coefficients" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">coefficients</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Coefficients of the chemical reaction. Can be calculated (balance mode),
striped off the initial reaction string (force or check modes) or set directly.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>] | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of coefficients</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;balance&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">coefficients</span>
<span class="go">[2, 16, 2, 5, 8, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;check&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients</span>
<span class="go">[2, 16, 2, 5, 8, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;2H2+2O2=H2O&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;force&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">coefficients</span>
<span class="go">[2, 2, 1]</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.normalized_coefficients" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">normalized_coefficients</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>List of coefficients normalized on target compound.</p>
<p>Target coefficient = 1.0</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>] | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Normalized coefficients</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">normalized_coefficients</span>
<span class="go">[1, 8, 1, 2.5, 4, 1]</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.is_balanced" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_balanced</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Is the reaction balanced with the current coefficients?</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the reaction is balanced</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span>
<span class="go">True</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.final_reaction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">final_reaction</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Final representation of the reaction with coefficients.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string of the final reaction</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">final_reaction</span>
<span class="go">2KMnO4+16HCl=2MnCl2+5Cl2+8H2O+2KCl</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.final_reaction_normalized" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">final_reaction_normalized</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Final representation of the reaction with normalized coefficients.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string of the normalized final reaction</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">final_reaction_normalized</span>
<span class="go">KMnO4+8HCl=MnCl2+2.5Cl2+4H2O+KCl</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.masses" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">masses</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>List of masses of compounds (in grams).</p>
<p>List of masses of the of formulas in reaction
calculated with coefficients obtained by any of the 3 methods.
Calculates masses by calculating amount of substance nu (nu=mass/molar mass).
Coefficients of reaction are normalized to the target. After nu of target compound is
calculated, it broadcasted to other compounds (with respect to their coefficients).</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of masses of compounds</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">masses</span>
<span class="go">[1.25583678, 2.31777285, 1.0, 1.40855655, 0.57264082, 0.59241226]</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.output_results" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">output_results</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Collection of every output of calculated ChemicalReaction properties.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>All outputs collected in one dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">output_results</span>
<span class="go">{&#39;initial reaction&#39;: &#39;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&#39;,</span>
<span class="go">&#39;reaction matrix&#39;: array([[1., 0., 0., 0., 0., 1.],</span>
<span class="go">[1., 0., 1., 0., 0., 0.],</span>
<span class="go">[4., 0., 0., 0., 1., 0.],</span>
<span class="go">[0., 1., 0., 0., 2., 0.],</span>
<span class="go">[0., 1., 2., 2., 0., 1.]]),</span>
<span class="go">&#39;mode&#39;: &#39;balance&#39;,</span>
<span class="go">&#39;formulas&#39;: [&#39;KMnO4&#39;, &#39;HCl&#39;, &#39;MnCl2&#39;, &#39;Cl2&#39;, &#39;H2O&#39;, &#39;KCl&#39;],</span>
<span class="go">&#39;coefficients&#39;: [2, 16, 2, 5, 8, 2],</span>
<span class="go">&#39;normalized coefficients&#39;: [1, 8, 1, 2.5, 4, 1],</span>
<span class="go">&#39;algorithm&#39;: &#39;inverse&#39;,</span>
<span class="go">&#39;is balanced&#39;: True,</span>
<span class="go">&#39;final reaction&#39;: &#39;2KMnO4+16HCl=2MnCl2+5Cl2+8H2O+2KCl&#39;,</span>
<span class="go">&#39;final reaction normalized&#39;: &#39;KMnO4+8HCl=MnCl2+2.5Cl2+4H2O+KCl&#39;,</span>
<span class="go">&#39;molar masses&#39;: [158.032043, 36.458, 125.838043, 70.9, 18.015, 74.548],</span>
<span class="go">&#39;target&#39;: &#39;MnCl2&#39;,</span>
<span class="go">&#39;masses&#39;: [1.25583678, 2.31777285, 1.0, 1.40855655, 0.57264082, 0.59241226]}</span>
</code></pre></div>

    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction._generate_final_reaction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_generate_final_reaction</span><span class="p">(</span><span class="n">coefs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Final reaction string with connotated formulas and calculated coefficients.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>coefs</code>
            </td>
            <td>
                  <code> list[float | int] | list[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of coefficients</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String of the final reaction</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">_generate_final_reaction</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">2KMnO4+16HCl=2MnCl2+5Cl2+8H2O+2KCl</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chemical_reaction.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_generate_final_reaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coefs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Final reaction string with connotated formulas and calculated coefficients.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        coefs ( list[float | int] | list[int]): list of coefficients</span>

<span class="sd">    Returns:</span>
<span class="sd">        String of the final reaction</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; ChemicalReaction(&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;)._generate_final_reaction([2, 16, 2, 5, 8, 2])</span>
<span class="sd">        2KMnO4+16HCl=2MnCl2+5Cl2+8H2O+2KCl</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">final_reaction</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">coefs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">compound</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">coefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">coefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">1.0</span>
            <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">compound</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">compound</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">compounds</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">final_reaction</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactant_separator</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">final_reaction</span>
    <span class="p">)</span>
    <span class="n">final_reaction</span> <span class="o">=</span> <span class="n">final_reaction</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactant_separator</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">separator</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">final_reaction</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.print_results" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_results</span><span class="p">(</span><span class="n">print_precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Print a final result of calculations in stdout.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>print_precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>print precision (4 digits by default)</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chemical_reaction.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print a final result of calculations in stdout.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        print_precision (int): print precision (4 digits by default)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ChemicalOutput</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="p">)</span><span class="o">.</span><span class="n">print_results</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.to_txt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_txt</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">print_precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Export the final result of the calculations in a txt file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename string (should end with .txt)</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>print precision (4 digits by default)</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chemical_reaction.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_txt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export the final result of the calculations in a txt file.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        filename (str): filename string (should end with .txt)</span>
<span class="sd">        print_precision (int): print precision (4 digits by default)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ChemicalOutput</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="p">)</span><span class="o">.</span><span class="n">write_to_txt</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.to_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_json</span><span class="p">(</span><span class="n">print_precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Serialization of output into JSON object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>print_precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>print precision (4 digits by default)</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A JSON-type object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chemical_reaction.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Serialization of output into JSON object.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        print_precision (int): print precision (4 digits by default)</span>

<span class="sd">    Returns:</span>
<span class="sd">        A JSON-type object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ChemicalOutput</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="p">)</span><span class="o">.</span><span class="n">dump_to_json</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.chemical_reaction.ChemicalReaction.to_json_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_json_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">print_precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Export a final result of calculations in a JSON file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename string (should end with .json)</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>print precision (4 digits by default)</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/chemical_reaction.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_json_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export a final result of calculations in a JSON file.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        filename (str): filename string (should end with .json)</span>
<span class="sd">        print_precision (int): print precision (4 digits by default)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ChemicalOutput</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_results</span><span class="p">,</span> <span class="n">print_precision</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="p">)</span><span class="o">.</span><span class="n">write_to_json_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.coefs" class="doc doc-heading">
            <code>coefs</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.coefs.Coefficients" class="doc doc-heading">
            <code>Coefficients</code>


</h3>


    <div class="doc doc-contents ">


        <p>A class to calculate and validate reaction coefficients depending on the calculation "mode".</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mode</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Calculation mode ("force", "check", "balance")</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parsed_formulas</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of formulas parsed by <a class="autorefs autorefs-internal" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser">ChemicalFormulaParser</a></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>matrix</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reaction matrix created by <a class="autorefs autorefs-internal" href="#chemsynthcalc.reaction_matrix.ChemicalReactionMatrix">ChemicalReactionMatrix</a></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>balancer</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Balancer (chemsynthcalc.balancer.Balancer)" href="#chemsynthcalc.balancer.Balancer">Balancer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <a class="autorefs autorefs-internal" href="#chemsynthcalc.balancer.Balancer">Balancer</a> object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>decomposed_reaction</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ReactionDecomposer (chemsynthcalc.reaction_decomposer.ReactionDecomposer)" href="#chemsynthcalc.reaction_decomposer.ReactionDecomposer">ReactionDecomposer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <a class="autorefs autorefs-internal" href="#chemsynthcalc.reaction_decomposer.ReactionDecomposer">ReactionDecomposer</a> object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.coefs.Coefficients.initial_coefficients">initial_coefficients</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of initial coefficients from decomposed reaction</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/coefs.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Coefficients</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to calculate and validate reaction coefficients depending on the calculation &quot;mode&quot;.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        mode (str): Calculation mode (&quot;force&quot;, &quot;check&quot;, &quot;balance&quot;)</span>
<span class="sd">        parsed_formulas (list[dict[str, float]]): List of formulas parsed by [ChemicalFormulaParser][chemsynthcalc.formula_parser.ChemicalFormulaParser]</span>
<span class="sd">        matrix (npt.NDArray[np.float64]): Reaction matrix created by [ChemicalReactionMatrix][chemsynthcalc.reaction_matrix.ChemicalReactionMatrix]</span>
<span class="sd">        balancer (Balancer): A [Balancer][chemsynthcalc.balancer.Balancer] object</span>
<span class="sd">        decomposed_reaction (ReactionDecomposer): A [ReactionDecomposer][chemsynthcalc.reaction_decomposer.ReactionDecomposer] object</span>

<span class="sd">    Attributes:</span>
<span class="sd">        initial_coefficients (list[float]): List of initial coefficients from decomposed reaction</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">parsed_formulas</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
        <span class="n">matrix</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">balancer</span><span class="p">:</span> <span class="n">Balancer</span><span class="p">,</span>
        <span class="n">decomposed_reaction</span><span class="p">:</span> <span class="n">ReactionDecomposer</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balancer</span> <span class="o">=</span> <span class="n">balancer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_coefficients</span> <span class="o">=</span> <span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">initial_coefficients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span> <span class="o">=</span> <span class="n">decomposed_reaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parsed_formulas</span> <span class="o">=</span> <span class="n">parsed_formulas</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Match a mode string and get coefficients depending on the mode</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple of (coefficients, algorithm)</span>

<span class="sd">        Raise:</span>
<span class="sd">            [ReactionNotBalanced][chemsynthcalc.chem_errors.ReactionNotBalanced] if reaction is not balanced in the &quot;check&quot; mode &lt;br /&gt;</span>
<span class="sd">            [NoSuchMode][chemsynthcalc.chem_errors.NoSuchMode] if there is no mode with that name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>

            <span class="k">case</span> <span class="s2">&quot;force&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="n">to_integer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">initial_coefficients</span><span class="p">),</span>
                    <span class="s2">&quot;user&quot;</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;check&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Balancer</span><span class="o">.</span><span class="n">is_reaction_balanced</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">balancer</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">balancer</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">initial_coefficients</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span>
                        <span class="n">to_integer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">initial_coefficients</span><span class="p">),</span>
                        <span class="s2">&quot;user&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ReactionNotBalanced</span><span class="p">(</span><span class="s2">&quot;This reaction is not balanced!&quot;</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;balance&quot;</span><span class="p">:</span>
                <span class="n">coefs</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">balancer</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">coefs</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">)</span>

            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">NoSuchMode</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No mode </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">coefficients_validation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate a list of coefs.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            coefficients (list[float | int] | list[int]): List of coefs</span>

<span class="sd">        Raise:</span>
<span class="sd">            [BadCoeffiecients][chemsynthcalc.chem_errors.BadCoeffiecients] if any coef &lt;= 0 or</span>
<span class="sd">            lenght of list is not equal to the number of compounds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coefficients</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">BadCoeffiecients</span><span class="p">(</span><span class="s2">&quot;0 or -x in coefficients&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">BadCoeffiecients</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of coefficients should be equal to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_element_count_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate a [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)</span>
<span class="sd">        of two sets - left and right parts of the reaction. If this set is not empty, than</span>
<span class="sd">        some atoms are only in one part of the reaction (which is impossible).</span>

<span class="sd">        Raise:</span>
<span class="sd">            [ReactantProductDifference][chemsynthcalc.chem_errors.ReactantProductDifference] if diff set is not empty.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;force&quot;</span><span class="p">:</span>
            <span class="n">reactants</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
                <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsed_formulas</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="n">products</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
                <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsed_formulas</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">)</span> <span class="p">:]</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">reactants</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">^</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">products</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
            <span class="k">if</span> <span class="n">diff</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ReactantProductDifference</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Cannot balance this reaction, because element(s) </span><span class="si">{</span><span class="n">diff</span><span class="si">}</span><span class="s2"> are only in one part of the reaction&quot;</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate atom&#39;s diff and coefs list and finally get a proper coefficients list.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple of (coefficients, algorithm)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_element_count_validation</span><span class="p">()</span>
        <span class="n">coefs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_coefficients</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coefficients_validation</span><span class="p">(</span><span class="n">coefs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">coefs</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.coefs.Coefficients._calculate_coefficients" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_coefficients</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Match a mode string and get coefficients depending on the mode</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>] | <span title="list">list</span>[<span title="int">int</span>], <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (coefficients, algorithm)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="raise" open>
  <summary>Raise</summary>
  <p><a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.ReactionNotBalanced">ReactionNotBalanced</a> if reaction is not balanced in the "check" mode <br />
<a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.NoSuchMode">NoSuchMode</a> if there is no mode with that name</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/coefs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Match a mode string and get coefficients depending on the mode</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (coefficients, algorithm)</span>

<span class="sd">    Raise:</span>
<span class="sd">        [ReactionNotBalanced][chemsynthcalc.chem_errors.ReactionNotBalanced] if reaction is not balanced in the &quot;check&quot; mode &lt;br /&gt;</span>
<span class="sd">        [NoSuchMode][chemsynthcalc.chem_errors.NoSuchMode] if there is no mode with that name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>

        <span class="k">case</span> <span class="s2">&quot;force&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">to_integer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">initial_coefficients</span><span class="p">),</span>
                <span class="s2">&quot;user&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;check&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Balancer</span><span class="o">.</span><span class="n">is_reaction_balanced</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">balancer</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">balancer</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">initial_coefficients</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="n">to_integer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">initial_coefficients</span><span class="p">),</span>
                    <span class="s2">&quot;user&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ReactionNotBalanced</span><span class="p">(</span><span class="s2">&quot;This reaction is not balanced!&quot;</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;balance&quot;</span><span class="p">:</span>
            <span class="n">coefs</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">balancer</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">coefs</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">)</span>

        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoSuchMode</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No mode </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.coefs.Coefficients.coefficients_validation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">coefficients_validation</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Validate a list of coefs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>coefficients</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>] | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of coefs</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="raise" open>
  <summary>Raise</summary>
  <p><a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.BadCoeffiecients">BadCoeffiecients</a> if any coef &lt;= 0 or
lenght of list is not equal to the number of compounds.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/coefs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">coefficients_validation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate a list of coefs.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        coefficients (list[float | int] | list[int]): List of coefs</span>

<span class="sd">    Raise:</span>
<span class="sd">        [BadCoeffiecients][chemsynthcalc.chem_errors.BadCoeffiecients] if any coef &lt;= 0 or</span>
<span class="sd">        lenght of list is not equal to the number of compounds.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coefficients</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">BadCoeffiecients</span><span class="p">(</span><span class="s2">&quot;0 or -x in coefficients&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">BadCoeffiecients</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Number of coefficients should be equal to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.coefs.Coefficients._element_count_validation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_element_count_validation</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate a <a href="https://en.wikipedia.org/wiki/Symmetric_difference">symmetric difference</a>
of two sets - left and right parts of the reaction. If this set is not empty, than
some atoms are only in one part of the reaction (which is impossible).</p>


<details class="raise" open>
  <summary>Raise</summary>
  <p><a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.ReactantProductDifference">ReactantProductDifference</a> if diff set is not empty.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/coefs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_element_count_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate a [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)</span>
<span class="sd">    of two sets - left and right parts of the reaction. If this set is not empty, than</span>
<span class="sd">    some atoms are only in one part of the reaction (which is impossible).</span>

<span class="sd">    Raise:</span>
<span class="sd">        [ReactantProductDifference][chemsynthcalc.chem_errors.ReactantProductDifference] if diff set is not empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;force&quot;</span><span class="p">:</span>
        <span class="n">reactants</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsed_formulas</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">products</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsed_formulas</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decomposed_reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">)</span> <span class="p">:]</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">reactants</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">^</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">products</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">diff</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ReactantProductDifference</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cannot balance this reaction, because element(s) </span><span class="si">{</span><span class="n">diff</span><span class="si">}</span><span class="s2"> are only in one part of the reaction&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.coefs.Coefficients.get_coefficients" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_coefficients</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Validate atom's diff and coefs list and finally get a proper coefficients list.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>] | <span title="list">list</span>[<span title="int">int</span>], <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (coefficients, algorithm)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/coefs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate atom&#39;s diff and coefs list and finally get a proper coefficients list.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (coefficients, algorithm)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_element_count_validation</span><span class="p">()</span>
    <span class="n">coefs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_coefficients</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">coefficients_validation</span><span class="p">(</span><span class="n">coefs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">coefs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.formula" class="doc doc-heading">
            <code>formula</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.formula.Formula" class="doc doc-heading">
            <code>Formula</code>


</h3>


    <div class="doc doc-contents ">


        <p>A base class for
<a class="autorefs autorefs-internal" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser">ChemicalFormulaParser</a> and
<a class="autorefs autorefs-internal" href="#chemsynthcalc.formula_validator.FormulaValidator">FormulaValidator</a>
containing regexes and symbols.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>formula</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formula string</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.formula.Formula.atom_regex">atom_regex</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Regular expression for finding atoms in formula</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.formula.Formula.coefficient_regex">coefficient_regex</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Regular expression for atoms amounts in formula</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.formula.Formula.atom_and_coefficient_regex">atom_and_coefficient_regex</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>atom_regex+coefficient_regex</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.formula.Formula.opener_brackets">opener_brackets</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Opener brackets variations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.formula.Formula.closer_brackets">closer_brackets</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Closer brackets variations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.formula.Formula.adduct_symbols">adduct_symbols</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Symbols for adduct notation (water of crystallization most often)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/formula.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Formula</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A base class for</span>
<span class="sd">    [ChemicalFormulaParser][chemsynthcalc.formula_parser.ChemicalFormulaParser] and</span>
<span class="sd">    [FormulaValidator][chemsynthcalc.formula_validator.FormulaValidator]</span>
<span class="sd">    containing regexes and symbols.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        formula (str): Formula string</span>

<span class="sd">    Attributes:</span>
<span class="sd">        atom_regex (str): Regular expression for finding atoms in formula</span>
<span class="sd">        coefficient_regex (str): Regular expression for atoms amounts in formula</span>
<span class="sd">        atom_and_coefficient_regex (str): atom_regex+coefficient_regex</span>
<span class="sd">        opener_brackets (str): Opener brackets variations</span>
<span class="sd">        closer_brackets (str): Closer brackets variations</span>
<span class="sd">        adduct_symbols (str): Symbols for adduct notation (water of crystallization most often)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formula</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_regex</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;([A-Z][a-z]*)&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coefficient_regex</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;((\d+(\.\d+)?)*)&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_symbols</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[^A-Za-z0-9.({[)}\]*·•]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_and_coefficient_regex</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_regex</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficient_regex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opener_brackets</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;({[&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">closer_brackets</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;)}]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adduct_symbols</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;*·•&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">formula</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.formula_parser" class="doc doc-heading">
            <code>formula_parser</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.formula_parser.ChemicalFormulaParser" class="doc doc-heading">
            <code>ChemicalFormulaParser</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Formula (chemsynthcalc.formula.Formula)" href="#chemsynthcalc.formula.Formula">Formula</a></code></p>


        <p>Parser of chemical formulas.</p>
<p>Methods of this class take string of compound's chemical formula
and turn it into a dict of atoms as keys and their coefficients as values.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/formula_parser.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChemicalFormulaParser</span><span class="p">(</span><span class="n">Formula</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parser of chemical formulas.</span>

<span class="sd">    Methods of this class take string of compound&#39;s chemical formula</span>
<span class="sd">    and turn it into a dict of atoms as keys and their coefficients as values.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_dictify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tuples</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transform list of tuples to a dict of atoms.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            tuples (list[tuple[str, ...]]): List of tuples of atoms</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary of atoms and they quantities</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">atom</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tuples</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_fuse</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">mol1</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">mol2</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fuse together 2 dicts representing molecules.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            mol1 (dict[str, float]): Dict of atoms 1</span>
<span class="sd">            mol2 (dict[str, float]): Dict of atoms 2</span>
<span class="sd">            weight (float): Weight</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new fused dict</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fused_set</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">mol1</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">mol2</span><span class="p">)</span>
        <span class="n">fused_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">atom</span><span class="p">:</span> <span class="p">(</span><span class="n">mol1</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">mol2</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">*</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">fused_set</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">fused_dict</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formula</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse the formula string</span>

<span class="sd">        Recurse on opening brackets to parse the subpart and</span>
<span class="sd">        return on closing ones because it is the end of said subpart.</span>
<span class="sd">        Formula is the argument of this method due to the complications</span>
<span class="sd">        of self. Constructions in recursive functions.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            formula (str): Formula string</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple of the molecule dict and length of parsed part</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">token_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mol</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">formula</span><span class="p">):</span>
            <span class="n">token</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">formula</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">token</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adduct_symbols</span><span class="p">:</span>
                <span class="n">coefficient_match</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">Match</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">coefficient_regex</span><span class="p">,</span> <span class="n">formula</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">coefficient_match</span> <span class="ow">and</span> <span class="n">coefficient_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">coefficient_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coefficient_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="n">recursive_dive</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">formula</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">)</span><span class="si">{</span><span class="n">weight</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="n">submol</span> <span class="o">=</span> <span class="n">recursive_dive</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">lenght</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">recursive_dive</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">mol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fuse</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">submol</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="n">lenght</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="k">elif</span> <span class="n">token</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">closer_brackets</span><span class="p">:</span>
                <span class="n">coefficient_match</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">Match</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">coefficient_regex</span><span class="p">,</span> <span class="n">formula</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">coefficient_match</span> <span class="ow">and</span> <span class="n">coefficient_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">coefficient_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coefficient_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="n">submol</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dictify</span><span class="p">(</span>
                    <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_and_coefficient_regex</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">token_list</span><span class="p">))</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fuse</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">submol</span><span class="p">,</span> <span class="n">weight</span><span class="p">),</span> <span class="n">i</span>

            <span class="k">elif</span> <span class="n">token</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">opener_brackets</span><span class="p">:</span>
                <span class="n">recursive_dive</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span>
                    <span class="n">formula</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="p">)</span>
                <span class="n">submol</span> <span class="o">=</span> <span class="n">recursive_dive</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">lenght</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">recursive_dive</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">mol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fuse</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">submol</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="n">lenght</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">token_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">extract_from_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom_and_coefficient_regex</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">token_list</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">fused_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fuse</span><span class="p">(</span>
            <span class="n">mol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dictify</span><span class="p">(</span><span class="n">extract_from_tokens</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">fused_dict</span><span class="p">,</span> <span class="n">i</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_order_output_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arranges the unparsed formula in the order in which the chemical</span>
<span class="sd">        elements appear in it.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            parsed (dict[str, float]): A formula parsed by [_parse][chemsynthcalc.formula_parser.ChemicalFormulaParser._parse]</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ordered dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">atoms_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_regex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)</span>
        <span class="n">weights</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms_list</span><span class="p">:</span>
            <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parsed</span><span class="p">[</span><span class="n">atom</span><span class="p">])</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">atoms_list</span><span class="p">,</span> <span class="n">weights</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parsing and ordering of formula</span>

<span class="sd">        Returns:</span>
<span class="sd">            Parsed formula</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_output_dict</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.formula_parser.ChemicalFormulaParser._dictify" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_dictify</span><span class="p">(</span><span class="n">tuples</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Transform list of tuples to a dict of atoms.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tuples</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="str">str</span>, ...]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of tuples of atoms</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of atoms and they quantities</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/formula_parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_dictify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tuples</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transform list of tuples to a dict of atoms.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        tuples (list[tuple[str, ...]]): List of tuples of atoms</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary of atoms and they quantities</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">atom</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tuples</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.formula_parser.ChemicalFormulaParser._fuse" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_fuse</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Fuse together 2 dicts representing molecules.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mol1</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of atoms 1</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mol2</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of atoms 2</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weight</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weight</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new fused dict</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/formula_parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_fuse</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">mol1</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">mol2</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fuse together 2 dicts representing molecules.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        mol1 (dict[str, float]): Dict of atoms 1</span>
<span class="sd">        mol2 (dict[str, float]): Dict of atoms 2</span>
<span class="sd">        weight (float): Weight</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new fused dict</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fused_set</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">mol1</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">mol2</span><span class="p">)</span>
    <span class="n">fused_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">atom</span><span class="p">:</span> <span class="p">(</span><span class="n">mol1</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">mol2</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">*</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">fused_set</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">fused_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.formula_parser.ChemicalFormulaParser._parse" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_parse</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Parse the formula string</p>
<p>Recurse on opening brackets to parse the subpart and
return on closing ones because it is the end of said subpart.
Formula is the argument of this method due to the complications
of self. Constructions in recursive functions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>formula</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formula string</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>], <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of the molecule dict and length of parsed part</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/formula_parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formula</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse the formula string</span>

<span class="sd">    Recurse on opening brackets to parse the subpart and</span>
<span class="sd">    return on closing ones because it is the end of said subpart.</span>
<span class="sd">    Formula is the argument of this method due to the complications</span>
<span class="sd">    of self. Constructions in recursive functions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        formula (str): Formula string</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple of the molecule dict and length of parsed part</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">token_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">mol</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">formula</span><span class="p">):</span>
        <span class="n">token</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">formula</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">token</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adduct_symbols</span><span class="p">:</span>
            <span class="n">coefficient_match</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">Match</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coefficient_regex</span><span class="p">,</span> <span class="n">formula</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">coefficient_match</span> <span class="ow">and</span> <span class="n">coefficient_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">coefficient_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coefficient_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">recursive_dive</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">formula</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">)</span><span class="si">{</span><span class="n">weight</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">submol</span> <span class="o">=</span> <span class="n">recursive_dive</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">lenght</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">recursive_dive</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fuse</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">submol</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="n">lenght</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">elif</span> <span class="n">token</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">closer_brackets</span><span class="p">:</span>
            <span class="n">coefficient_match</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">Match</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coefficient_regex</span><span class="p">,</span> <span class="n">formula</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">coefficient_match</span> <span class="ow">and</span> <span class="n">coefficient_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">coefficient_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coefficient_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">submol</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dictify</span><span class="p">(</span>
                <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_and_coefficient_regex</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">token_list</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fuse</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">submol</span><span class="p">,</span> <span class="n">weight</span><span class="p">),</span> <span class="n">i</span>

        <span class="k">elif</span> <span class="n">token</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">opener_brackets</span><span class="p">:</span>
            <span class="n">recursive_dive</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span>
                <span class="n">formula</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="p">)</span>
            <span class="n">submol</span> <span class="o">=</span> <span class="n">recursive_dive</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">lenght</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">recursive_dive</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fuse</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">submol</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="n">lenght</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">token_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">extract_from_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_and_coefficient_regex</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">token_list</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">fused_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fuse</span><span class="p">(</span>
        <span class="n">mol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dictify</span><span class="p">(</span><span class="n">extract_from_tokens</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">fused_dict</span><span class="p">,</span> <span class="n">i</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.formula_parser.ChemicalFormulaParser._order_output_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_order_output_dict</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Arranges the unparsed formula in the order in which the chemical
elements appear in it.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parsed</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A formula parsed by <a class="autorefs autorefs-internal" title="_parse(formula)" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser._parse">_parse</a></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An ordered dictionary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/formula_parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_order_output_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Arranges the unparsed formula in the order in which the chemical</span>
<span class="sd">    elements appear in it.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        parsed (dict[str, float]): A formula parsed by [_parse][chemsynthcalc.formula_parser.ChemicalFormulaParser._parse]</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ordered dictionary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">atoms_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_regex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)</span>
    <span class="n">weights</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms_list</span><span class="p">:</span>
        <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parsed</span><span class="p">[</span><span class="n">atom</span><span class="p">])</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">atoms_list</span><span class="p">,</span> <span class="n">weights</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.formula_parser.ChemicalFormulaParser.parse_formula" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_formula</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Parsing and ordering of formula</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parsed formula</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/formula_parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parsing and ordering of formula</span>

<span class="sd">    Returns:</span>
<span class="sd">        Parsed formula</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parsed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_output_dict</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.formula_validator" class="doc doc-heading">
            <code>formula_validator</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.formula_validator.FormulaValidator" class="doc doc-heading">
            <code>FormulaValidator</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Formula (chemsynthcalc.formula.Formula)" href="#chemsynthcalc.formula.Formula">Formula</a></code></p>


        <p>Methods of this class validate the initial input formula.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/formula_validator.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FormulaValidator</span><span class="p">(</span><span class="n">Formula</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Methods of this class validate the initial input formula.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_empty_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if formula is an empty string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_invalid_charachers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if formula contains invalid characters.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of invalid characters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allowed_symbols</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_invalid_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the formula contains atoms that</span>
<span class="sd">        are not in the periodic system.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of invalid atoms</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">atoms_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_regex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)</span>
        <span class="n">invalid</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">new_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span>
        <span class="c1"># a trick to get Cl first of C in cases like CCl4</span>
        <span class="n">atoms_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">atoms_list</span><span class="p">)),</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">atom</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">PeriodicTable</span><span class="p">()</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                <span class="n">invalid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
            <span class="n">new_string</span> <span class="o">=</span> <span class="n">new_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">found_leftovers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[a-z]&quot;</span><span class="p">,</span> <span class="n">new_string</span><span class="p">)</span>
        <span class="n">invalid</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">found_leftovers</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">invalid</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_bracket_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether all of the brackets come in pairs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span><span class="p">:</span> <span class="n">Counter</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opener_brackets</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">opener_brackets</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">!=</span> <span class="n">c</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">closer_brackets</span><span class="p">[</span><span class="n">i</span><span class="p">]]:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_num_of_adducts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Counts a number of adduct symbols</span>
<span class="sd">        (listed in [Formula base class][chemsynthcalc.formula.Formula]).</span>

<span class="sd">        Returns:</span>
<span class="sd">            A number of adduct symbols</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span><span class="p">:</span> <span class="n">Counter</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)</span>
        <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">adduct</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adduct_symbols</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="n">c</span><span class="p">[</span><span class="n">adduct</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">i</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validation of the formula string.</span>
<span class="sd">        Calls the private methods of this class in order.</span>

<span class="sd">        Raise:</span>
<span class="sd">            [EmptyFormula][chemsynthcalc.chem_errors.EmptyFormula] if the formula is an empty string. &lt;br /&gt;</span>
<span class="sd">            [InvalidCharacter][chemsynthcalc.chem_errors.InvalidCharacter] if there is an invalid character(s) in the string. &lt;br /&gt;</span>
<span class="sd">            [NoSuchAtom][chemsynthcalc.chem_errors.NoSuchAtom] if there is an invalid atom(s) in the string. &lt;br /&gt;</span>
<span class="sd">            [BracketsNotPaired][chemsynthcalc.chem_errors.BracketsNotPaired] if the brackets are not in pairs. &lt;br /&gt;</span>
<span class="sd">            [MoreThanOneAdduct][chemsynthcalc.chem_errors.MoreThanOneAdduct] if there are more than 1 adduct symbols in the string. &lt;br /&gt;</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if all the checks are OK</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_empty_formula</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">EmptyFormula</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_charachers</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">InvalidCharacter</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid character(s) </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_invalid_charachers</span><span class="p">()</span><span class="si">}</span><span class="s2"> in the formula </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_atoms</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">NoSuchAtom</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The formula </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="si">}</span><span class="s2"> contains atom </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_invalid_atoms</span><span class="p">()</span><span class="si">}</span><span class="s2"> which is not in the periodic table&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bracket_balance</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">BracketsNotPaired</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The brackets </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">opener_brackets</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">closer_brackets</span><span class="si">}</span><span class="s2"> are not balanced the formula </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="si">}</span><span class="s2">!&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_of_adducts</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MoreThanOneAdduct</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;More than one adduct </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">adduct_symbols</span><span class="si">}</span><span class="s2"> in the formula </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.formula_validator.FormulaValidator._check_empty_formula" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_check_empty_formula</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks if formula is an empty string.</p>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/formula_validator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_check_empty_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if formula is an empty string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.formula_validator.FormulaValidator._invalid_charachers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_invalid_charachers</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks if formula contains invalid characters.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of invalid characters</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/formula_validator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_invalid_charachers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if formula contains invalid characters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of invalid characters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allowed_symbols</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.formula_validator.FormulaValidator._invalid_atoms" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_invalid_atoms</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks whether the formula contains atoms that
are not in the periodic system.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of invalid atoms</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/formula_validator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_invalid_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the formula contains atoms that</span>
<span class="sd">    are not in the periodic system.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of invalid atoms</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">atoms_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_regex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)</span>
    <span class="n">invalid</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">new_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span>
    <span class="c1"># a trick to get Cl first of C in cases like CCl4</span>
    <span class="n">atoms_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">atoms_list</span><span class="p">)),</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">atom</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">PeriodicTable</span><span class="p">()</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="n">invalid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
        <span class="n">new_string</span> <span class="o">=</span> <span class="n">new_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">found_leftovers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[a-z]&quot;</span><span class="p">,</span> <span class="n">new_string</span><span class="p">)</span>
    <span class="n">invalid</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">found_leftovers</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">invalid</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.formula_validator.FormulaValidator._bracket_balance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_bracket_balance</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks whether all of the brackets come in pairs.</p>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/formula_validator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_bracket_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether all of the brackets come in pairs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span><span class="p">:</span> <span class="n">Counter</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opener_brackets</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">opener_brackets</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">!=</span> <span class="n">c</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">closer_brackets</span><span class="p">[</span><span class="n">i</span><span class="p">]]:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.formula_validator.FormulaValidator._num_of_adducts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_num_of_adducts</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Counts a number of adduct symbols
(listed in <a class="autorefs autorefs-internal" title="Formula" href="#chemsynthcalc.formula.Formula">Formula base class</a>).</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A number of adduct symbols</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/formula_validator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_num_of_adducts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Counts a number of adduct symbols</span>
<span class="sd">    (listed in [Formula base class][chemsynthcalc.formula.Formula]).</span>

<span class="sd">    Returns:</span>
<span class="sd">        A number of adduct symbols</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span><span class="p">:</span> <span class="n">Counter</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)</span>
    <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">adduct</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adduct_symbols</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="n">c</span><span class="p">[</span><span class="n">adduct</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">i</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.formula_validator.FormulaValidator.validate_formula" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_formula</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Validation of the formula string.
Calls the private methods of this class in order.</p>


<details class="raise" open>
  <summary>Raise</summary>
  <p><a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.EmptyFormula">EmptyFormula</a> if the formula is an empty string. <br />
<a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.InvalidCharacter">InvalidCharacter</a> if there is an invalid character(s) in the string. <br />
<a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.NoSuchAtom">NoSuchAtom</a> if there is an invalid atom(s) in the string. <br />
<a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.BracketsNotPaired">BracketsNotPaired</a> if the brackets are not in pairs. <br />
<a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.MoreThanOneAdduct">MoreThanOneAdduct</a> if there are more than 1 adduct symbols in the string. <br /></p>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if all the checks are OK</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/formula_validator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validation of the formula string.</span>
<span class="sd">    Calls the private methods of this class in order.</span>

<span class="sd">    Raise:</span>
<span class="sd">        [EmptyFormula][chemsynthcalc.chem_errors.EmptyFormula] if the formula is an empty string. &lt;br /&gt;</span>
<span class="sd">        [InvalidCharacter][chemsynthcalc.chem_errors.InvalidCharacter] if there is an invalid character(s) in the string. &lt;br /&gt;</span>
<span class="sd">        [NoSuchAtom][chemsynthcalc.chem_errors.NoSuchAtom] if there is an invalid atom(s) in the string. &lt;br /&gt;</span>
<span class="sd">        [BracketsNotPaired][chemsynthcalc.chem_errors.BracketsNotPaired] if the brackets are not in pairs. &lt;br /&gt;</span>
<span class="sd">        [MoreThanOneAdduct][chemsynthcalc.chem_errors.MoreThanOneAdduct] if there are more than 1 adduct symbols in the string. &lt;br /&gt;</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if all the checks are OK</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_empty_formula</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">EmptyFormula</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_charachers</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">InvalidCharacter</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid character(s) </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_invalid_charachers</span><span class="p">()</span><span class="si">}</span><span class="s2"> in the formula </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_atoms</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">NoSuchAtom</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The formula </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="si">}</span><span class="s2"> contains atom </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_invalid_atoms</span><span class="p">()</span><span class="si">}</span><span class="s2"> which is not in the periodic table&quot;</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bracket_balance</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">BracketsNotPaired</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The brackets </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">opener_brackets</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">closer_brackets</span><span class="si">}</span><span class="s2"> are not balanced the formula </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="si">}</span><span class="s2">!&quot;</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_of_adducts</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">MoreThanOneAdduct</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;More than one adduct </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">adduct_symbols</span><span class="si">}</span><span class="s2"> in the formula </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.molar_mass" class="doc doc-heading">
            <code>molar_mass</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.molar_mass.Oxide" class="doc doc-heading">
            <code>Oxide</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>


        <p>A named tuple to represent oxide properties: a first atom
(usually metal), full oxide compound string and mass percent
of the first atom in the initial formula.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/molar_mass.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Oxide</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A named tuple to represent oxide properties: a first atom</span>
<span class="sd">    (usually metal), full oxide compound string and mass percent</span>
<span class="sd">    of the first atom in the initial formula.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">atom</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">mass_percent</span><span class="p">:</span> <span class="nb">float</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.molar_mass.MolarMassCalculation" class="doc doc-heading">
            <code>MolarMassCalculation</code>


</h3>


    <div class="doc doc-contents ">


        <p>Class for the calculation of molar masses and percentages of a compound.</p>
<p>Compound should be parsed by
<a class="autorefs autorefs-internal" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser">ChemicalFormulaParser</a> first.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parsed_formula</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formula parsed by <a class="autorefs autorefs-internal" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser">ChemicalFormulaParser</a></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.molar_mass.MolarMassCalculation.p_table">p_table</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="Atom">Atom</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Periodic table of elements</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/molar_mass.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MolarMassCalculation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for the calculation of molar masses and percentages of a compound.</span>

<span class="sd">    Compound should be parsed by</span>
<span class="sd">    [ChemicalFormulaParser][chemsynthcalc.formula_parser.ChemicalFormulaParser] first.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        parsed_formula (dict): Formula parsed by [ChemicalFormulaParser][chemsynthcalc.formula_parser.ChemicalFormulaParser]</span>

<span class="sd">    Attributes:</span>
<span class="sd">        p_table (dict[str, Atom]): Periodic table of elements</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_formula</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsed_formula</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_table</span> <span class="o">=</span> <span class="n">PeriodicTable</span><span class="p">()</span><span class="o">.</span><span class="n">p_table</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_atomic_masses</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of the molar masses of</span>
<span class="sd">        all atoms in a parsed formula.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of atomic masses multiplied by the number of corresponding atoms</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">masses</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">atom</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">atom_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_table</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span><span class="o">.</span><span class="n">atomic_weight</span>
            <span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_mass</span> <span class="o">*</span> <span class="n">weight</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">masses</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_molar_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of the molar mass of compound from</span>
<span class="sd">        the atomic masses of atoms in a parsed formula.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Molar mass (in g/mol)</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; MolarMassCalculation({&#39;H&#39;:2, &#39;O&#39;:1}).calculate_molar_mass()</span>
<span class="sd">            18.015</span>
<span class="sd">            &gt;&gt;&gt; MolarMassCalculation({&#39;C&#39;:2, &#39;H&#39;:6, &#39;O&#39;:1}).calculate_molar_mass()</span>
<span class="sd">            46.069</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_calculate_atomic_masses</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_mass_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of mass percents of atoms in parsed formula.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Mass percentages of atoms in the formula</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; MolarMassCalculation({&#39;H&#39;:2, &#39;O&#39;:1}).calculate_mass_percent()</span>
<span class="sd">            {&#39;H&#39;: 11.19067443796836, &#39;O&#39;: 88.80932556203163}</span>
<span class="sd">            &gt;&gt;&gt; MolarMassCalculation({&#39;C&#39;:2, &#39;H&#39;:6, &#39;O&#39;:1}).calculate_mass_percent()</span>
<span class="sd">            {&#39;C&#39;: 52.14352384466777, &#39;H&#39;: 13.12813388612733, &#39;O&#39;: 34.72834226920489}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">atomic_masses</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_atomic_masses</span><span class="p">()</span>
        <span class="n">molar_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_molar_mass</span><span class="p">()</span>
        <span class="n">percents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atomic</span> <span class="o">/</span> <span class="n">molar_mass</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">atomic</span> <span class="ow">in</span> <span class="n">atomic_masses</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">percents</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_atomic_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of atomic percents of atoms in the parsed formula.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Atomic percentages of atoms in the formula</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; MolarMassCalculation({&#39;H&#39;:2, &#39;O&#39;:1}).calculate_atomic_percent()</span>
<span class="sd">            {&#39;H&#39;: 66.66666666666666, &#39;O&#39;: 33.33333333333333</span>
<span class="sd">            &gt;&gt;&gt; MolarMassCalculation({&#39;C&#39;:2, &#39;H&#39;:6, &#39;O&#39;:1}).calculate_atomic_percent()</span>
<span class="sd">            {&#39;C&#39;: 22.22222222222222, &#39;H&#39;: 66.66666666666666, &#39;O&#39;: 11.11111111111111}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">atomic</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">atomic</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_custom_oxides_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Oxide</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if passed non-default oxide formulas can be applied to any</span>
<span class="sd">        atom in parsed formula. If so, replaces it with said non-default oxide.</span>
<span class="sd">        If not, the default oxide is chosen.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            *args (tuple[str, ...]): An arbitrary number of non-default oxide formulas</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of Oxide objects</span>

<span class="sd">        Raise:</span>
<span class="sd">            ValueError if compound is not binary or second element is not oxygen</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">first_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c_oxide</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">parsed_oxide</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ChemicalFormulaParser</span><span class="p">(</span><span class="n">c_oxide</span><span class="p">)</span><span class="o">.</span><span class="n">parse_formula</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed_oxide</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only binary compounds can be considered as input&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">parsed_oxide</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;O&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only oxides can be considered as input&quot;</span><span class="p">)</span>

            <span class="n">first_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parsed_oxide</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">custom_oxides</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">first_atoms</span><span class="p">,</span> <span class="n">args</span><span class="p">))</span>
        <span class="n">mass_percents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculate_mass_percent</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">oxides</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Oxide</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">atom</span> <span class="o">!=</span> <span class="s2">&quot;O&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">custom_oxides</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">custom_oxides</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_table</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span><span class="o">.</span><span class="n">default_oxide</span>
                <span class="n">oxides</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Oxide</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">mass_percents</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">oxides</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_oxide_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of oxide percents in parsed formula.</span>

<span class="sd">        Calculation of oxide percents in parsed formula from the types of oxide</span>
<span class="sd">        declared in the periodic table file. This type of data</span>
<span class="sd">        is mostly used in XRF spectrometry and mineralogy. The oxide</span>
<span class="sd">        percents are calculated by finding the [convertion factor between element</span>
<span class="sd">        and its respective oxide](https://www.geol.umd.edu/~piccoli/probe/molweight.html)</span>
<span class="sd">        and normalizing the total sum to 100%. One can change the oxide type</span>
<span class="sd">        for certain elements in the [periodic_table.py][chemsynthcalc.periodic_table] file. Theoretically, this function</span>
<span class="sd">        should work for other types of binary compound (sulfides, fluorides etc.)</span>
<span class="sd">        or even salts, however, modification of this function is required</span>
<span class="sd">        (for instance, in case of binary compound, removing X atom</span>
<span class="sd">        from the list of future compounds should have X as an argument of this function).</span>

<span class="sd">        Parameters:</span>
<span class="sd">            *args (tuple[str, ...]): An arbitrary number of non-default oxide formulas</span>

<span class="sd">        Returns:</span>
<span class="sd">            Percentages of oxides in the formula</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; MolarMassCalculation({&#39;C&#39;:2, &#39;H&#39;:6, &#39;O&#39;:1}).calculate_oxide_percent()</span>
<span class="sd">            {&#39;CO2&#39;: 61.9570190690046, &#39;H2O&#39;: 38.04298093099541}</span>
<span class="sd">            &gt;&gt;&gt; MolarMassCalculation({&#39;Ba&#39;:1, &#39;Ti&#39;:1, &#39;O&#39;:3}).calculate_oxide_percent()</span>
<span class="sd">            {&#39;BaO&#39;: 65.7516917244869, &#39;TiO2&#39;: 34.24830827551309}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oxides</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Oxide</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_custom_oxides_input</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

        <span class="n">oxide_percents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">oxide</span> <span class="ow">in</span> <span class="n">oxides</span><span class="p">:</span>
            <span class="n">parsed_oxide</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChemicalFormulaParser</span><span class="p">(</span>
                <span class="n">oxide</span><span class="o">.</span><span class="n">label</span>
            <span class="p">)</span><span class="o">.</span><span class="n">parse_formula</span><span class="p">()</span>
            <span class="n">oxide_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">MolarMassCalculation</span><span class="p">(</span>
                <span class="n">parsed_oxide</span>
            <span class="p">)</span><span class="o">.</span><span class="n">calculate_molar_mass</span><span class="p">()</span>
            <span class="n">atomic_oxide_coef</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">parsed_oxide</span><span class="p">[</span><span class="n">oxide</span><span class="o">.</span><span class="n">atom</span><span class="p">]</span>
            <span class="n">atomic_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_table</span><span class="p">[</span><span class="n">oxide</span><span class="o">.</span><span class="n">atom</span><span class="p">]</span><span class="o">.</span><span class="n">atomic_weight</span>
            <span class="n">conversion_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">oxide_mass</span> <span class="o">/</span> <span class="n">atomic_mass</span> <span class="o">/</span> <span class="n">atomic_oxide_coef</span>
            <span class="n">oxide_percents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oxide</span><span class="o">.</span><span class="n">mass_percent</span> <span class="o">*</span> <span class="n">conversion_factor</span><span class="p">)</span>

        <span class="n">normalized_oxide_percents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">x</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">oxide_percents</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">oxide_percents</span>
        <span class="p">]</span>
        <span class="n">oxide_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">oxide</span><span class="o">.</span><span class="n">label</span> <span class="k">for</span> <span class="n">oxide</span> <span class="ow">in</span> <span class="n">oxides</span><span class="p">]</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">oxide_labels</span><span class="p">,</span> <span class="n">normalized_oxide_percents</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.molar_mass.MolarMassCalculation._calculate_atomic_masses" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_atomic_masses</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculation of the molar masses of
all atoms in a parsed formula.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of atomic masses multiplied by the number of corresponding atoms</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/molar_mass.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_atomic_masses</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the molar masses of</span>
<span class="sd">    all atoms in a parsed formula.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of atomic masses multiplied by the number of corresponding atoms</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">masses</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">atom</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">atom_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_table</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span><span class="o">.</span><span class="n">atomic_weight</span>
        <span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_mass</span> <span class="o">*</span> <span class="n">weight</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">masses</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.molar_mass.MolarMassCalculation.calculate_molar_mass" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_molar_mass</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculation of the molar mass of compound from
the atomic masses of atoms in a parsed formula.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Molar mass (in g/mol)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_molar_mass</span><span class="p">()</span>
<span class="go">18.015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_molar_mass</span><span class="p">()</span>
<span class="go">46.069</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/molar_mass.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_molar_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the molar mass of compound from</span>
<span class="sd">    the atomic masses of atoms in a parsed formula.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Molar mass (in g/mol)</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; MolarMassCalculation({&#39;H&#39;:2, &#39;O&#39;:1}).calculate_molar_mass()</span>
<span class="sd">        18.015</span>
<span class="sd">        &gt;&gt;&gt; MolarMassCalculation({&#39;C&#39;:2, &#39;H&#39;:6, &#39;O&#39;:1}).calculate_molar_mass()</span>
<span class="sd">        46.069</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_calculate_atomic_masses</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.molar_mass.MolarMassCalculation.calculate_mass_percent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_mass_percent</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculation of mass percents of atoms in parsed formula.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mass percentages of atoms in the formula</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_mass_percent</span><span class="p">()</span>
<span class="go">{&#39;H&#39;: 11.19067443796836, &#39;O&#39;: 88.80932556203163}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_mass_percent</span><span class="p">()</span>
<span class="go">{&#39;C&#39;: 52.14352384466777, &#39;H&#39;: 13.12813388612733, &#39;O&#39;: 34.72834226920489}</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/molar_mass.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_mass_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of mass percents of atoms in parsed formula.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Mass percentages of atoms in the formula</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; MolarMassCalculation({&#39;H&#39;:2, &#39;O&#39;:1}).calculate_mass_percent()</span>
<span class="sd">        {&#39;H&#39;: 11.19067443796836, &#39;O&#39;: 88.80932556203163}</span>
<span class="sd">        &gt;&gt;&gt; MolarMassCalculation({&#39;C&#39;:2, &#39;H&#39;:6, &#39;O&#39;:1}).calculate_mass_percent()</span>
<span class="sd">        {&#39;C&#39;: 52.14352384466777, &#39;H&#39;: 13.12813388612733, &#39;O&#39;: 34.72834226920489}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">atomic_masses</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_atomic_masses</span><span class="p">()</span>
    <span class="n">molar_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_molar_mass</span><span class="p">()</span>
    <span class="n">percents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atomic</span> <span class="o">/</span> <span class="n">molar_mass</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">atomic</span> <span class="ow">in</span> <span class="n">atomic_masses</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">percents</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.molar_mass.MolarMassCalculation.calculate_atomic_percent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_atomic_percent</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculation of atomic percents of atoms in the parsed formula.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Atomic percentages of atoms in the formula</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_atomic_percent</span><span class="p">()</span>
<span class="go">{&#39;H&#39;: 66.66666666666666, &#39;O&#39;: 33.33333333333333</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_atomic_percent</span><span class="p">()</span>
<span class="go">{&#39;C&#39;: 22.22222222222222, &#39;H&#39;: 66.66666666666666, &#39;O&#39;: 11.11111111111111}</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/molar_mass.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_atomic_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of atomic percents of atoms in the parsed formula.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Atomic percentages of atoms in the formula</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; MolarMassCalculation({&#39;H&#39;:2, &#39;O&#39;:1}).calculate_atomic_percent()</span>
<span class="sd">        {&#39;H&#39;: 66.66666666666666, &#39;O&#39;: 33.33333333333333</span>
<span class="sd">        &gt;&gt;&gt; MolarMassCalculation({&#39;C&#39;:2, &#39;H&#39;:6, &#39;O&#39;:1}).calculate_atomic_percent()</span>
<span class="sd">        {&#39;C&#39;: 22.22222222222222, &#39;H&#39;: 66.66666666666666, &#39;O&#39;: 11.11111111111111}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">atomic</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">atomic</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.molar_mass.MolarMassCalculation._custom_oxides_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_custom_oxides_input</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks if passed non-default oxide formulas can be applied to any
atom in parsed formula. If so, replaces it with said non-default oxide.
If not, the default oxide is chosen.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="str">str</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An arbitrary number of non-default oxide formulas</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Oxide (chemsynthcalc.molar_mass.Oxide)" href="#chemsynthcalc.molar_mass.Oxide">Oxide</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of Oxide objects</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="raise" open>
  <summary>Raise</summary>
  <p>ValueError if compound is not binary or second element is not oxygen</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/molar_mass.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_custom_oxides_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Oxide</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if passed non-default oxide formulas can be applied to any</span>
<span class="sd">    atom in parsed formula. If so, replaces it with said non-default oxide.</span>
<span class="sd">    If not, the default oxide is chosen.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        *args (tuple[str, ...]): An arbitrary number of non-default oxide formulas</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of Oxide objects</span>

<span class="sd">    Raise:</span>
<span class="sd">        ValueError if compound is not binary or second element is not oxygen</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">first_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">c_oxide</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">parsed_oxide</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ChemicalFormulaParser</span><span class="p">(</span><span class="n">c_oxide</span><span class="p">)</span><span class="o">.</span><span class="n">parse_formula</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed_oxide</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only binary compounds can be considered as input&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">parsed_oxide</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;O&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only oxides can be considered as input&quot;</span><span class="p">)</span>

        <span class="n">first_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parsed_oxide</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">custom_oxides</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">first_atoms</span><span class="p">,</span> <span class="n">args</span><span class="p">))</span>
    <span class="n">mass_percents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculate_mass_percent</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">oxides</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Oxide</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsed_formula</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">atom</span> <span class="o">!=</span> <span class="s2">&quot;O&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">custom_oxides</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">custom_oxides</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_table</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span><span class="o">.</span><span class="n">default_oxide</span>
            <span class="n">oxides</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Oxide</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">mass_percents</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">oxides</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.molar_mass.MolarMassCalculation.calculate_oxide_percent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_oxide_percent</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculation of oxide percents in parsed formula.</p>
<p>Calculation of oxide percents in parsed formula from the types of oxide
declared in the periodic table file. This type of data
is mostly used in XRF spectrometry and mineralogy. The oxide
percents are calculated by finding the <a href="https://www.geol.umd.edu/~piccoli/probe/molweight.html">convertion factor between element
and its respective oxide</a>
and normalizing the total sum to 100%. One can change the oxide type
for certain elements in the <a class="autorefs autorefs-internal" title="periodic_table" href="#chemsynthcalc.periodic_table">periodic_table.py</a> file. Theoretically, this function
should work for other types of binary compound (sulfides, fluorides etc.)
or even salts, however, modification of this function is required
(for instance, in case of binary compound, removing X atom
from the list of future compounds should have X as an argument of this function).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="str">str</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An arbitrary number of non-default oxide formulas</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Percentages of oxides in the formula</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_oxide_percent</span><span class="p">()</span>
<span class="go">{&#39;CO2&#39;: 61.9570190690046, &#39;H2O&#39;: 38.04298093099541}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;Ba&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Ti&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_oxide_percent</span><span class="p">()</span>
<span class="go">{&#39;BaO&#39;: 65.7516917244869, &#39;TiO2&#39;: 34.24830827551309}</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/molar_mass.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_oxide_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of oxide percents in parsed formula.</span>

<span class="sd">    Calculation of oxide percents in parsed formula from the types of oxide</span>
<span class="sd">    declared in the periodic table file. This type of data</span>
<span class="sd">    is mostly used in XRF spectrometry and mineralogy. The oxide</span>
<span class="sd">    percents are calculated by finding the [convertion factor between element</span>
<span class="sd">    and its respective oxide](https://www.geol.umd.edu/~piccoli/probe/molweight.html)</span>
<span class="sd">    and normalizing the total sum to 100%. One can change the oxide type</span>
<span class="sd">    for certain elements in the [periodic_table.py][chemsynthcalc.periodic_table] file. Theoretically, this function</span>
<span class="sd">    should work for other types of binary compound (sulfides, fluorides etc.)</span>
<span class="sd">    or even salts, however, modification of this function is required</span>
<span class="sd">    (for instance, in case of binary compound, removing X atom</span>
<span class="sd">    from the list of future compounds should have X as an argument of this function).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        *args (tuple[str, ...]): An arbitrary number of non-default oxide formulas</span>

<span class="sd">    Returns:</span>
<span class="sd">        Percentages of oxides in the formula</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; MolarMassCalculation({&#39;C&#39;:2, &#39;H&#39;:6, &#39;O&#39;:1}).calculate_oxide_percent()</span>
<span class="sd">        {&#39;CO2&#39;: 61.9570190690046, &#39;H2O&#39;: 38.04298093099541}</span>
<span class="sd">        &gt;&gt;&gt; MolarMassCalculation({&#39;Ba&#39;:1, &#39;Ti&#39;:1, &#39;O&#39;:3}).calculate_oxide_percent()</span>
<span class="sd">        {&#39;BaO&#39;: 65.7516917244869, &#39;TiO2&#39;: 34.24830827551309}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">oxides</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Oxide</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_custom_oxides_input</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="n">oxide_percents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">oxide</span> <span class="ow">in</span> <span class="n">oxides</span><span class="p">:</span>
        <span class="n">parsed_oxide</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChemicalFormulaParser</span><span class="p">(</span>
            <span class="n">oxide</span><span class="o">.</span><span class="n">label</span>
        <span class="p">)</span><span class="o">.</span><span class="n">parse_formula</span><span class="p">()</span>
        <span class="n">oxide_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">MolarMassCalculation</span><span class="p">(</span>
            <span class="n">parsed_oxide</span>
        <span class="p">)</span><span class="o">.</span><span class="n">calculate_molar_mass</span><span class="p">()</span>
        <span class="n">atomic_oxide_coef</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">parsed_oxide</span><span class="p">[</span><span class="n">oxide</span><span class="o">.</span><span class="n">atom</span><span class="p">]</span>
        <span class="n">atomic_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_table</span><span class="p">[</span><span class="n">oxide</span><span class="o">.</span><span class="n">atom</span><span class="p">]</span><span class="o">.</span><span class="n">atomic_weight</span>
        <span class="n">conversion_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">oxide_mass</span> <span class="o">/</span> <span class="n">atomic_mass</span> <span class="o">/</span> <span class="n">atomic_oxide_coef</span>
        <span class="n">oxide_percents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oxide</span><span class="o">.</span><span class="n">mass_percent</span> <span class="o">*</span> <span class="n">conversion_factor</span><span class="p">)</span>

    <span class="n">normalized_oxide_percents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">x</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">oxide_percents</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">oxide_percents</span>
    <span class="p">]</span>
    <span class="n">oxide_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">oxide</span><span class="o">.</span><span class="n">label</span> <span class="k">for</span> <span class="n">oxide</span> <span class="ow">in</span> <span class="n">oxides</span><span class="p">]</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">oxide_labels</span><span class="p">,</span> <span class="n">normalized_oxide_percents</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.periodic_table" class="doc doc-heading">
            <code>periodic_table</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.periodic_table.Atom" class="doc doc-heading">
            <code>Atom</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>


        <p>Named tuple for representing atomic properties:
atomic weight and type of oxide that will be used by default.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/periodic_table.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Atom</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Named tuple for representing atomic properties:</span>
<span class="sd">    atomic weight and type of oxide that will be used by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">atomic_weight</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">default_oxide</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.periodic_table.PeriodicTable" class="doc doc-heading">
            <code>PeriodicTable</code>


</h3>


    <div class="doc doc-contents ">


        <p>Periodic table of elements in the form of "Atom symbol": Atom NamedTuple.
The standard atomic weights are taken from <a href="https://iupac.qmul.ac.uk/AtWt/">IUPAC</a>.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/periodic_table.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PeriodicTable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Periodic table of elements in the form of &quot;Atom symbol&quot;: Atom NamedTuple.</span>
<span class="sd">    The standard atomic weights are taken from [IUPAC](https://iupac.qmul.ac.uk/AtWt/).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_table</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Atom</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">1.008</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">),</span>
            <span class="s2">&quot;He&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">4.002602</span><span class="p">,</span> <span class="s2">&quot;He&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Li&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">6.94</span><span class="p">,</span> <span class="s2">&quot;Li2O&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Be&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">9.0121831</span><span class="p">,</span> <span class="s2">&quot;BeO&quot;</span><span class="p">),</span>
            <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">10.81</span><span class="p">,</span> <span class="s2">&quot;B2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">12.011</span><span class="p">,</span> <span class="s2">&quot;CO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">14.007</span><span class="p">,</span> <span class="s2">&quot;NO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;O&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">15.999</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">),</span>
            <span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">18.998403162</span><span class="p">,</span> <span class="s2">&quot;F2O&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ne&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">20.1797</span><span class="p">,</span> <span class="s2">&quot;Ne&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Na&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">22.98976928</span><span class="p">,</span> <span class="s2">&quot;Na2O&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Mg&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">24.305</span><span class="p">,</span> <span class="s2">&quot;MgO&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Al&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">26.9815384</span><span class="p">,</span> <span class="s2">&quot;Al2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Si&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">28.085</span><span class="p">,</span> <span class="s2">&quot;SiO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">30.973761998</span><span class="p">,</span> <span class="s2">&quot;P2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">32.06</span><span class="p">,</span> <span class="s2">&quot;SO3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Cl&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">35.45</span><span class="p">,</span> <span class="s2">&quot;ClO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ar&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">39.95</span><span class="p">,</span> <span class="s2">&quot;Ar&quot;</span><span class="p">),</span>
            <span class="s2">&quot;K&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">39.098</span><span class="p">,</span> <span class="s2">&quot;K2O&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ca&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">40.078</span><span class="p">,</span> <span class="s2">&quot;CaO&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Sc&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">44.955907</span><span class="p">,</span> <span class="s2">&quot;Sc2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ti&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">47.867</span><span class="p">,</span> <span class="s2">&quot;TiO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;V&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">50.9415</span><span class="p">,</span> <span class="s2">&quot;V2O5&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Cr&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">51.9961</span><span class="p">,</span> <span class="s2">&quot;Cr2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Mn&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">54.938043</span><span class="p">,</span> <span class="s2">&quot;MnO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Fe&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">55.845</span><span class="p">,</span> <span class="s2">&quot;Fe2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Co&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">58.933194</span><span class="p">,</span> <span class="s2">&quot;Co2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ni&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">58.6934</span><span class="p">,</span> <span class="s2">&quot;NiO&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Cu&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">63.546</span><span class="p">,</span> <span class="s2">&quot;Cu2O&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Zn&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">65.38</span><span class="p">,</span> <span class="s2">&quot;ZnO&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ga&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">69.723</span><span class="p">,</span> <span class="s2">&quot;Ga2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ge&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">72.63</span><span class="p">,</span> <span class="s2">&quot;GeO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;As&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">74.921595</span><span class="p">,</span> <span class="s2">&quot;As2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Se&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">78.971</span><span class="p">,</span> <span class="s2">&quot;Se3O4&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Br&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">79.904</span><span class="p">,</span> <span class="s2">&quot;BrO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Kr&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">83.798</span><span class="p">,</span> <span class="s2">&quot;Kr&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Rb&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">85.4678</span><span class="p">,</span> <span class="s2">&quot;Rb2O&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Sr&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">87.62</span><span class="p">,</span> <span class="s2">&quot;SrO&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Y&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">88.905838</span><span class="p">,</span> <span class="s2">&quot;Y2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Zr&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">91.222</span><span class="p">,</span> <span class="s2">&quot;ZrO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Nb&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">92.90637</span><span class="p">,</span> <span class="s2">&quot;Nb2O5&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Mo&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">95.95</span><span class="p">,</span> <span class="s2">&quot;MoO3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Tc&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span> <span class="s2">&quot;TcO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ru&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">101.07</span><span class="p">,</span> <span class="s2">&quot;RuO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Rh&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">102.90549</span><span class="p">,</span> <span class="s2">&quot;Rh2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Pd&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">106.42</span><span class="p">,</span> <span class="s2">&quot;PdO&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ag&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">107.8682</span><span class="p">,</span> <span class="s2">&quot;Ag2O&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Cd&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">112.414</span><span class="p">,</span> <span class="s2">&quot;CdO&quot;</span><span class="p">),</span>
            <span class="s2">&quot;In&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">114.818</span><span class="p">,</span> <span class="s2">&quot;In2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Sn&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">118.71</span><span class="p">,</span> <span class="s2">&quot;SnO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Sb&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">121.76</span><span class="p">,</span> <span class="s2">&quot;Sb2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Te&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">127.6</span><span class="p">,</span> <span class="s2">&quot;TeO3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;I&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">126.90447</span><span class="p">,</span> <span class="s2">&quot;I2O5&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Xe&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">131.29</span><span class="p">,</span> <span class="s2">&quot;Xe&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Cs&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">132.90545196</span><span class="p">,</span> <span class="s2">&quot;Cs2O&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ba&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">137.327</span><span class="p">,</span> <span class="s2">&quot;BaO&quot;</span><span class="p">),</span>
            <span class="s2">&quot;La&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">138.90547</span><span class="p">,</span> <span class="s2">&quot;La2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ce&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">140.116</span><span class="p">,</span> <span class="s2">&quot;CeO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Pr&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">140.90766</span><span class="p">,</span> <span class="s2">&quot;Pr2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Nd&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">144.242</span><span class="p">,</span> <span class="s2">&quot;Nd2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Pm&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">145</span><span class="p">,</span> <span class="s2">&quot;Pm2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Sm&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">150.36</span><span class="p">,</span> <span class="s2">&quot;Sm2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Eu&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">151.964</span><span class="p">,</span> <span class="s2">&quot;Eu2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Gd&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">157.249</span><span class="p">,</span> <span class="s2">&quot;Gd2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Tb&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">158.925354</span><span class="p">,</span> <span class="s2">&quot;Tb2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Dy&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">162.5</span><span class="p">,</span> <span class="s2">&quot;Dy2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ho&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">164.930329</span><span class="p">,</span> <span class="s2">&quot;Ho2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Er&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">167.259</span><span class="p">,</span> <span class="s2">&quot;Er2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Tm&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">168.934219</span><span class="p">,</span> <span class="s2">&quot;Tm2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Yb&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">173.045</span><span class="p">,</span> <span class="s2">&quot;Yb2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Lu&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">174.96669</span><span class="p">,</span> <span class="s2">&quot;Lu2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Hf&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">178.486</span><span class="p">,</span> <span class="s2">&quot;HfO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ta&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">180.94788</span><span class="p">,</span> <span class="s2">&quot;Ta2O5&quot;</span><span class="p">),</span>
            <span class="s2">&quot;W&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">183.84</span><span class="p">,</span> <span class="s2">&quot;WO3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Re&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">186.207</span><span class="p">,</span> <span class="s2">&quot;Re2O7&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Os&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">190.23</span><span class="p">,</span> <span class="s2">&quot;OsO3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ir&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">192.217</span><span class="p">,</span> <span class="s2">&quot;Ir2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Pt&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">195.084</span><span class="p">,</span> <span class="s2">&quot;PtO&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Au&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">196.966570</span><span class="p">,</span> <span class="s2">&quot;Au2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Hg&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">200.592</span><span class="p">,</span> <span class="s2">&quot;HgO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Tl&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">204.38</span><span class="p">,</span> <span class="s2">&quot;Tl2O&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Pb&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">207.2</span><span class="p">,</span> <span class="s2">&quot;PbO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Bi&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">208.98040</span><span class="p">,</span> <span class="s2">&quot;Bi2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Po&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">209</span><span class="p">,</span> <span class="s2">&quot;PoO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;At&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">210</span><span class="p">,</span> <span class="s2">&quot;At2O&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Rn&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">222</span><span class="p">,</span> <span class="s2">&quot;Rn&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Fr&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">223</span><span class="p">,</span> <span class="s2">&quot;Fr2O&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ra&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">226</span><span class="p">,</span> <span class="s2">&quot;RaO&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ac&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">227</span><span class="p">,</span> <span class="s2">&quot;Ac2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Th&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">232.0377</span><span class="p">,</span> <span class="s2">&quot;ThO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Pa&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">231.03588</span><span class="p">,</span> <span class="s2">&quot;Pa2O5&quot;</span><span class="p">),</span>
            <span class="s2">&quot;U&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mf">238.02891</span><span class="p">,</span> <span class="s2">&quot;UO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Np&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">237</span><span class="p">,</span> <span class="s2">&quot;NpO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Pu&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">244</span><span class="p">,</span> <span class="s2">&quot;PuO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Am&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">243</span><span class="p">,</span> <span class="s2">&quot;AmO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Cm&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">247</span><span class="p">,</span> <span class="s2">&quot;Cm2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Bk&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">247</span><span class="p">,</span> <span class="s2">&quot;BkO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Cf&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">251</span><span class="p">,</span> <span class="s2">&quot;Cf2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Es&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">252</span><span class="p">,</span> <span class="s2">&quot;Es2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Fm&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">257</span><span class="p">,</span> <span class="s2">&quot;Fm2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Md&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">258</span><span class="p">,</span> <span class="s2">&quot;Md2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;No&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">259</span><span class="p">,</span> <span class="s2">&quot;No2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Lr&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">262</span><span class="p">,</span> <span class="s2">&quot;Lr2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Rf&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">267</span><span class="p">,</span> <span class="s2">&quot;RfO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Db&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">270</span><span class="p">,</span> <span class="s2">&quot;Db2O5&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Sg&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">269</span><span class="p">,</span> <span class="s2">&quot;SgO4&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Bh&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">270</span><span class="p">,</span> <span class="s2">&quot;Bh2O7&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Hs&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">270</span><span class="p">,</span> <span class="s2">&quot;HsO3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Mt&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">278</span><span class="p">,</span> <span class="s2">&quot;Mt2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ds&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">281</span><span class="p">,</span> <span class="s2">&quot;DsO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Rg&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">281</span><span class="p">,</span> <span class="s2">&quot;RgO&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Cn&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">285</span><span class="p">,</span> <span class="s2">&quot;Cn2O3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Nh&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">286</span><span class="p">,</span> <span class="s2">&quot;NhO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Fl&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">289</span><span class="p">,</span> <span class="s2">&quot;FlO2&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Mc&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">289</span><span class="p">,</span> <span class="s2">&quot;Mc2O5&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Lv&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">293</span><span class="p">,</span> <span class="s2">&quot;LvO3&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Ts&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">293</span><span class="p">,</span> <span class="s2">&quot;Ts2O7&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Og&quot;</span><span class="p">:</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">294</span><span class="p">,</span> <span class="s2">&quot;Og&quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_table</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.reaction" class="doc doc-heading">
            <code>reaction</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.reaction.Reaction" class="doc doc-heading">
            <code>Reaction</code>


</h3>


    <div class="doc doc-contents ">


        <p>A base class for
<a class="autorefs autorefs-internal" href="#chemsynthcalc.reaction_decomposer.ReactionDecomposer">ReactionDecomposer</a> and
<a class="autorefs autorefs-internal" href="#chemsynthcalc.reaction_validator.ReactionValidator">ReactionValidator</a>
containing regexes and symbols.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>reaction</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reaction string</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.reaction.Reaction.allowed_symbols">allowed_symbols</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Regex of all symbols allowed in a reaction string</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.reaction.Reaction.possible_reaction_separators">possible_reaction_separators</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of all allowed reaction separators (left and right part separator)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.reaction.Reaction.reactant_separator">reactant_separator</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Only one possible reactant separator ("+")</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/reaction.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Reaction</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A base class for</span>
<span class="sd">    [ReactionDecomposer][chemsynthcalc.reaction_decomposer.ReactionDecomposer] and</span>
<span class="sd">    [ReactionValidator][chemsynthcalc.reaction_validator.ReactionValidator]</span>
<span class="sd">    containing regexes and symbols.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        reaction (str): Reaction string</span>

<span class="sd">    Attributes:</span>
<span class="sd">        allowed_symbols (str): Regex of all symbols allowed in a reaction string</span>
<span class="sd">        possible_reaction_separators (list[str]): List of all allowed reaction separators (left and right part separator)</span>
<span class="sd">        reactant_separator (str): Only one possible reactant separator (&quot;+&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reaction</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_symbols</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[^a-zA-Z0-9.({[)}\]*·•=&lt;\-&gt;→⇄+ ]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">possible_reaction_separators</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;==&quot;</span><span class="p">,</span>
            <span class="s2">&quot;=&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&lt;-&gt;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&lt;&gt;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;→&quot;</span><span class="p">,</span>
            <span class="s2">&quot;⇄&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactant_separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="n">reaction</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_separator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract one of possible reaction separator from</span>
<span class="sd">        the reaction string.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Separator string if separator is found, empty string if not</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">separator</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_reaction_separators</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">separator</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span>
                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">separator</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span>
                <span class="p">):</span>
                    <span class="k">return</span> <span class="n">separator</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.reaction.Reaction.extract_separator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_separator</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Extract one of possible reaction separator from
the reaction string.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Separator string if separator is found, empty string if not</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/reaction.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_separator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract one of possible reaction separator from</span>
<span class="sd">    the reaction string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Separator string if separator is found, empty string if not</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">separator</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_reaction_separators</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">separator</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">separator</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="n">separator</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.reaction_decomposer" class="doc doc-heading">
            <code>reaction_decomposer</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.reaction_decomposer.ReactionDecomposer" class="doc doc-heading">
            <code>ReactionDecomposer</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Reaction (chemsynthcalc.reaction.Reaction)" href="#chemsynthcalc.reaction.Reaction">Reaction</a></code></p>


        <p>Decomposition of chemical reaction string and extraction of
reaction separator, reactants, products and initial coefficients.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>reaction</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A reaction string</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.reaction_decomposer.ReactionDecomposer.separator">separator</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A reactants - products separator (usually "+")</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.reaction_decomposer.ReactionDecomposer.initial_coefficients">initial_coefficients</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of coefficients striped from the formulas</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.reaction_decomposer.ReactionDecomposer.reactants">reactants</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of compound from letf part of the reaction equation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.reaction_decomposer.ReactionDecomposer.products">products</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of compound from right part of the reaction equation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="chemsynthcalc.reaction_decomposer.ReactionDecomposer.compounds">compounds</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reactants + products</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/reaction_decomposer.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ReactionDecomposer</span><span class="p">(</span><span class="n">Reaction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decomposition of chemical reaction string and extraction of</span>
<span class="sd">    reaction separator, reactants, products and initial coefficients.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        reaction (str): A reaction string</span>

<span class="sd">    Attributes:</span>
<span class="sd">        separator (str): A reactants - products separator (usually &quot;+&quot;)</span>
<span class="sd">        initial_coefficients (list[float]): A list of coefficients striped from the formulas</span>
<span class="sd">        reactants (list[str]): A list of compound from letf part of the reaction equation</span>
<span class="sd">        products (list[str]): A list of compound from right part of the reaction equation</span>
<span class="sd">        compounds (list[str]): reactants + products</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reaction</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_separator</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_initial_reactants</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">)[</span>
            <span class="mi">0</span>
        <span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactant_separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initial_products</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">)[</span>
            <span class="mi">1</span>
        <span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactant_separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_splitted_compounds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">split_coefficient_from_formula</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">formula</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_reactants</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_products</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">initial_coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">atom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_splitted_compounds</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compounds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_splitted_compounds</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compounds</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_reactants</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compounds</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_reactants</span><span class="p">)</span> <span class="p">:]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;separator: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="si">}</span><span class="s2">; reactants: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="si">}</span><span class="s2">; products: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ReactionDecomposer(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">split_coefficient_from_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formula</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Split the coefficient (int or float) from string containing formula and coef.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            formula (str): Formula string</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple of (coefficient, formula)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">formula</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="k">return</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">formula</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coef</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">formula</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">symbol</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">or</span> <span class="n">symbol</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">:</span>
                    <span class="n">coef</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coef</span><span class="p">)),</span> <span class="n">formula</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.reaction_decomposer.ReactionDecomposer.split_coefficient_from_formula" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split_coefficient_from_formula</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Split the coefficient (int or float) from string containing formula and coef.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>formula</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formula string</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of (coefficient, formula)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/reaction_decomposer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">split_coefficient_from_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formula</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split the coefficient (int or float) from string containing formula and coef.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        formula (str): Formula string</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple of (coefficient, formula)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">formula</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">formula</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coef</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">formula</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">symbol</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">or</span> <span class="n">symbol</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">:</span>
                <span class="n">coef</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coef</span><span class="p">)),</span> <span class="n">formula</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.reaction_matrix" class="doc doc-heading">
            <code>reaction_matrix</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.reaction_matrix.ChemicalReactionMatrix" class="doc doc-heading">
            <code>ChemicalReactionMatrix</code>


</h3>


    <div class="doc doc-contents ">


        <p>A class to create a dense float matrix from the parsed formulas.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parsed_formulas</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of formulas parsed by <a class="autorefs autorefs-internal" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser">ChemicalFormulaParser</a></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/reaction_matrix.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChemicalReactionMatrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to create a dense float matrix from the parsed formulas.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        parsed_formulas (list[dict[str, float]]): A list of formulas parsed by [ChemicalFormulaParser][chemsynthcalc.formula_parser.ChemicalFormulaParser]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_formulas</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_formulas</span> <span class="o">=</span> <span class="n">parsed_formulas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_merged_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_formulas</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_merged_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_reaction_matrix</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_reaction_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a 2D NumPy array from nested Python lists.</span>
<span class="sd">        The content of lists are exctracted from parsed dicts.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A 2D NumPy array of the reaction matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matrix</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="p">:</span>
            <span class="n">row</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">compound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_formulas</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">compound</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compound</span><span class="p">[</span><span class="n">element</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">matrix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.reaction_matrix.ChemicalReactionMatrix.create_reaction_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_reaction_matrix</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Creates a 2D NumPy array from nested Python lists.
The content of lists are exctracted from parsed dicts.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 2D NumPy array of the reaction matrix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/reaction_matrix.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_reaction_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a 2D NumPy array from nested Python lists.</span>
<span class="sd">    The content of lists are exctracted from parsed dicts.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A 2D NumPy array of the reaction matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matrix</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="p">:</span>
        <span class="n">row</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">compound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_formulas</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">compound</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compound</span><span class="p">[</span><span class="n">element</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">matrix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.reaction_validator" class="doc doc-heading">
            <code>reaction_validator</code>


</h2>

    <div class="doc doc-contents ">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="chemsynthcalc.reaction_validator.ReactionValidator" class="doc doc-heading">
            <code>ReactionValidator</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Reaction (chemsynthcalc.reaction.Reaction)" href="#chemsynthcalc.reaction.Reaction">Reaction</a></code></p>


        <p>Methods of this class validate the initial input reaction.</p>







              <details class="quote">
                <summary>Source code in <code>src/chemsynthcalc/reaction_validator.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ReactionValidator</span><span class="p">(</span><span class="n">Reaction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Methods of this class validate the initial input reaction.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_empty_reaction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if reaction is an empty string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_invalid_charachers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if reaction string contains invalid characters.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of invalid characters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allowed_symbols</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_no_reaction_separator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if reaction string contains a separator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_separator</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_no_reactant_separator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if reaction string contains a &quot;+&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactant_separator</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_reaction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validation of the reaction string.</span>
<span class="sd">        Calls the private methods of this class in order.</span>

<span class="sd">        Raise:</span>
<span class="sd">            [EmptyReaction][chemsynthcalc.chem_errors.EmptyReaction] if reaction string is empty. &lt;br /&gt;</span>
<span class="sd">            [InvalidCharacter][chemsynthcalc.chem_errors.InvalidCharacter] if some characters are invalid. &lt;br /&gt;</span>
<span class="sd">            [NoSeparator][chemsynthcalc.chem_errors.NoSeparator] if any of separators (reaction or reactant) are missing.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if all the checks are OK</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_empty_reaction</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">EmptyReaction</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_charachers</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">InvalidCharacter</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid character(s) </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_invalid_charachers</span><span class="p">()</span><span class="si">}</span><span class="s2"> in reaction&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_no_reaction_separator</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">NoSeparator</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No separator between reactants and products: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_reaction_separators</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_no_reactant_separator</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">NoSeparator</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No separators between compounds: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">reactant_separator</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.reaction_validator.ReactionValidator._check_empty_reaction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_check_empty_reaction</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks if reaction is an empty string.</p>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/reaction_validator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_check_empty_reaction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if reaction is an empty string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.reaction_validator.ReactionValidator._invalid_charachers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_invalid_charachers</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks if reaction string contains invalid characters.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of invalid characters</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/reaction_validator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_invalid_charachers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if reaction string contains invalid characters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of invalid characters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allowed_symbols</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.reaction_validator.ReactionValidator._no_reaction_separator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_no_reaction_separator</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks if reaction string contains a separator.</p>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/reaction_validator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_no_reaction_separator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if reaction string contains a separator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_separator</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.reaction_validator.ReactionValidator._no_reactant_separator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_no_reactant_separator</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks if reaction string contains a "+".</p>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/reaction_validator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_no_reactant_separator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if reaction string contains a &quot;+&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactant_separator</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="chemsynthcalc.reaction_validator.ReactionValidator.validate_reaction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_reaction</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Validation of the reaction string.
Calls the private methods of this class in order.</p>


<details class="raise" open>
  <summary>Raise</summary>
  <p><a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.EmptyReaction">EmptyReaction</a> if reaction string is empty. <br />
<a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.InvalidCharacter">InvalidCharacter</a> if some characters are invalid. <br />
<a class="autorefs autorefs-internal" href="#chemsynthcalc.chem_errors.NoSeparator">NoSeparator</a> if any of separators (reaction or reactant) are missing.</p>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if all the checks are OK</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/reaction_validator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_reaction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validation of the reaction string.</span>
<span class="sd">    Calls the private methods of this class in order.</span>

<span class="sd">    Raise:</span>
<span class="sd">        [EmptyReaction][chemsynthcalc.chem_errors.EmptyReaction] if reaction string is empty. &lt;br /&gt;</span>
<span class="sd">        [InvalidCharacter][chemsynthcalc.chem_errors.InvalidCharacter] if some characters are invalid. &lt;br /&gt;</span>
<span class="sd">        [NoSeparator][chemsynthcalc.chem_errors.NoSeparator] if any of separators (reaction or reactant) are missing.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if all the checks are OK</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_empty_reaction</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">EmptyReaction</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_charachers</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">InvalidCharacter</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid character(s) </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_invalid_charachers</span><span class="p">()</span><span class="si">}</span><span class="s2"> in reaction&quot;</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_no_reaction_separator</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">NoSeparator</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No separator between reactants and products: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_reaction_separators</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_no_reactant_separator</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">NoSeparator</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No separators between compounds: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">reactant_separator</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="chemsynthcalc.utils" class="doc doc-heading">
            <code>utils</code>


</h2>

    <div class="doc doc-contents ">

        <p>A module with some useful utilities functions.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="chemsynthcalc.utils.round_dict_content" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">round_dict_content</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">plus</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Round all values of a dictionary to arbitrary precision
(with optional surplus value).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An input dict</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Precision</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plus</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional surplus</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rounded dictionary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">round_dict_content</span><span class="p">(</span>
    <span class="nb">input</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">precision</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">plus</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Round all values of a dictionary to arbitrary precision</span>
<span class="sd">    (with optional surplus value).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        input (dict[str, float]): An input dict</span>
<span class="sd">        precision (int): Precision</span>
<span class="sd">        plus (int): An optional surplus</span>

<span class="sd">    Returns:</span>
<span class="sd">        Rounded dictionary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">plus</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">input</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="chemsynthcalc.utils.to_integer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_integer</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Cast a float to int if this float is some x.0 (integer), otherwise
keep a float.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>coefficients</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mixed list of floats and ints</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mixed list of floats and ints</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_integer</span><span class="p">(</span><span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cast a float to int if this float is some x.0 (integer), otherwise</span>
<span class="sd">    keep a float.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        coefficients (list[float | int]): Mixed list of floats and ints</span>

<span class="sd">    Returns:</span>
<span class="sd">        Mixed list of floats and ints</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">is_integer</span><span class="p">()</span> <span class="k">else</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">coefficients</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="chemsynthcalc.utils.find_lcm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_lcm</span><span class="p">(</span><span class="n">int_list</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Find Least Common Multiplyer of list of integers</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>int_list</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of integers</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The LCM</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_lcm</span><span class="p">(</span><span class="n">int_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find Least Common Multiplyer of list of integers</span>

<span class="sd">    Parameters:</span>
<span class="sd">        int_list (list[int]): A list of integers</span>

<span class="sd">    Returns:</span>
<span class="sd">        The LCM</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lcm</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">int_list</span><span class="p">:</span>
        <span class="n">lcm</span> <span class="o">=</span> <span class="n">lcm</span> <span class="o">*</span> <span class="n">i</span> <span class="o">//</span> <span class="n">gcd</span><span class="p">(</span><span class="n">lcm</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lcm</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="chemsynthcalc.utils.find_gcd" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_gcd</span><span class="p">(</span><span class="n">int_list</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Find Greatest Common Divisor of list of integers</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>int_list</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of integers</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCD</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/chemsynthcalc/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_gcd</span><span class="p">(</span><span class="n">int_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find Greatest Common Divisor of list of integers</span>

<span class="sd">    Parameters:</span>
<span class="sd">        int_list (list[int]): A list of integers</span>

<span class="sd">    Returns:</span>
<span class="sd">        The GCD</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">gcd</span><span class="p">,</span> <span class="n">int_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>