

<!DOCTYPE html>
<html class="writer-html5" lang="English" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>chemsynthcalc package &mdash; chemsynthcalc 1.0.8 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/css\rtd_sphinx_search.min.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/js\rtd_sphinx_search.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="License" href="license.html" />
    <link rel="prev" title="API" href="API.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> chemsynthcalc
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemical_formula.html">ChemicalFormula class</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemical_reaction.html">ChemicalReaction class</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="API.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">chemsynthcalc package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-chemsynthcalc.chem_errors">chemsynthcalc.chem_errors module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-chemsynthcalc.chem_output">chemsynthcalc.chem_output module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-chemsynthcalc.chemical_formula">chemsynthcalc.chemical_formula module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-chemsynthcalc.chemical_reaction">chemsynthcalc.chemical_reaction module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-chemsynthcalc.chemutils">chemsynthcalc.chemutils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-chemsynthcalc.formula_parser">chemsynthcalc.formula_parser module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-chemsynthcalc.molar_mass">chemsynthcalc.molar_mass module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-chemsynthcalc.periodic_table">chemsynthcalc.periodic_table module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-chemsynthcalc.reaction_balance">chemsynthcalc.reaction_balance module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-chemsynthcalc.reaction_matrix">chemsynthcalc.reaction_matrix module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="contacts.html">Contacts</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">chemsynthcalc</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="API.html">API</a> &raquo;</li>
        
      <li>chemsynthcalc package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/chemsynthcalc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="chemsynthcalc-package">
<h1>chemsynthcalc package<a class="headerlink" href="#chemsynthcalc-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-chemsynthcalc.chem_errors">
<span id="chemsynthcalc-chem-errors-module"></span><h2>chemsynthcalc.chem_errors module<a class="headerlink" href="#module-chemsynthcalc.chem_errors" title="Permalink to this headline">¶</a></h2>
<p>Module that contains custom errors for use in <cite>ChemSynthCalc</cite></p>
<dl class="py exception">
<dt class="sig sig-object py" id="chemsynthcalc.chem_errors.NoSuchAtom">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chem_errors.</span></span><span class="sig-name descname"><span class="pre">NoSuchAtom</span></span><a class="headerlink" href="#chemsynthcalc.chem_errors.NoSuchAtom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Found atom(s) that are not in the periodic table.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="chemsynthcalc.chem_errors.InvalidCharacter">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chem_errors.</span></span><span class="sig-name descname"><span class="pre">InvalidCharacter</span></span><a class="headerlink" href="#chemsynthcalc.chem_errors.InvalidCharacter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Found some characters that do not belong in the
chemical formula or reaction.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="chemsynthcalc.chem_errors.MoreThanOneAdduct">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chem_errors.</span></span><span class="sig-name descname"><span class="pre">MoreThanOneAdduct</span></span><a class="headerlink" href="#chemsynthcalc.chem_errors.MoreThanOneAdduct" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>There is more than one adduct (*).</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="chemsynthcalc.chem_errors.BracketsNotPaired">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chem_errors.</span></span><span class="sig-name descname"><span class="pre">BracketsNotPaired</span></span><a class="headerlink" href="#chemsynthcalc.chem_errors.BracketsNotPaired" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Some brackets do not come in pairs.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="chemsynthcalc.chem_errors.NoSuchMode">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chem_errors.</span></span><span class="sig-name descname"><span class="pre">NoSuchMode</span></span><a class="headerlink" href="#chemsynthcalc.chem_errors.NoSuchMode" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Invalid calculation mode detected.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="chemsynthcalc.chem_errors.NoSuchAlgorithm">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chem_errors.</span></span><span class="sig-name descname"><span class="pre">NoSuchAlgorithm</span></span><a class="headerlink" href="#chemsynthcalc.chem_errors.NoSuchAlgorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Invalid calculation algorithm detected.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="chemsynthcalc.chem_errors.NoSeparator">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chem_errors.</span></span><span class="sig-name descname"><span class="pre">NoSeparator</span></span><a class="headerlink" href="#chemsynthcalc.chem_errors.NoSeparator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>No separator was found in the reaction string.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="chemsynthcalc.chem_errors.ReactionNotBalanced">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chem_errors.</span></span><span class="sig-name descname"><span class="pre">ReactionNotBalanced</span></span><a class="headerlink" href="#chemsynthcalc.chem_errors.ReactionNotBalanced" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>This reaction is not balanced.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="chemsynthcalc.chem_errors.ReactantProductDifference">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chem_errors.</span></span><span class="sig-name descname"><span class="pre">ReactantProductDifference</span></span><a class="headerlink" href="#chemsynthcalc.chem_errors.ReactantProductDifference" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>The elements in reaction are not evenly
distributed in reactants and products:
some of atoms are only in one part of
reaction.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="chemsynthcalc.chem_errors.BadCoeffiecients">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chem_errors.</span></span><span class="sig-name descname"><span class="pre">BadCoeffiecients</span></span><a class="headerlink" href="#chemsynthcalc.chem_errors.BadCoeffiecients" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>The coefficients are not not compliant
(they have no physical meaning).</p>
</dd></dl>

</div>
<div class="section" id="module-chemsynthcalc.chem_output">
<span id="chemsynthcalc-chem-output-module"></span><h2>chemsynthcalc.chem_output module<a class="headerlink" href="#module-chemsynthcalc.chem_output" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="chemsynthcalc.chem_output.FormulaOutput">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chem_output.</span></span><span class="sig-name descname"><span class="pre">FormulaOutput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chemical_formula_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemsynthcalc.chem_output.FormulaOutput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Outputs for <a class="reference internal" href="#chemsynthcalc.chemical_formula.ChemicalFormula" title="chemsynthcalc.chemical_formula.ChemicalFormula"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.chemical_formula.ChemicalFormula</span></code></a></p>
<p>A collection of methods for outputing results of
<a class="reference internal" href="#chemsynthcalc.chemical_formula.ChemicalFormula" title="chemsynthcalc.chemical_formula.ChemicalFormula"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.chemical_formula.ChemicalFormula</span></code></a>. Default filenames of
output files are &quot;CSC_formula&quot; with formula
and nanosecond since the epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chemical_formula_output</strong> (<em>dict</em>) -- output of <a class="reference internal" href="#chemsynthcalc.chemical_formula.ChemicalFormula" title="chemsynthcalc.chemical_formula.ChemicalFormula"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.chemical_formula.ChemicalFormula</span></code></a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chem_output.FormulaOutput.print_results">
<span class="sig-name descname"><span class="pre">print_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.chem_output.FormulaOutput.print_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Print results in the terminal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chem_output.FormulaOutput.export_to_txt">
<span class="sig-name descname"><span class="pre">export_to_txt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.chem_output.FormulaOutput.export_to_txt" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints results into the txt file and saves them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) -- filename string (should end with .txt)</p></li>
<li><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chem_output.FormulaOutput.dump_to_json">
<span class="sig-name descname"><span class="pre">dump_to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chemsynthcalc.chem_output.FormulaOutput.dump_to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>JSON serialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A JSON-type object of results output.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chem_output.FormulaOutput.export_to_json">
<span class="sig-name descname"><span class="pre">export_to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.chem_output.FormulaOutput.export_to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump the output dict into an JSON file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) -- filename string (should end with .json)</p></li>
<li><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="chemsynthcalc.chem_output.ReactionOutput">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chem_output.</span></span><span class="sig-name descname"><span class="pre">ReactionOutput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chemical_reaction_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemsynthcalc.chem_output.ReactionOutput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Outputs for <a class="reference internal" href="#chemsynthcalc.chemical_reaction.ChemicalReaction" title="chemsynthcalc.chemical_reaction.ChemicalReaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.chemical_reaction.ChemicalReaction</span></code></a></p>
<p>A collection of methods to output the results of
<a class="reference internal" href="#chemsynthcalc.chemical_reaction.ChemicalReaction" title="chemsynthcalc.chemical_reaction.ChemicalReaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.chemical_reaction.ChemicalReaction</span></code></a>.The default
filenames of the output files are &quot;CSC_reaction&quot; with target compound and nanoseconds since the epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chemical_formula_output</strong> (<em>dict</em>) -- output of <a class="reference internal" href="#chemsynthcalc.chemical_reaction.ChemicalReaction" title="chemsynthcalc.chemical_reaction.ChemicalReaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.chemical_reaction.ChemicalReaction</span></code></a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chem_output.ReactionOutput.print_results">
<span class="sig-name descname"><span class="pre">print_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.chem_output.ReactionOutput.print_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Print results in the terminal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chem_output.ReactionOutput.export_to_txt">
<span class="sig-name descname"><span class="pre">export_to_txt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.chem_output.ReactionOutput.export_to_txt" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints results into the txt file and saves it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) -- filename string (should end with .txt)</p></li>
<li><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chem_output.ReactionOutput.dump_to_json">
<span class="sig-name descname"><span class="pre">dump_to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chemsynthcalc.chem_output.ReactionOutput.dump_to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>JSON serialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A JSON-type object of results output.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chem_output.ReactionOutput.export_to_json">
<span class="sig-name descname"><span class="pre">export_to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.chem_output.ReactionOutput.export_to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump output dict into JSON flie.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) -- filename string (should end with .json)</p></li>
<li><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-chemsynthcalc.chemical_formula">
<span id="chemsynthcalc-chemical-formula-module"></span><h2>chemsynthcalc.chemical_formula module<a class="headerlink" href="#module-chemsynthcalc.chemical_formula" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_formula.ChemicalFormula">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chemical_formula.</span></span><span class="sig-name descname"><span class="pre">ChemicalFormula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemsynthcalc.chemical_formula.ChemicalFormula" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A base class for representing a single chemical formula.</p>
<p>It constructs with a formula string and calculates properties:
parsed formula, molar mass, mass percent, atomic percent,
oxide percent  from this string using
<a class="reference internal" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser" title="chemsynthcalc.formula_parser.ChemicalFormulaParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.formula_parser.ChemicalFormulaParser</span></code></a> and
<a class="reference internal" href="#chemsynthcalc.molar_mass.MolarMassCalculation" title="chemsynthcalc.molar_mass.MolarMassCalculation"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.molar_mass.MolarMassCalculation</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>formula</strong> (<em>srt</em>) -- string of chemical formula</p></li>
<li><p><strong>rounding_order</strong> (<em>int</em>) -- value of rounding precision (8 by default)</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> -- if the input string is empty</p></li>
<li><p><strong>ValueError</strong> -- if rounding order &lt;= 0</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span>
<span class="go">H2O</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">molar_mass</span>
<span class="go">18.015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mass_percent</span>
<span class="go">{&#39;H&#39;: 11.19067444, &#39;O&#39;: 88.80932556}</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_formula.ChemicalFormula.parsed_formula">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parsed_formula</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#chemsynthcalc.chemical_formula.ChemicalFormula.parsed_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Formula parsed into dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Parsed dictionary representation of formula string
created by <a class="reference internal" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser" title="chemsynthcalc.formula_parser.ChemicalFormulaParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.formula_parser.ChemicalFormulaParser</span></code></a>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;K2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parsed_formula</span>
<span class="go">{&#39;K&#39;: 2.0, &#39;S&#39;: 1.0, &#39;O&#39;: 4.0}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_formula.ChemicalFormula.molar_mass">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">molar_mass</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#chemsynthcalc.chemical_formula.ChemicalFormula.molar_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Molar mass of formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Molar_mass">molar mass</a>
of the formula (in g/mol), calculated from
parsed the formula using <a class="reference internal" href="#chemsynthcalc.molar_mass.MolarMassCalculation" title="chemsynthcalc.molar_mass.MolarMassCalculation"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.molar_mass.MolarMassCalculation</span></code></a>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;K2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">molar_mass</span>
<span class="go">174.252</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_formula.ChemicalFormula.mass_percent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mass_percent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#chemsynthcalc.chemical_formula.ChemicalFormula.mass_percent" title="Permalink to this definition">¶</a></dt>
<dd><p>The percentage of mass of atoms in the formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A mass percent or
<a class="reference external" href="https://en.wikipedia.org/wiki/Mass_fraction_(chemistry)">relative mass fraction</a>
of atoms in parsed chemical formula. The values of
mass content are in % (with 100% sum), not fraction.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;K2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mass_percent</span>
<span class="go">{&#39;K&#39;: 44.87523816, &#39;S&#39;: 18.39864105, &#39;O&#39;: 36.72612079}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_formula.ChemicalFormula.atomic_percent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atomic_percent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#chemsynthcalc.chemical_formula.ChemicalFormula.atomic_percent" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic percents of atoms in the formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An atomic percent or
<a class="reference external" href="https://en.wikipedia.org/wiki/Mole_fraction">relative mole fraction</a>
dictionary of atoms in a parsed chemical formula.
The values of mole content are in % (with 100% sum),
not fraction.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;K2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">atomic_percent</span>
<span class="go">{&#39;K&#39;: 28.57142857, &#39;S&#39;: 14.28571429, &#39;O&#39;: 57.14285714}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_formula.ChemicalFormula.oxide_percent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">oxide_percent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#chemsynthcalc.chemical_formula.ChemicalFormula.oxide_percent" title="Permalink to this definition">¶</a></dt>
<dd><p>Oxide percents of metals in formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An oxide percent or
<a class="reference external" href="https://d32ogoqmya1dw8.cloudfront.net/files/introgeo/studio/examples/minex02.pdf">oxide fraction</a>
dictionary of atoms in parsed chemical formula. Oxide types are listed
in the <a class="reference internal" href="#module-chemsynthcalc.periodic_table" title="chemsynthcalc.periodic_table"><code class="xref py py-mod docutils literal notranslate"><span class="pre">chemsynthcalc.periodic_table</span></code></a> file and can be changed to
any oxide formula. The values of oxide content
are in % (with 100% sum), not fraction.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;K2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">oxide_percent</span>
<span class="go">{&#39;K2O&#39;: 54.05676836, &#39;SO3&#39;: 45.94323164}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_formula.ChemicalFormula.output_results">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_results</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#chemsynthcalc.chemical_formula.ChemicalFormula.output_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of the calculation result output for class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Output dictionary for all properties listed above.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormula</span><span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">output_results</span>
<span class="go">{&#39;formula&#39;: &#39;H2O&#39;,</span>
<span class="go">&#39;parsed formula&#39;: {&#39;H&#39;: 2.0, &#39;O&#39;: 1.0},</span>
<span class="go">&#39;molar mass&#39;: 18.015,</span>
<span class="go">&#39;mass percent&#39;: {&#39;H&#39;: 11.19067444, &#39;O&#39;: 88.80932556},</span>
<span class="go">&#39;atomic percent&#39;: {&#39;H&#39;: 66.66666667, &#39;O&#39;: 33.33333333},</span>
<span class="go">&#39;oxide percent&#39;: {&#39;H2O&#39;: 100.0}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_formula.ChemicalFormula.print_results">
<span class="sig-name descname"><span class="pre">print_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.chemical_formula.ChemicalFormula.print_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to print a final result of calculations in terminal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision (4 digits by default)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_formula.ChemicalFormula.export_to_txt">
<span class="sig-name descname"><span class="pre">export_to_txt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.chemical_formula.ChemicalFormula.export_to_txt" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to print the final result of the calculations in a txt file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) -- filename string (should end with .txt)</p></li>
<li><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision (4 digits by default)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_formula.ChemicalFormula.as_json">
<span class="sig-name descname"><span class="pre">as_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chemsynthcalc.chemical_formula.ChemicalFormula.as_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialization of output into JSON object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision (4 digits by default)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A JSON-type object of results output.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_formula.ChemicalFormula.export_to_json">
<span class="sig-name descname"><span class="pre">export_to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.chemical_formula.ChemicalFormula.export_to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to print a final result of calculations in a JSON file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) -- filename string (should end with .json)</p></li>
<li><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision (4 digits by default)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-chemsynthcalc.chemical_reaction">
<span id="chemsynthcalc-chemical-reaction-module"></span><h2>chemsynthcalc.chemical_reaction module<a class="headerlink" href="#module-chemsynthcalc.chemical_reaction" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chemical_reaction.</span></span><span class="sig-name descname"><span class="pre">ChemicalReaction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reaction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'balance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">try_comb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that represents a chemical reaction and do operations on it.</p>
<p>There are three calculation modes:</p>
<p>1. The &quot;force&quot; mode is used when a user enters coefficients
in the reaction string and wants the masses to be calculated
whether the reaction is balanced or not.</p>
<p>2. &quot;check&quot; mode is the same as force, but with reaction
balance checks.</p>
<p>3. &quot;balance&quot; mode  tries to automatically calculate
coefficients from the reaction string.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Unlike other properties of this class, the <a class="reference internal" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.coefficients" title="chemsynthcalc.chemical_reaction.ChemicalReaction.coefficients"><code class="xref py py-attr docutils literal notranslate"><span class="pre">chemsynthcalc.chemical_reaction.ChemicalReaction.coefficients</span></code></a>
property can be set directly.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reaction</strong> (<em>str</em>) -- a reaction string</p></li>
<li><p><strong>target</strong> (<em>int</em>) -- index of target compound (0 by default, or first compound in the products)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) -- coefficients calculation mode</p></li>
<li><p><strong>target_mass</strong> (<em>float</em>) -- desired mass of target compound (in grams)</p></li>
<li><p><strong>rounding_order</strong> (<em>int</em>) -- value of rounding precision (8 by default)</p></li>
<li><p><strong>try_comb</strong> (<em>bool</em>) -- flag, which determines whether an attempt will be made to equalize the reaction using the combinatorial method in the &quot;balance&quot; mode</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.allowed_symbols">
<span class="sig-name descname"><span class="pre">allowed_symbols</span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.allowed_symbols" title="Permalink to this definition">¶</a></dt>
<dd><p>characters that allowed in the reaction string</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.possible_reaction_separators">
<span class="sig-name descname"><span class="pre">possible_reaction_separators</span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.possible_reaction_separators" title="Permalink to this definition">¶</a></dt>
<dd><p>list of characters that can be used as reactants-products separator</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.reactant_separator">
<span class="sig-name descname"><span class="pre">reactant_separator</span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.reactant_separator" title="Permalink to this definition">¶</a></dt>
<dd><p>character that can be used as compounds separator</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.types_of_modes">
<span class="sig-name descname"><span class="pre">types_of_modes</span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.types_of_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>allowed types of calculation modes</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.algorithm">
<span class="sig-name descname"><span class="pre">algorithm</span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>currently used calculation algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> -- if rounding order &lt;=0</p></li>
<li><p><a class="reference internal" href="#chemsynthcalc.chem_errors.NoSuchMode" title="chemsynthcalc.chem_errors.NoSuchMode"><strong>NoSuchMode</strong></a> -- if <cite>mode</cite> is not in <cite>types_of_modes</cite></p></li>
<li><p><strong>ValueError</strong> -- if <cite>target</cite> is out of bounds of product list</p></li>
<li><p><strong>ValueError</strong> -- if <cite>target</cite> &lt; 0</p></li>
<li><p><strong>ValueError</strong> -- if <cite>target_mass</cite> &lt;=0</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;H2+O2=H2O&quot;</span><span class="p">)</span>
<span class="go">H2+O2=H2O</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;2H2+O2=2H2O&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;balance&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">coefficients</span>
<span class="go">[2, 1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;2H2+O2=2H2O&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;check&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">masses</span>
<span class="go">[0.11190674, 0.88809326, 1.0]</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.reaction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reaction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.reaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial reaction</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Initial reaction string with validity check.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> -- if the reaction string is empty</p></li>
<li><p><a class="reference internal" href="#chemsynthcalc.chem_errors.InvalidCharacter" title="chemsynthcalc.chem_errors.InvalidCharacter"><strong>InvalidCharacter</strong></a> -- if some of characters in the string are invalid</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reaction</span>
<span class="go">KMnO4+HCl=MnCl2+Cl2+H2O+KCl</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.separator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">separator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.separator" title="Permalink to this definition">¶</a></dt>
<dd><p>Reactants-product separator.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Separator between reactants and products of chemical reaction.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#chemsynthcalc.chem_errors.NoSeparator" title="chemsynthcalc.chem_errors.NoSeparator"><strong>NoSeparator</strong></a> -- if no separator was found in the reaction string</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">separator</span>
<span class="go">=</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.reactants">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reactants</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.reactants" title="Permalink to this definition">¶</a></dt>
<dd><p>List of initially split reactants (left side of the reaction string).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Formulas on the left side are split by reactant_separator (+)
and include initial coefficients (in case of force or check modes).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reactants</span>
<span class="go">[&#39;KMnO4&#39;, &#39;HCl&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.products">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">products</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.products" title="Permalink to this definition">¶</a></dt>
<dd><p>List of initially split products (right side of the reaction string).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Formulas on the right side that have been split by reactant_separator
(+) and include initial coefficients (in case of force or check modes).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">products</span>
<span class="go">[&#39;MnCl2&#39;, &#39;Cl2&#39;, &#39;H2O&#39;, &#39;KCl&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.compounds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.compounds" title="Permalink to this definition">¶</a></dt>
<dd><p>List of all initially split products (left side and right side).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Sum of <cite>reactants</cite> and <cite>products</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">compounds</span>
<span class="go">[&#39;KMnO4&#39;, &#39;HCl&#39;, &#39;MnCl2&#39;, &#39;Cl2&#39;, &#39;H2O&#39;, &#39;KCl&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.initial_coefficients">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initial_coefficients</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.initial_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial coefficients</p>
<p>The coefficients are not equal to 1 in case if
they have been entered (generally the case for
force and check modes).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of initial coefficients striped from the compounds.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">initial_coefficients</span>
<span class="go">[1.0, 1.0, 1.0, 1.0, 1.0, 1.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.formulas">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">formulas</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.formulas" title="Permalink to this definition">¶</a></dt>
<dd><p>Decomposition of a list of formulas from the reaction string.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Every formula is striped from coefficient and become
the <a class="reference internal" href="#chemsynthcalc.chemical_formula.ChemicalFormula" title="chemsynthcalc.chemical_formula.ChemicalFormula"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.chemical_formula.ChemicalFormula</span></code></a> object.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">formulas</span>
<span class="go">[KMnO4, HCl, MnCl2, Cl2, H2O, KCl]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.parsed_formulas">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parsed_formulas</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.parsed_formulas" title="Permalink to this definition">¶</a></dt>
<dd><p>List of parsed formulas of <a class="reference internal" href="#chemsynthcalc.chemical_formula.ChemicalFormula" title="chemsynthcalc.chemical_formula.ChemicalFormula"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.chemical_formula.ChemicalFormula</span></code></a> objects list.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parsed_formulas</span>
<span class="go">[{&#39;K&#39;: 1.0, &#39;Mn&#39;: 1.0, &#39;O&#39;: 4.0}, {&#39;H&#39;: 1.0, &#39;Cl&#39;: 1.0}, {&#39;Mn&#39;: 1.0, &#39;Cl&#39;: 2.0}, {&#39;Cl&#39;: 2.0}, {&#39;H&#39;: 2.0, &#39;O&#39;: 1.0}, {&#39;K&#39;: 1.0, &#39;Cl&#39;: 1.0}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.matrix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.array</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Chemical reaction matrix.</p>
<p>The first implementation of reaction matrix method is probably
belongs to <a class="reference external" href="https://doi.org/10.1021/ed059p728">Blakley</a>. In general,
a chemical reaction matrix is composed of the coefficients of each
atom in each compound, giving a 2D array. The matrix composes
naturally from previously parsed formulas.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>2D array of each atom amount in each formula</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span>
<span class="go">[[1. 0. 0. 0. 0. 1.]  (K)</span>
<span class="go"> [1. 0. 1. 0. 0. 0.]  (Mn)</span>
<span class="go"> [4. 0. 0. 0. 1. 0.]  (O)</span>
<span class="go"> [0. 1. 0. 0. 2. 0.]  (H)</span>
<span class="go"> [0. 1. 2. 2. 0. 1.]] (Cl)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.reactant_matrix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reactant_matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.array</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.reactant_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Left half of the reaction matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>2D array of each atom amount in each reactant</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reactant_matrix</span>
<span class="go">[[1. 0.]  (K)</span>
<span class="go"> [1. 0.]  (Mn)</span>
<span class="go"> [4. 0.]  (O)</span>
<span class="go"> [0. 1.]  (H)</span>
<span class="go"> [0. 1.]] (Cl)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.product_matrix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">product_matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.array</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.product_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Right half of the reaction matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>2D array of each atom amount in each product</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">product_matrix</span>
<span class="go">[[0. 0. 0. 1.]  (K)</span>
<span class="go"> [1. 0. 0. 0.]  (Mn)</span>
<span class="go"> [0. 0. 1. 0.]  (O)</span>
<span class="go"> [0. 0. 2. 0.]  (H)</span>
<span class="go"> [2. 2. 0. 1.]] (Cl)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.molar_masses">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">molar_masses</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.molar_masses" title="Permalink to this definition">¶</a></dt>
<dd><p>List of molar masses (in g/mol)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of molar masses of each compound in <cite>compounds</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">molar_masses</span>
<span class="go">[158.032, 36.458, 125.838, 70.9, 18.015, 74.548]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.coefficients">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">coefficients</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficients of the chemical reaction.</p>
<p>There are 3 possible modes that the method can run:</p>
<p>1) force mode is when coefficients are entered by user in reaction
string and the calculation and the calculation takes place regardless
of reaction balance (it gives warning if reaction is not balanced);</p>
<p>2) check mode is basically the force mode but it will raise an
error if reaction is not balanced and will not calculate masses);</p>
<p>3) balance mode uses one of three auto-balancing aglorithms described
in detail in the <a class="reference internal" href="#chemsynthcalc.reaction_balance.Balancer" title="chemsynthcalc.reaction_balance.Balancer"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.reaction_balance.Balancer</span></code></a> class.</p>
<p>In the fisrt two cases, the coefficients are just stripped from original
formulas entered by user. In case of balance mode, coefficients are
calculated.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Unlike other properties of this class, this
property can be set directly.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#chemsynthcalc.chem_errors.ReactionNotBalanced" title="chemsynthcalc.chem_errors.ReactionNotBalanced"><strong>ReactionNotBalanced</strong></a> -- if reaction is not balanced in &quot;check&quot; mode.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of reaction coefficients
None: if it cannot balance the reaction</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;balance&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">coefficients</span>
<span class="go">[2, 16, 2, 5, 8, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;check&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients</span>
<span class="go">[2, 16, 2, 5, 8, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;2H2+2O2=H2O&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;force&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">coefficients</span>
<span class="go">[2, 2, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.normalized_coefficients">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">normalized_coefficients</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.normalized_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>List of coefficients normalized on target compound.</p>
<p>target coefficient = 1.0</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Normalized coefficients.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">normalized_coefficients</span>
<span class="go">[1, 8, 1, 2.5, 4, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.is_balanced">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_balanced</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.is_balanced" title="Permalink to this definition">¶</a></dt>
<dd><p>Is the reaction balanced?</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if the reaction is balanced with current coefficients</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.final_reaction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">final_reaction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.final_reaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Final representation of the reaction with coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>string of the final reaction</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">final_reaction</span>
<span class="go">&quot;2KMnO4+16HCl=2MnCl2+5Cl2+8H2O+2KCl&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.final_reaction_normalized">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">final_reaction_normalized</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.final_reaction_normalized" title="Permalink to this definition">¶</a></dt>
<dd><p>Final representation of the reaction with normalized coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>String of the final normalized reaction</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">final_reaction_normalized</span>
<span class="go">&quot;KMnO4+8HCl=MnCl2+2.5Cl2+4H2O+KCl&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.masses">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">masses</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.masses" title="Permalink to this definition">¶</a></dt>
<dd><p>List of masses of compounds (in grams).</p>
<p>List of masses of the of formulas in reaction
calculated with coefficients obtained by any of the 3 methods.
Calculates masses by calculating amount of substance nu (nu=mass/molar mass).
Coefficients of reaction are normalized to the target. After nu of target compound is
calculated, it broadcasted to other compound (with respect to their coefficients).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of masses of compound</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">masses</span>
<span class="go">[1.25583687, 2.31777365, 1.0, 1.40855703, 0.57264101, 0.59241247]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">,</span> <span class="n">target_mass</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span><span class="o">.</span><span class="n">masses</span>
<span class="go">[2.51167374, 4.63554729, 2.0, 2.81711407, 1.14528203, 1.18482493]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.output_results">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_results</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.output_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Collection of every output of calculated chemical reaction properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>All outputs collected in one dictionary.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">output_results</span>
<span class="go">{&#39;initial reaction&#39;: &#39;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&#39;,</span>
<span class="go">&#39;reaction matrix&#39;: array([[1., 0., 0., 0., 0., 1.],</span>
<span class="go">[1., 0., 1., 0., 0., 0.],</span>
<span class="go">[4., 0., 0., 0., 1., 0.],</span>
<span class="go">[0., 1., 0., 0., 2., 0.],</span>
<span class="go">[0., 1., 2., 2., 0., 1.]]),</span>
<span class="go">&#39;mode&#39;: &#39;balance&#39;,</span>
<span class="go">&#39;formulas&#39;: [KMnO4, HCl, MnCl2, Cl2, H2O, KCl],</span>
<span class="go">&#39;coefficients&#39;: [2, 16, 2, 5, 8, 2],</span>
<span class="go">&#39;normalized coefficients&#39;: [1, 8, 1, 2.5, 4, 1],</span>
<span class="go">&#39;algorithm&#39;: &#39;inverse&#39;,</span>
<span class="go">&#39;is balanced&#39;: True,</span>
<span class="go">&#39;final reaction&#39;: &#39;2KMnO4+16HCl=2MnCl2+5Cl2+8H2O+2KCl&#39;,</span>
<span class="go">&#39;final reaction normalized&#39;: &#39;KMnO4+8HCl=MnCl2+2.5Cl2+4H2O+KCl&#39;,</span>
<span class="go">&#39;molar masses&#39;: [158.032, 36.458, 125.838, 70.9, 18.015, 74.548],</span>
<span class="go">&#39;target&#39;: MnCl2,</span>
<span class="go">&#39;masses&#39;: [1.25583687, 2.31777365, 1.0, 1.40855703, 0.57264101, 0.59241247]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.coefficients_check">
<span class="sig-name descname"><span class="pre">coefficients_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coefficients</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.coefficients_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Checking the coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coefficients</strong> (<em>list</em>) -- list of coefficients</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#chemsynthcalc.chem_errors.BadCoeffiecients" title="chemsynthcalc.chem_errors.BadCoeffiecients"><strong>BadCoeffiecients</strong></a> -- If Coefficients are None</p></li>
<li><p><a class="reference internal" href="#chemsynthcalc.chem_errors.BadCoeffiecients" title="chemsynthcalc.chem_errors.BadCoeffiecients"><strong>BadCoeffiecients</strong></a> -- If 0 or -x in coefficients</p></li>
<li><p><a class="reference internal" href="#chemsynthcalc.chem_errors.BadCoeffiecients" title="chemsynthcalc.chem_errors.BadCoeffiecients"><strong>BadCoeffiecients</strong></a> -- If number of coefficients is not equal to number of columns in reaction matrix</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True, if coefficients are good.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients_check</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients_check</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span>
<span class="go">chemsynthcalc.chem_errors.BadCoeffiecients: number of coefficients should be equal to 6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients_check</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span>
<span class="go">chemsynthcalc.chem_errors.BadCoeffiecients: Coefficients are None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients_check</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span>
<span class="go">chemsynthcalc.chem_errors.BadCoeffiecients: 0 or -x in coefficients</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.check_elements_count">
<span class="sig-name descname"><span class="pre">check_elements_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">set</span></span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.check_elements_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if all elements are present in both sides of the reaction.</p>
<p>Does not work in the <cite>force</cite> mode!</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Set of atom differences on the left and right sides of the reaction.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>set</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">check_elements_count</span><span class="p">()</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnHoO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">check_elements_count</span><span class="p">()</span>
<span class="go">chemsynthcalc.chem_errors.ReactantProductDifference: Cannot balance this</span>
<span class="go">reaction, because element(s) {&#39;Ho&#39;} are only in one part of the reaction</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.to_integer">
<span class="sig-name descname"><span class="pre">to_integer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coefficients</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.to_integer" title="Permalink to this definition">¶</a></dt>
<dd><p>Cast a float to integer in a list if it is integer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coefficients</strong> (<em>list</em>) -- list of coefficients</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of intified coefficients.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_integer</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="go">[1, 8, 1, 2.5, 4, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.balance_reaction">
<span class="sig-name descname"><span class="pre">balance_reaction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'inv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intify</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_comb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000000.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.balance_reaction" title="Permalink to this definition">¶</a></dt>
<dd><p>High-level function call for all balancing algorithms.</p>
<p>Options availiable are:
1) <cite>&quot;inv&quot;</cite> - matrix inverse Thorne algorithm
2) <cite>&quot;gpinv&quot;</cite> - general pseudoinverse Risteski algorithm
3) <cite>&quot;ppinv&quot;</cite> - partial pseudoinverse Risteski algorithm
4) <cite>&quot;comb&quot;</cite> - combinatorial algorithm</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>&quot;comb&quot; algorithm works only for integer coefficients
less than 127 (see <cite>Balancer.comb_algorithm</cite> for details).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>algorithm</strong> (<em>str</em>) -- </p></li>
<li><p><strong>intify</strong> (<em>bool</em>) -- </p></li>
<li><p><strong>max_comb</strong> (<em>int</em>) -- </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of obtained coefficients.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">balance_reaction</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;inv&quot;</span><span class="p">,</span> <span class="n">intify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[2, 16, 2, 5, 8, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">balance_reaction</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;gpinv&quot;</span><span class="p">,</span> <span class="n">intify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[0.19607843137254966, 1.568627450980392, 0.1960784313725499, 0.49019607843137436, 0.7843137254901958, 0.19607843137254813]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.generate_final_reaction">
<span class="sig-name descname"><span class="pre">generate_final_reaction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coefs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.generate_final_reaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Final reaction string with connotated formulas and calculated coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coefs</strong> (<em>list</em>) -- list of coefficients</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>String of the final reaction</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">generate_final_reaction</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">&quot;2KMnO4+16HCl=2MnCl2+5Cl2+8H2O+2KCl&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.print_results">
<span class="sig-name descname"><span class="pre">print_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.print_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to print a final result of calculations in terminal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision (4 digits by default)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.export_to_txt">
<span class="sig-name descname"><span class="pre">export_to_txt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.export_to_txt" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to print a final result of calculations in txt file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) -- filename string (should end with .txt)</p></li>
<li><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision (4 digits by default)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.as_json">
<span class="sig-name descname"><span class="pre">as_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.as_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialization of output into JSON object.</p>
<dl class="simple">
<dt>Argruments:</dt><dd><p>print_rounding_order (int): print precision (4 digits by default).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>JSON object of the output results.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.chemical_reaction.ChemicalReaction.export_to_json">
<span class="sig-name descname"><span class="pre">export_to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.chemical_reaction.ChemicalReaction.export_to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to print a final result of calculations in JSON file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) -- filename string (should end with .json)</p></li>
<li><p><strong>print_rounding_order</strong> (<em>int</em>) -- print precision (4 digits by default)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-chemsynthcalc.chemutils">
<span id="chemsynthcalc-chemutils-module"></span><h2>chemsynthcalc.chemutils module<a class="headerlink" href="#module-chemsynthcalc.chemutils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="chemsynthcalc.chemutils.arguments_type_checking">
<span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chemutils.</span></span><span class="sig-name descname"><span class="pre">arguments_type_checking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argument</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.chemutils.arguments_type_checking" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks for type of function argument.</p>
<dl class="simple">
<dt>Argments:</dt><dd><p>argument (Any): Argument of the function in question
types (Any): Types that allowed for this argument</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>TypeError</strong> -- if agrument type is not one of specified types</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemsynthcalc.chemutils.find_lcm">
<span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chemutils.</span></span><span class="sig-name descname"><span class="pre">find_lcm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">int_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chemsynthcalc.chemutils.find_lcm" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds least common multiple of the list of integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>int_list</strong> (<em>list</em>) -- list of integers</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Least common multiple</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chemsynthcalc</span><span class="o">.</span><span class="n">chemutils</span><span class="o">.</span><span class="n">find_lcm</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">]</span>
<span class="go">60</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemsynthcalc.chemutils.find_gcd">
<span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chemutils.</span></span><span class="sig-name descname"><span class="pre">find_gcd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">int_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chemsynthcalc.chemutils.find_gcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the greatest common divider of the list of integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>int_list</strong> (<em>list</em>) -- list of integers</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>greatest common divider</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chemsynthcalc</span><span class="o">.</span><span class="n">chemutils</span><span class="o">.</span><span class="n">find_gcd</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">]</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemsynthcalc.chemutils.stripe_formula_from_coefficients">
<span class="sig-prename descclassname"><span class="pre">chemsynthcalc.chemutils.</span></span><span class="sig-name descname"><span class="pre">stripe_formula_from_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#chemsynthcalc.chemutils.stripe_formula_from_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to stripe the initially parsed formulas from chemical reaction string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>formula</strong> (<em>str</em>) -- a formula string</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(float, str) tuple of (coefficient, reaction)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chemsynthcalc</span><span class="o">.</span><span class="n">chemutils</span><span class="o">.</span><span class="n">stripe_formula_from_coefficients</span><span class="p">(</span><span class="s2">&quot;4.3H3PO4&quot;</span><span class="p">)</span>
<span class="go">(4.3, &#39;H3PO4&#39;)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-chemsynthcalc.formula_parser">
<span id="chemsynthcalc-formula-parser-module"></span><h2>chemsynthcalc.formula_parser module<a class="headerlink" href="#module-chemsynthcalc.formula_parser" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="chemsynthcalc.formula_parser.ChemicalFormulaParser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.formula_parser.</span></span><span class="sig-name descname"><span class="pre">ChemicalFormulaParser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Parser of chemical formulas.</p>
<p>Methods of this class take string of compound chemical formula
and turn it into a dict of atoms as keys and their coefficients as values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>formula</strong> (<em>str</em>) -- formula string</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.formula_parser.ChemicalFormulaParser.atom_regex">
<span class="sig-name descname"><span class="pre">atom_regex</span></span><a class="headerlink" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.atom_regex" title="Permalink to this definition">¶</a></dt>
<dd><p>regular expression for finding atoms in formula</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.formula_parser.ChemicalFormulaParser.coefficient_regex">
<span class="sig-name descname"><span class="pre">coefficient_regex</span></span><a class="headerlink" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.coefficient_regex" title="Permalink to this definition">¶</a></dt>
<dd><p>regular expression for atoms amounts in formula</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.formula_parser.ChemicalFormulaParser.atom_and_coefficient_regex">
<span class="sig-name descname"><span class="pre">atom_and_coefficient_regex</span></span><a class="headerlink" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.atom_and_coefficient_regex" title="Permalink to this definition">¶</a></dt>
<dd><p>atom_regex+coefficient_regex</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.formula_parser.ChemicalFormulaParser.opener_brackets">
<span class="sig-name descname"><span class="pre">opener_brackets</span></span><a class="headerlink" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.opener_brackets" title="Permalink to this definition">¶</a></dt>
<dd><p>opener brackets variations</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.formula_parser.ChemicalFormulaParser.closer_brackets">
<span class="sig-name descname"><span class="pre">closer_brackets</span></span><a class="headerlink" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.closer_brackets" title="Permalink to this definition">¶</a></dt>
<dd><p>closer brackets variations</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.formula_parser.ChemicalFormulaParser.adduct_symbols">
<span class="sig-name descname"><span class="pre">adduct_symbols</span></span><a class="headerlink" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.adduct_symbols" title="Permalink to this definition">¶</a></dt>
<dd><p>symbols for adduct notation (water of crystallization most often)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.formula_parser.ChemicalFormulaParser.allowed_symbols">
<span class="sig-name descname"><span class="pre">allowed_symbols</span></span><a class="headerlink" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.allowed_symbols" title="Permalink to this definition">¶</a></dt>
<dd><p>regular expression for all symbols allowed in the formula string</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.formula_parser.ChemicalFormulaParser.list_of_atoms">
<span class="sig-name descname"><span class="pre">list_of_atoms</span></span><a class="headerlink" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.list_of_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>list of all atoms in the periodic table</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.formula_parser.ChemicalFormulaParser.are_brackets_balanced">
<span class="sig-name descname"><span class="pre">are_brackets_balanced</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.are_brackets_balanced" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if all kinds of brackets come in pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if all brackets are in pairs</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormulaParser</span><span class="p">(</span><span class="s2">&quot;(K2SO4)*H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">are_brackets_balanced</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormulaParser</span><span class="p">(</span><span class="s2">&quot;(K2SO4)*H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">are_brackets_balanced</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.formula_parser.ChemicalFormulaParser.is_adduct_one">
<span class="sig-name descname"><span class="pre">is_adduct_one</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.is_adduct_one" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if there is only one adduct in formula</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if there is only one adduct symbol</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormulaParser</span><span class="p">(</span><span class="s2">&quot;K2SO4*H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_adduct_one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormulaParser</span><span class="p">(</span><span class="s2">&quot;K2SO4*H2O*CO2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_adduct_one</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.formula_parser.ChemicalFormulaParser.are_atoms_legal">
<span class="sig-name descname"><span class="pre">are_atoms_legal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.are_atoms_legal" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if all parsed atoms belong to the periodic table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed</strong> (<em>dict</em>) -- dictionary of parsed atoms</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#chemsynthcalc.chem_errors.NoSuchAtom" title="chemsynthcalc.chem_errors.NoSuchAtom"><strong>NoSuchAtom</strong></a> -- if one of the parsed atoms are not in the periodic table</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormulaParser</span><span class="p">(</span><span class="s2">&quot;K2SO4*H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">are_atoms_legal</span><span class="p">({</span><span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">})</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormulaParser</span><span class="p">(</span><span class="s2">&quot;KHuSO4*H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">are_atoms_legal</span><span class="p">({</span><span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Hu&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">})</span>
<span class="go">chemsynthcalc.chem_errors.NoSuchAtom: No atom Hu in the periodic table!</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.formula_parser.ChemicalFormulaParser.parse_formula">
<span class="sig-name descname"><span class="pre">parse_formula</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser.parse_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the formula and return a dict with occurrences of each atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="#chemsynthcalc.chem_errors.InvalidCharacter" title="chemsynthcalc.chem_errors.InvalidCharacter"><strong>InvalidCharacter</strong></a> -- if some characters in initial string is not in <cite>allowed_characters</cite></p></li>
<li><p><a class="reference internal" href="#chemsynthcalc.chem_errors.MoreThanOneAdduct" title="chemsynthcalc.chem_errors.MoreThanOneAdduct"><strong>MoreThanOneAdduct</strong></a> -- if there is more than one adduct symbol (i.e. <a href="#id1"><span class="problematic" id="id2">*</span></a>)</p></li>
<li><p><a class="reference internal" href="#chemsynthcalc.chem_errors.BracketsNotPaired" title="chemsynthcalc.chem_errors.BracketsNotPaired"><strong>BracketsNotPaired</strong></a> -- if some bracket type is not coming in pairs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary of parsed atoms</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormulaParser</span><span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parse_formula</span><span class="p">()</span>
<span class="go">{&#39;H&#39;: 2.0, &#39;O&#39;: 1.0}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormulaParser</span><span class="p">(</span><span class="s2">&quot;C2H5OH&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parse_formula</span><span class="p">()</span>
<span class="go">{&#39;C&#39;: 2.0, &#39;H&#39;: 6.0, &#39;O&#39;: 1.0}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalFormulaParser</span><span class="p">(</span><span class="s2">&quot;(K0.6Na0.4)2SO4*7H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parse_formula</span><span class="p">()</span>
<span class="go">{&#39;K&#39;: 1.2, &#39;Na&#39;: 0.8, &#39;S&#39;: 1.0, &#39;O&#39;: 11.0, &#39;H&#39;: 14.0}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-chemsynthcalc.molar_mass">
<span id="chemsynthcalc-molar-mass-module"></span><h2>chemsynthcalc.molar_mass module<a class="headerlink" href="#module-chemsynthcalc.molar_mass" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="chemsynthcalc.molar_mass.MolarMassCalculation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.molar_mass.</span></span><span class="sig-name descname"><span class="pre">MolarMassCalculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_formula</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemsynthcalc.molar_mass.MolarMassCalculation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for the calculation of molar masses and percentages of compounds.</p>
<p>Compounds should be parsed by <a class="reference internal" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser" title="chemsynthcalc.formula_parser.ChemicalFormulaParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.formula_parser.ChemicalFormulaParser</span></code></a> first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_formula</strong> (<em>dict</em>) -- formula parsed by <a class="reference internal" href="#chemsynthcalc.formula_parser.ChemicalFormulaParser" title="chemsynthcalc.formula_parser.ChemicalFormulaParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.formula_parser.ChemicalFormulaParser</span></code></a></p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.molar_mass.MolarMassCalculation.atomicWeight">
<span class="sig-name descname"><span class="pre">atomicWeight</span></span><a class="headerlink" href="#chemsynthcalc.molar_mass.MolarMassCalculation.atomicWeight" title="Permalink to this definition">¶</a></dt>
<dd><p>list of (atom, weight) tuple formed from <a class="reference internal" href="#module-chemsynthcalc.periodic_table" title="chemsynthcalc.periodic_table"><code class="xref py py-mod docutils literal notranslate"><span class="pre">chemsynthcalc.periodic_table</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.molar_mass.MolarMassCalculation.list_of_atoms">
<span class="sig-name descname"><span class="pre">list_of_atoms</span></span><a class="headerlink" href="#chemsynthcalc.molar_mass.MolarMassCalculation.list_of_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>list of atoms formed from <a class="reference internal" href="#module-chemsynthcalc.periodic_table" title="chemsynthcalc.periodic_table"><code class="xref py py-mod docutils literal notranslate"><span class="pre">chemsynthcalc.periodic_table</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.molar_mass.MolarMassCalculation.calculate_molar_mass">
<span class="sig-name descname"><span class="pre">calculate_molar_mass</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#chemsynthcalc.molar_mass.MolarMassCalculation.calculate_molar_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculation of the molar mass of compound from the atomic masses of atoms in a parsed formula.</p>
<p>Atomic masses are taken from <a class="reference internal" href="#module-chemsynthcalc.periodic_table" title="chemsynthcalc.periodic_table"><code class="xref py py-mod docutils literal notranslate"><span class="pre">chemsynthcalc.periodic_table</span></code></a> file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>molar mass (in g/mol)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_molar_mass</span><span class="p">()</span>
<span class="go">18.015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_molar_mass</span><span class="p">()</span>
<span class="go">46.069</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.molar_mass.MolarMassCalculation.calculate_mass_percent">
<span class="sig-name descname"><span class="pre">calculate_mass_percent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#chemsynthcalc.molar_mass.MolarMassCalculation.calculate_mass_percent" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculation of mass percents of atoms in parsed formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>mass percentages of atoms in formula</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_mass_percent</span><span class="p">()</span>
<span class="go">{&#39;H&#39;: 11.19067443796836, &#39;O&#39;: 88.80932556203163}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_mass_percent</span><span class="p">()</span>
<span class="go">{&#39;C&#39;: 52.14352384466777, &#39;H&#39;: 13.12813388612733, &#39;O&#39;: 34.72834226920489}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.molar_mass.MolarMassCalculation.calculate_atomic_percent">
<span class="sig-name descname"><span class="pre">calculate_atomic_percent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#chemsynthcalc.molar_mass.MolarMassCalculation.calculate_atomic_percent" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculation of atomic percents of atoms in the parsed formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>atomic percentages of atoms in formula</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_atomic_percent</span><span class="p">()</span>
<span class="go">{&#39;H&#39;: 66.66666666666666, &#39;O&#39;: 33.33333333333333</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_atomic_percent</span><span class="p">()</span>
<span class="go">{&#39;C&#39;: 22.22222222222222, &#39;H&#39;: 66.66666666666666, &#39;O&#39;: 11.11111111111111}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.molar_mass.MolarMassCalculation.calculate_oxide_percent">
<span class="sig-name descname"><span class="pre">calculate_oxide_percent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#chemsynthcalc.molar_mass.MolarMassCalculation.calculate_oxide_percent" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculation of oxide percents in parsed formula.</p>
<p>Calculation of oxide percents in parsed formula from the types of oxide
declared in the periodic table file. This type of data
is mostly used in XRF spectrometry and mineralogy. The oxide
percents are calculated by finding the convertion factor between element
and its respective oxide (<a class="reference external" href="https://www.geol.umd.edu/~piccoli/probe/molweight.html">https://www.geol.umd.edu/~piccoli/probe/molweight.html</a>)
and normalizing the total sum to 100%. One can change the oxide type
for certain elements in the <a class="reference internal" href="#module-chemsynthcalc.periodic_table" title="chemsynthcalc.periodic_table"><code class="xref py py-mod docutils literal notranslate"><span class="pre">chemsynthcalc.periodic_table</span></code></a> file. Theoretically, this function
should work for other types of binary compound (sulfides, fluorides etc.)
or even salts, however, modification of this function is required
(for instance, in case of binary compound, removing X atom
from the list of future compounds should have X as an argument of this function)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>oxide percentages of oxides in formula</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_oxide_percent</span><span class="p">()</span>
<span class="go">{&#39;CO2&#39;: 61.9570190690046, &#39;H2O&#39;: 38.04298093099541}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MolarMassCalculation</span><span class="p">({</span><span class="s1">&#39;Ba&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Ti&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span><span class="o">.</span><span class="n">calculate_oxide_percent</span><span class="p">()</span>
<span class="go">{&#39;BaO&#39;: 65.7516917244869, &#39;TiO2&#39;: 34.24830827551309}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-chemsynthcalc.periodic_table">
<span id="chemsynthcalc-periodic-table-module"></span><h2>chemsynthcalc.periodic_table module<a class="headerlink" href="#module-chemsynthcalc.periodic_table" title="Permalink to this headline">¶</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="chemsynthcalc.periodic_table.periodic_table">
<span class="sig-prename descclassname"><span class="pre">chemsynthcalc.periodic_table.</span></span><span class="sig-name descname"><span class="pre">periodic_table</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[('H',</span> <span class="pre">1.008,</span> <span class="pre">2.2,</span> <span class="pre">'H2O'),</span> <span class="pre">('He',</span> <span class="pre">4.0026,</span> <span class="pre">1.2,</span> <span class="pre">'He'),</span> <span class="pre">('Li',</span> <span class="pre">6.94,</span> <span class="pre">0.98,</span> <span class="pre">'Li2O'),</span> <span class="pre">('Be',</span> <span class="pre">9.0122,</span> <span class="pre">1.57,</span> <span class="pre">'BeO'),</span> <span class="pre">('B',</span> <span class="pre">10.81,</span> <span class="pre">2.04,</span> <span class="pre">'B2O3'),</span> <span class="pre">('C',</span> <span class="pre">12.011,</span> <span class="pre">2.55,</span> <span class="pre">'CO2'),</span> <span class="pre">('N',</span> <span class="pre">14.007,</span> <span class="pre">3.04,</span> <span class="pre">'NO2'),</span> <span class="pre">('O',</span> <span class="pre">15.999,</span> <span class="pre">3.44,</span> <span class="pre">'O'),</span> <span class="pre">('F',</span> <span class="pre">18.998,</span> <span class="pre">3.98,</span> <span class="pre">'F2O'),</span> <span class="pre">('Ne',</span> <span class="pre">20.18,</span> <span class="pre">1.3,</span> <span class="pre">'Ne'),</span> <span class="pre">('Na',</span> <span class="pre">22.99,</span> <span class="pre">0.93,</span> <span class="pre">'Na2O'),</span> <span class="pre">('Mg',</span> <span class="pre">24.305,</span> <span class="pre">1.31,</span> <span class="pre">'MgO'),</span> <span class="pre">('Al',</span> <span class="pre">26.982,</span> <span class="pre">1.61,</span> <span class="pre">'Al2O3'),</span> <span class="pre">('Si',</span> <span class="pre">28.085,</span> <span class="pre">1.9,</span> <span class="pre">'SiO2'),</span> <span class="pre">('P',</span> <span class="pre">30.974,</span> <span class="pre">2.19,</span> <span class="pre">'P2O3'),</span> <span class="pre">('S',</span> <span class="pre">32.06,</span> <span class="pre">2.58,</span> <span class="pre">'SO3'),</span> <span class="pre">('Cl',</span> <span class="pre">35.45,</span> <span class="pre">3.16,</span> <span class="pre">'ClO2'),</span> <span class="pre">('Ar',</span> <span class="pre">39.95,</span> <span class="pre">2.2,</span> <span class="pre">'Ar'),</span> <span class="pre">('K',</span> <span class="pre">39.098,</span> <span class="pre">0.82,</span> <span class="pre">'K2O'),</span> <span class="pre">('Ca',</span> <span class="pre">40.078,</span> <span class="pre">1.0,</span> <span class="pre">'CaO'),</span> <span class="pre">('Sc',</span> <span class="pre">44.956,</span> <span class="pre">1.36,</span> <span class="pre">'Sc2O3'),</span> <span class="pre">('Ti',</span> <span class="pre">47.867,</span> <span class="pre">1.54,</span> <span class="pre">'TiO2'),</span> <span class="pre">('V',</span> <span class="pre">50.942,</span> <span class="pre">1.63,</span> <span class="pre">'V2O5'),</span> <span class="pre">('Cr',</span> <span class="pre">51.996,</span> <span class="pre">1.66,</span> <span class="pre">'Cr2O3'),</span> <span class="pre">('Mn',</span> <span class="pre">54.938,</span> <span class="pre">1.55,</span> <span class="pre">'MnO2'),</span> <span class="pre">('Fe',</span> <span class="pre">55.845,</span> <span class="pre">1.83,</span> <span class="pre">'Fe2O3'),</span> <span class="pre">('Co',</span> <span class="pre">58.933,</span> <span class="pre">1.88,</span> <span class="pre">'Co2O3'),</span> <span class="pre">('Ni',</span> <span class="pre">58.693,</span> <span class="pre">1.91,</span> <span class="pre">'NiO'),</span> <span class="pre">('Cu',</span> <span class="pre">63.546,</span> <span class="pre">1.9,</span> <span class="pre">'Cu2O'),</span> <span class="pre">('Zn',</span> <span class="pre">65.38,</span> <span class="pre">1.65,</span> <span class="pre">'ZnO'),</span> <span class="pre">('Ga',</span> <span class="pre">69.723,</span> <span class="pre">1.81,</span> <span class="pre">'Ga2O3'),</span> <span class="pre">('Ge',</span> <span class="pre">72.63,</span> <span class="pre">2.01,</span> <span class="pre">'GeO2'),</span> <span class="pre">('As',</span> <span class="pre">74.922,</span> <span class="pre">2.18,</span> <span class="pre">'As2O3'),</span> <span class="pre">('Se',</span> <span class="pre">78.971,</span> <span class="pre">2.55,</span> <span class="pre">'Se3O4'),</span> <span class="pre">('Br',</span> <span class="pre">79.904,</span> <span class="pre">2.96,</span> <span class="pre">'BrO2'),</span> <span class="pre">('Kr',</span> <span class="pre">83.798,</span> <span class="pre">3.0,</span> <span class="pre">'Kr'),</span> <span class="pre">('Rb',</span> <span class="pre">85.468,</span> <span class="pre">0.82,</span> <span class="pre">'Rb2O'),</span> <span class="pre">('Sr',</span> <span class="pre">87.62,</span> <span class="pre">0.95,</span> <span class="pre">'SrO'),</span> <span class="pre">('Y',</span> <span class="pre">88.906,</span> <span class="pre">1.22,</span> <span class="pre">'Y2O3'),</span> <span class="pre">('Zr',</span> <span class="pre">91.224,</span> <span class="pre">1.33,</span> <span class="pre">'ZrO2'),</span> <span class="pre">('Nb',</span> <span class="pre">92.906,</span> <span class="pre">1.6,</span> <span class="pre">'Nb2O5'),</span> <span class="pre">('Mo',</span> <span class="pre">95.95,</span> <span class="pre">2.16,</span> <span class="pre">'MoO3'),</span> <span class="pre">('Tc',</span> <span class="pre">98.906,</span> <span class="pre">1.9,</span> <span class="pre">'TcO2'),</span> <span class="pre">('Ru',</span> <span class="pre">101.07,</span> <span class="pre">2.2,</span> <span class="pre">'RuO2'),</span> <span class="pre">('Rh',</span> <span class="pre">102.91,</span> <span class="pre">2.28,</span> <span class="pre">'Rh2O3'),</span> <span class="pre">('Pd',</span> <span class="pre">106.42,</span> <span class="pre">2.2,</span> <span class="pre">'PdO'),</span> <span class="pre">('Ag',</span> <span class="pre">107.87,</span> <span class="pre">1.93,</span> <span class="pre">'Ag2O'),</span> <span class="pre">('Cd',</span> <span class="pre">112.41,</span> <span class="pre">1.69,</span> <span class="pre">'CdO'),</span> <span class="pre">('In',</span> <span class="pre">114.82,</span> <span class="pre">1.78,</span> <span class="pre">'In2O3'),</span> <span class="pre">('Sn',</span> <span class="pre">118.71,</span> <span class="pre">1.96,</span> <span class="pre">'SnO2'),</span> <span class="pre">('Sb',</span> <span class="pre">121.76,</span> <span class="pre">2.05,</span> <span class="pre">'Sb2O3'),</span> <span class="pre">('Te',</span> <span class="pre">127.6,</span> <span class="pre">2.1,</span> <span class="pre">'TeO3'),</span> <span class="pre">('I',</span> <span class="pre">126.9,</span> <span class="pre">2.66,</span> <span class="pre">'I2O5'),</span> <span class="pre">('Xe',</span> <span class="pre">131.29,</span> <span class="pre">2.6,</span> <span class="pre">'Xe'),</span> <span class="pre">('Cs',</span> <span class="pre">132.91,</span> <span class="pre">0.79,</span> <span class="pre">'Cs2O'),</span> <span class="pre">('Ba',</span> <span class="pre">137.33,</span> <span class="pre">0.89,</span> <span class="pre">'BaO'),</span> <span class="pre">('La',</span> <span class="pre">138.91,</span> <span class="pre">1.1,</span> <span class="pre">'La2O3'),</span> <span class="pre">('Ce',</span> <span class="pre">140.12,</span> <span class="pre">1.12,</span> <span class="pre">'CeO2'),</span> <span class="pre">('Pr',</span> <span class="pre">140.91,</span> <span class="pre">1.13,</span> <span class="pre">'Pr2O3'),</span> <span class="pre">('Nd',</span> <span class="pre">144.24,</span> <span class="pre">1.14,</span> <span class="pre">'Nd2O3'),</span> <span class="pre">('Pm',</span> <span class="pre">146.92,</span> <span class="pre">1.13,</span> <span class="pre">'Pm2O3'),</span> <span class="pre">('Sm',</span> <span class="pre">150.36,</span> <span class="pre">1.17,</span> <span class="pre">'Sm2O3'),</span> <span class="pre">('Eu',</span> <span class="pre">151.96,</span> <span class="pre">1.2,</span> <span class="pre">'Eu2O3'),</span> <span class="pre">('Gd',</span> <span class="pre">157.25,</span> <span class="pre">1.2,</span> <span class="pre">'Gd2O3'),</span> <span class="pre">('Tb',</span> <span class="pre">158.93,</span> <span class="pre">1.1,</span> <span class="pre">'Tb2O3'),</span> <span class="pre">('Dy',</span> <span class="pre">162.5,</span> <span class="pre">1.22,</span> <span class="pre">'Dy2O3'),</span> <span class="pre">('Ho',</span> <span class="pre">164.93,</span> <span class="pre">1.23,</span> <span class="pre">'Ho2O3'),</span> <span class="pre">('Er',</span> <span class="pre">167.26,</span> <span class="pre">1.24,</span> <span class="pre">'Er2O3'),</span> <span class="pre">('Tm',</span> <span class="pre">168.93,</span> <span class="pre">1.25,</span> <span class="pre">'Tm2O3'),</span> <span class="pre">('Yb',</span> <span class="pre">173.05,</span> <span class="pre">1.1,</span> <span class="pre">'Yb2O3'),</span> <span class="pre">('Lu',</span> <span class="pre">174.97,</span> <span class="pre">1.27,</span> <span class="pre">'Lu2O3'),</span> <span class="pre">('Hf',</span> <span class="pre">178.49,</span> <span class="pre">1.3,</span> <span class="pre">'HfO2'),</span> <span class="pre">('Ta',</span> <span class="pre">180.95,</span> <span class="pre">1.5,</span> <span class="pre">'Ta2O5'),</span> <span class="pre">('W',</span> <span class="pre">183.84,</span> <span class="pre">2.36,</span> <span class="pre">'WO3'),</span> <span class="pre">('Re',</span> <span class="pre">186.21,</span> <span class="pre">1.9,</span> <span class="pre">'Re2O7'),</span> <span class="pre">('Os',</span> <span class="pre">190.23,</span> <span class="pre">2.2,</span> <span class="pre">'OsO3'),</span> <span class="pre">('Ir',</span> <span class="pre">192.22,</span> <span class="pre">2.2,</span> <span class="pre">'Ir2O3'),</span> <span class="pre">('Pt',</span> <span class="pre">195.08,</span> <span class="pre">2.28,</span> <span class="pre">'PtO'),</span> <span class="pre">('Au',</span> <span class="pre">196.97,</span> <span class="pre">2.54,</span> <span class="pre">'Au2O3'),</span> <span class="pre">('Hg',</span> <span class="pre">200.59,</span> <span class="pre">2.0,</span> <span class="pre">'HgO2'),</span> <span class="pre">('Tl',</span> <span class="pre">204.38,</span> <span class="pre">1.62,</span> <span class="pre">'Tl2O'),</span> <span class="pre">('Pb',</span> <span class="pre">207.2,</span> <span class="pre">2.33,</span> <span class="pre">'PbO2'),</span> <span class="pre">('Bi',</span> <span class="pre">208.98,</span> <span class="pre">2.02,</span> <span class="pre">'Bi2O3'),</span> <span class="pre">('Po',</span> <span class="pre">208.98,</span> <span class="pre">2.0,</span> <span class="pre">'PoO2'),</span> <span class="pre">('At',</span> <span class="pre">209.99,</span> <span class="pre">2.2,</span> <span class="pre">'At2O'),</span> <span class="pre">('Rn',</span> <span class="pre">222.02,</span> <span class="pre">2.2,</span> <span class="pre">'Rn'),</span> <span class="pre">('Fr',</span> <span class="pre">223.02,</span> <span class="pre">0.79,</span> <span class="pre">'Fr2O'),</span> <span class="pre">('Ra',</span> <span class="pre">226.03,</span> <span class="pre">0.9,</span> <span class="pre">'RaO'),</span> <span class="pre">('Ac',</span> <span class="pre">227.03,</span> <span class="pre">1.1,</span> <span class="pre">'Ac2O3'),</span> <span class="pre">('Th',</span> <span class="pre">232.04,</span> <span class="pre">1.3,</span> <span class="pre">'ThO2'),</span> <span class="pre">('Pa',</span> <span class="pre">231.04,</span> <span class="pre">1.5,</span> <span class="pre">'Pa2O5'),</span> <span class="pre">('U',</span> <span class="pre">238.03,</span> <span class="pre">1.38,</span> <span class="pre">'UO2'),</span> <span class="pre">('Np',</span> <span class="pre">237.05,</span> <span class="pre">1.36,</span> <span class="pre">'NpO2'),</span> <span class="pre">('Pu',</span> <span class="pre">244.06,</span> <span class="pre">1.28,</span> <span class="pre">'PuO2'),</span> <span class="pre">('Am',</span> <span class="pre">243.06,</span> <span class="pre">1.13,</span> <span class="pre">'AmO2'),</span> <span class="pre">('Cm',</span> <span class="pre">247.07,</span> <span class="pre">1.28,</span> <span class="pre">'Cm2O3'),</span> <span class="pre">('Bk',</span> <span class="pre">247.07,</span> <span class="pre">1.3,</span> <span class="pre">'BkO2'),</span> <span class="pre">('Cf',</span> <span class="pre">251.08,</span> <span class="pre">1.3,</span> <span class="pre">'Cf2O3'),</span> <span class="pre">('Es',</span> <span class="pre">252.08,</span> <span class="pre">1.3,</span> <span class="pre">'Es2O3'),</span> <span class="pre">('Fm',</span> <span class="pre">257.1,</span> <span class="pre">1.3,</span> <span class="pre">'Fm2O3'),</span> <span class="pre">('Md',</span> <span class="pre">258.1,</span> <span class="pre">1.3,</span> <span class="pre">'Md2O3'),</span> <span class="pre">('No',</span> <span class="pre">259.1,</span> <span class="pre">1.3,</span> <span class="pre">'No2O3'),</span> <span class="pre">('Lr',</span> <span class="pre">262,</span> <span class="pre">1.3,</span> <span class="pre">'Lr2O3'),</span> <span class="pre">('Rf',</span> <span class="pre">267,</span> <span class="pre">1.3,</span> <span class="pre">'RfO2'),</span> <span class="pre">('Db',</span> <span class="pre">268,</span> <span class="pre">1.3,</span> <span class="pre">'Db2O5'),</span> <span class="pre">('Hs',</span> <span class="pre">269,</span> <span class="pre">1.3,</span> <span class="pre">'SgO3'),</span> <span class="pre">('Bh',</span> <span class="pre">270,</span> <span class="pre">1.3,</span> <span class="pre">'Bh2O7'),</span> <span class="pre">('Sg',</span> <span class="pre">271,</span> <span class="pre">1.3,</span> <span class="pre">'HsO4'),</span> <span class="pre">('Mt',</span> <span class="pre">278,</span> <span class="pre">1.3,</span> <span class="pre">'Mt2O3'),</span> <span class="pre">('Ds',</span> <span class="pre">281,</span> <span class="pre">1.3,</span> <span class="pre">'DsO2'),</span> <span class="pre">('Rg',</span> <span class="pre">281,</span> <span class="pre">1.3,</span> <span class="pre">'RgO'),</span> <span class="pre">('Nh',</span> <span class="pre">284,</span> <span class="pre">1.3,</span> <span class="pre">'CnO2'),</span> <span class="pre">('Cn',</span> <span class="pre">285,</span> <span class="pre">1.3,</span> <span class="pre">'Nh2O3'),</span> <span class="pre">('Fl',</span> <span class="pre">289,</span> <span class="pre">1.3,</span> <span class="pre">'FlO2'),</span> <span class="pre">('Mc',</span> <span class="pre">289,</span> <span class="pre">1.3,</span> <span class="pre">'Mc2O5'),</span> <span class="pre">('Lv',</span> <span class="pre">292,</span> <span class="pre">1.3,</span> <span class="pre">'LvO3'),</span> <span class="pre">('Ts',</span> <span class="pre">294,</span> <span class="pre">1.3,</span> <span class="pre">'Ts2O7'),</span> <span class="pre">('Og',</span> <span class="pre">294,</span> <span class="pre">1.3,</span> <span class="pre">'Og')]</span></em><a class="headerlink" href="#chemsynthcalc.periodic_table.periodic_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Periodic table of elements in the form of (element symbol, atomic weight, electronegativity, oxide formula).
The abridged standard atomic weights are taken from <a class="reference external" href="https://doi.org/10.1515/pac-2019-0603">https://doi.org/10.1515/pac-2019-0603</a>. The weights
of the radioactive elements are taken from <a class="reference external" href="https://iupac.qmul.ac.uk/AtWt/">https://iupac.qmul.ac.uk/AtWt/</a>. Pauling
electronegativities are taken from <a class="reference external" href="https://www.webelements.com/periodicity/eneg_pauling/">https://www.webelements.com/periodicity/eneg_pauling/</a>. Pauling
electronegativities for elements with unknown electronegativities (Bk-Og) are set to 1.3.</p>
</dd></dl>

</div>
<div class="section" id="module-chemsynthcalc.reaction_balance">
<span id="chemsynthcalc-reaction-balance-module"></span><h2>chemsynthcalc.reaction_balance module<a class="headerlink" href="#module-chemsynthcalc.reaction_balance" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.reaction_balance.</span></span><span class="sig-name descname"><span class="pre">Balancer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reactant_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">product_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rounding_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intify</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">try_comb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_comb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for  balancing chemical equations automatically by different matrix methods</p>
<p>Currently implemented: Thorne algorithm (see <a class="reference internal" href="#chemsynthcalc.reaction_balance.Balancer.inv_algorithm" title="chemsynthcalc.reaction_balance.Balancer.inv_algorithm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">inv_algorithm()</span></code></a> method for details),
Risteski general pseudo-inverse algorithm (see <a class="reference internal" href="#chemsynthcalc.reaction_balance.Balancer.gpinv_algorithm" title="chemsynthcalc.reaction_balance.Balancer.gpinv_algorithm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpinv_algorithm()</span></code></a> method for details),
Risteski partial pseudo-inverse algorithm (see <a class="reference internal" href="#chemsynthcalc.reaction_balance.Balancer.ppinv_algorithm" title="chemsynthcalc.reaction_balance.Balancer.ppinv_algorithm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ppinv_algorithm()</span></code></a> method for details),
and naive combinational search algorithm (see <a class="reference internal" href="#chemsynthcalc.reaction_balance.Balancer.comb_algorithm" title="chemsynthcalc.reaction_balance.Balancer.comb_algorithm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">comb_algorithm()</span></code></a> for details).
Class takes two matrices: matrix of reactants and matrix of products of chemical reaction, derived
from general reaction matrix. Matrices are in the form of NumPy 2D array.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Why use <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.pinv.html">scipy.linalg.pinv</a>,
when <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.pinv.html">numpy.linalg.pinv</a> is doing
the same thing and does not require the whole scipy import?</p>
<p>There are some peculiar reaction cases where (especially for <a class="reference internal" href="#chemsynthcalc.reaction_balance.Balancer.ppinv_algorithm" title="chemsynthcalc.reaction_balance.Balancer.ppinv_algorithm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ppinv_algorithm()</span></code></a> method) the results for
<cite>numpy.linalg.pinv</cite> differs from system to system (np version, OS, python version etc.). My understanding is that
the cause of this behaviour lies in small differences for pinv algorithm in numpy C-libraries and BLAS-libraries,
hence the difference. To avoid this, the more consistent <cite>scipy.linalg.pinv</cite> was method used.</p>
</div>
<dl>
<dt>Argumetns:</dt><dd><p>reactant_matrix (np.array): matrix of reactants property generated by <a class="reference internal" href="#chemsynthcalc.chemical_reaction.ChemicalReaction" title="chemsynthcalc.chemical_reaction.ChemicalReaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.chemical_reaction.ChemicalReaction</span></code></a> class</p>
<p>product_matrix (np.array): matrix of products property generated by <a class="reference internal" href="#chemsynthcalc.chemical_reaction.ChemicalReaction" title="chemsynthcalc.chemical_reaction.ChemicalReaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.chemical_reaction.ChemicalReaction</span></code></a> class</p>
<p>rounding_order (int): coefficients rounding precision</p>
<p>intify (bool): determines whether the coefficients should be integers</p>
<p>try_comb (bool): flag, which determines whether an attempt will be made to equalize the reaction using the combinatorial method</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.reaction_matrix">
<span class="sig-name descname"><span class="pre">reaction_matrix</span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.reaction_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>sum of reactant_matrix and product_matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.coef_limit">
<span class="sig-name descname"><span class="pre">coef_limit</span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.coef_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>max integer coefficient for <a class="reference internal" href="#chemsynthcalc.reaction_balance.Balancer.intify_coefficients" title="chemsynthcalc.reaction_balance.Balancer.intify_coefficients"><code class="xref py py-meth docutils literal notranslate"><span class="pre">intify_coefficients()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.calculate_coefficients_inv">
<span class="sig-name descname"><span class="pre">calculate_coefficients_inv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.calculate_coefficients_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>High-level function call to calculate coefficients using inverse Thorne algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of calculated coefficients
None: if cannot calculate</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">calculate_coefficients_inv</span><span class="p">()</span>
<span class="go">[2, 16, 2, 5, 8, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.calculate_coefficients_gpinv">
<span class="sig-name descname"><span class="pre">calculate_coefficients_gpinv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.calculate_coefficients_gpinv" title="Permalink to this definition">¶</a></dt>
<dd><p>High-level function call to calculate coefficients using general Risteski algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of calculated coefficients
None: if cannot calculate</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">calculate_coefficients_gpinv</span><span class="p">()</span>
<span class="go">[2, 16, 2, 5, 8, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.calculate_coefficients_ppinv">
<span class="sig-name descname"><span class="pre">calculate_coefficients_ppinv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.calculate_coefficients_ppinv" title="Permalink to this definition">¶</a></dt>
<dd><p>High-level function call to calculate coefficientsusing partial Risteski algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of calculated coefficients
None: if cannot calculate</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">calculate_coefficients_ppinv</span><span class="p">()</span>
<span class="go">[2, 16, 2, 5, 8, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.calculate_coefficients_comb">
<span class="sig-name descname"><span class="pre">calculate_coefficients_comb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.calculate_coefficients_comb" title="Permalink to this definition">¶</a></dt>
<dd><p>High-level function call to calculate coefficients using a combinatorial algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of calculated coefficients
None: if cannot calculate</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">calculate_coefficients_comb</span><span class="p">()</span>
<span class="go">[2, 16, 2, 5, 8, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.calculate_coefficients_auto">
<span class="sig-name descname"><span class="pre">calculate_coefficients_auto</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.calculate_coefficients_auto" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically balance the chemical reaction.</p>
<p>A method that tries to automatically balance the chemical reaction.
by sequentially applying the three calculation methods to the reaction matrix:
a Thorne algorithm <a class="reference internal" href="#chemsynthcalc.reaction_balance.Balancer.inv_algorithm" title="chemsynthcalc.reaction_balance.Balancer.inv_algorithm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">inv_algorithm()</span></code></a>, two Risteski algorithms
<a class="reference internal" href="#chemsynthcalc.reaction_balance.Balancer.ppinv_algorithm" title="chemsynthcalc.reaction_balance.Balancer.ppinv_algorithm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ppinv_algorithm()</span></code></a> and <a class="reference internal" href="#chemsynthcalc.reaction_balance.Balancer.gpinv_algorithm" title="chemsynthcalc.reaction_balance.Balancer.gpinv_algorithm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpinv_algorithm()</span></code></a> and, if try_comb flag == True,
a combinatorial algorithm <a class="reference internal" href="#chemsynthcalc.reaction_balance.Balancer.comb_algorithm" title="chemsynthcalc.reaction_balance.Balancer.comb_algorithm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">comb_algorithm()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of calculated coefficients and str of algorithm used
None: if cannot calculate</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+HCl=MnCl2+Cl2+H2O+KCl&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">calculate_coefficients_auto</span><span class="p">()</span>
<span class="go">([2, 16, 2, 5, 8, 2], &#39;inverse&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;H2O2+KNO3+H2SO4=K2SO4+NO+H2O+O2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">calculate_coefficients_auto</span><span class="p">()</span>
<span class="go">([73, 118, 59, 59, 118, 132, 125], &#39;general pseudoinverse&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;NH4ClO4+HNO3+HCl=HClO4+NOCl+N2O+N2O3+H2O+Cl2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">calculate_coefficients_auto</span><span class="p">()</span>
<span class="go">([64, 167, 137, 80, 43, 64, 30, 240, 39], &#39;general pseudoinverse&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.is_reaction_balanced">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_reaction_balanced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reactant_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">product_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficients</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.is_reaction_balanced" title="Permalink to this definition">¶</a></dt>
<dd><p>Is reaction balanced with specified coefficients.</p>
<p>Checks if reaction is balanced by multiplying reactant matrix and product matrix
by the respective coefficient vector. Method is static to call it outside of balancer
instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reactant_matrix</strong> (<em>np.array</em>) -- matrix of reactants property generated by <a class="reference internal" href="#chemsynthcalc.chemical_reaction.ChemicalReaction" title="chemsynthcalc.chemical_reaction.ChemicalReaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.chemical_reaction.ChemicalReaction</span></code></a> class</p></li>
<li><p><strong>product_matrix</strong> (<em>np.array</em>) -- matrix of products property generated by <a class="reference internal" href="#chemsynthcalc.chemical_reaction.ChemicalReaction" title="chemsynthcalc.chemical_reaction.ChemicalReaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">chemsynthcalc.chemical_reaction.ChemicalReaction</span></code></a> class</p></li>
<li><p><strong>coefficients</strong> (<em>list</em>) -- coefficients</p></li>
<li><p><strong>tolerance</strong> (<em>float</em>) -- tolerance limit for the <cite>np.allclose</cite> function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if balanced within tolerance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;NH4ClO4+HNO3+HCl=HClO4+NOCl+N2O+N2O3+H2O+Cl2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="o">.</span><span class="n">is_reaction_balanced</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">39</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;H2+O2=H2O&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="o">.</span><span class="n">is_reaction_balanced</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.round_up_coefficients">
<span class="sig-name descname"><span class="pre">round_up_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coefficients</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.round_up_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Round up the float coefficient to int.</p>
<p>Round up the float coefficient if it contains a series
of the same digit (i.e. 3.00000000009). This function is
needed to fix inevitable floating point math errors.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is probably a better and faster way to do it.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coefficients</strong> (<em>list</em>) -- List of coefficients to round</p></li>
<li><p><strong>order</strong> (<em>int</em>) -- rounding precision</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of rounded coefficients</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;P2O3+HClO3+H2O=H3PO4+HCl&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">round_up_coefficients</span><span class="p">([</span><span class="mf">1.500000000000001</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.500000000000002</span><span class="p">,</span> <span class="mf">3.0000000000000013</span><span class="p">,</span> <span class="mf">1.0000000000000002</span><span class="p">],</span> <span class="mi">8</span><span class="p">))</span>
<span class="go">[1.5, 1.0, 4.5, 3.0, 1.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.intify_coefficients">
<span class="sig-name descname"><span class="pre">intify_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coefficients</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.intify_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce the coefficients to integers by finding the greatest common divider.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coefficients</strong> (<em>list</em>) -- List of coefficients to intify</p></li>
<li><p><strong>limit</strong> (<em>int</em>) -- upper limit (max int coef)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of intified coefficients</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;P2O3+HClO3+H2O=H3PO4+HCl&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">intify_coefficients</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="mi">100000</span><span class="p">)</span>
<span class="go">[3, 2, 9, 6, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.inv_algorithm">
<span class="sig-name descname"><span class="pre">inv_algorithm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.inv_algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix inverse algorithm for reaction balancing.</p>
<p>A reaction matrix inverse algorithm proposed by <a class="reference external" href="https://arxiv.org/abs/1110.4321">Thorne</a>.
The calculation is based on the nullity, or dimensionality, of the matrix.</p>
<p>The algorithm can be described in steps:</p>
<ol class="arabic simple">
<li><p>If the number of rows is greater than the number of columns,         add zero columns until the matrix becomes square         (Note: this is a modification of the original         Thorne method described in the article).</p></li>
<li><p>If reaction matrix is square (which means that the number         of atoms involved is equal to the number of compounds) than         we turn matrix in its row-echelon form by singular value         decomposition.</p></li>
<li><p>Calculation of the nullity of the matrix, which is         basically number of compounds minus rank of the matrix.</p></li>
<li><p>Create a  matrix augumented by nullity number of rows         of flipped identity matrix. If any rows are zeros,         replace them with identity matrix rows.</p></li>
<li><p>Inverse the augumented matrix.</p></li>
<li><p>Exctract and transpose rightmost column.</p></li>
<li><p>Normalize this value with the absolute min value of the vector.</p></li>
<li><p>Round up float operations errors.</p></li>
</ol>
<p>The absolute values of this vector are coefficients of the
reaction.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While this method works great for reactions with 0 and 1
nullity, it generally cannot work with nullities 2 and higher.
Thorne claims that for higher nullities, a nullity number
of vectors should be extracted, and each of them contains
a set of correct coefficients. However, if number of rows in
augmentation flipped identity matrix is 2 or more, one can
easily see that each vector will contain nullity-1 zeroes,
therefore they cannot be a correct vector of coefficients.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of calculated coefficients</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;Bi2O3+TiO2=Bi4Ti3O12&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">inv_algorithm</span><span class="p">()</span>
<span class="go">[2.0, 3.0, 1.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;NH3+Br2=N2+NH4Br&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">inv_algorithm</span><span class="p">()</span>
<span class="go">[8.0, 3.0, 1.0, 6.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;Zn+H2S2O7=ZnSO4+H2S+H2O&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">inv_algorithm</span><span class="p">()</span>
<span class="go">[4.0, 2.5, 4.0, 1.0, 1.5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.gpinv_algorithm">
<span class="sig-name descname"><span class="pre">gpinv_algorithm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.gpinv_algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix gerenal pseudoinverse algorithm for reaction balancing.</p>
<p>A reaction matrix pseudoinverse algorithm
proposed by <a class="reference external" href="http://koreascience.or.kr/article/JAKO201314358624990.page">Risteski</a>.
There are other articles and methods of chemical
equation balancing by this author, however, this particular
algorithm seems to be most convenient for matrix calculations.
The algorithm can be described in steps:</p>
<ol class="arabic simple">
<li><p>Stack reactant matrix and negative product matrix.</p></li>
<li><p>Calculate MP pseudoinverse of this matrix.</p></li>
<li><p>Calculate coefficients by formula:         x = (I – A+A)a, where x is the coefficients vector,         I - identity matrix, A+ - MP inverse, A - matrix,         a - arbitrary vector (in this case, vector of ones).</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is more general than Thorne's method, although it has some
its own peculiarities. First of all, the output of this method is float,
so, to generate an int coefs list, it needs to be converted, which is
not always leads to a good result. Secondly, MP pseudoinverse
is sensetive to row order in the reaction matrix. The rows should
be ordered by atoms apperances in the reaction string.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of calculated coefficients</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;Bi2O3+TiO2=Bi4Ti3O12&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">gpinv_algorithm</span><span class="p">()</span>
<span class="go">[0.857142857142856, 1.285714285714286, 0.42857142857142894]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;NH3+Br2=N2+NH4Br&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">gpinv_algorithm</span><span class="p">()</span>
<span class="go">[1.3090909090909086, 0.49090909090909124, 0.16363636363636305, 0.9818181818181823]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;Zn+H2S2O7=ZnSO4+H2S+H2O&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">gpinv_algorithm</span><span class="p">()</span>
<span class="go">[1.2530120481927716, 0.7831325301204817, 1.253012048192771, 0.313253012048193, 0.4698795180722889]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.ppinv_algorithm">
<span class="sig-name descname"><span class="pre">ppinv_algorithm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.ppinv_algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix partial pseudoinverse algorithm for reaction balancing.</p>
<p>A reaction matrix pseudoinverse algorithm also
proposed by <a class="reference external" href="https://www.koreascience.or.kr/article/JAKO200802727293429.page">Risteski</a>.
The method is founded on virtue of the solution of a
Diophantine matrix equation by using of a Moore-Penrose
pseudoinverse matrix.</p>
<p>The algorithm can be described in steps:</p>
<ol class="arabic simple">
<li><p>Take the Moore-Penrose pseudoinverse of the reactant matrix.</p></li>
<li><p>Create a G matrix in the form of (I-AA^-)B, where         I is the identity matrix, A is the reactant matrix, A^- is         the MP pseudoinverse of A and B is the product matrix.</p></li>
<li><p>Then, the vector y (coefficients of products) is equal to         (I-G^-G)u.</p></li>
<li><p>Vector x (coefficients of reactants) is equal to         A^-By + (I-A^-A)v, where u and v are columns of ones.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While this algorithm and <a class="reference internal" href="#chemsynthcalc.reaction_balance.Balancer.gpinv_algorithm" title="chemsynthcalc.reaction_balance.Balancer.gpinv_algorithm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpinv_algorithm()</span></code></a> are
very similar, there are some differences in output results.
This method exists mostly for legacy purposes, like balancing
following reactions according to <a class="reference external" href="https://www.koreascience.or.kr/article/JAKO200802727293429.page">Risteski</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of calculated coefficients</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;PtNH3BrNO3+CuNH3KNO3+BeCO3=C44H50O14.98+Cu(NO3)2+PtO3+Br1.99NO2+K1.97O+BeO+HNO3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ppinv_algorithm</span><span class="p">()</span>
<span class="go">[0.13568057806893347, 0.5130378112503738, 1.533818182010022, 0.03485950413659115, 0.5130378112503766, 0.13568057806893571, 0.06818119500951737, 0.26042528489867056, 1.5338181820100212, 0.20317996112835507]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;PtNH3BrNO3+(Fe(CN)3)4(Fe(CN)2)3+C44H50O15+Cu(NO3)2+K2BeO2=CuNH3KNO3+BeCO3+K3.97Fe(CN)6+PtO2+Br1.96NO2+HNO3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ppinv_algorithm</span><span class="p">()</span>
<span class="go">[1.0653080872224086, 0.02084998005190298, 0.03200884162226492, 1.236558074626148, 0.9079895101341948, 1.2365580746261489, 0.9079895101341948, 0.145949860363285, 1.0653080872224083, 0.5435245342971473, 1.0866921189021224]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KAu(CN)2+AgRuAuTe8+Fe2(SO4)3+N2Se4+WO3+Na2CO3+H2CO3+HCl=[Ru(C10H8N2)3]Cl2*6H2O+C4H3AuNa1.96OS7+[WCl4(NSeCl)]2+K3.98Fe(CN)6+Au2O3+TeO3+AgO+NO2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ppinv_algorithm</span><span class="p">()</span>
<span class="go">[3.077274686056925, 0.071072198453605, 0.3865922972433353, 0.03396659573785036, 0.13586638295139766, 0.1623687648421996, 1.117085035989227, 0.8214763116641697, 0.07107219845360468, 0.16568241310428458, 0.06793319147569614, 0.7731845944866663, 1.491332235703123, 0.5685775876288415, 0.07107219845360557, 1.021075422996532]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_balance.Balancer.comb_algorithm">
<span class="sig-name descname"><span class="pre">comb_algorithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_number_of_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000000.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#chemsynthcalc.reaction_balance.Balancer.comb_algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix combinatorial algorithm for reaction balancing.</p>
<p>Finds a solution solution of a Diophantine matrix equation
by simply enumerating of all possible solutions of number_of_iterations
coefficients. The solution space is created by Cartesian product
(in this case, <cite>np.meshgrid</cite> function), and therefore it is very
limited by memory. There must a better, clever and fast solution
to this!</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Only for integer coefficients less than 128. Only for reactions
with total compound count &lt;=10.
A CuPy GPU-accelerated version of this method is available in the
source code.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All possible variations of coefficients vectors are
combinations = max_coefficients**number_of_compounds,
therefore this method is most effective for reaction with
small numbers of compounds.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of calculated coefficients</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;KMnO4+H2S+H2SO4=S+MnSO4+K2SO4+H2O&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">comb_algorithm</span><span class="p">()</span>
<span class="go">[2, 2, 2, 1, 2, 1, 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;H2O2+KNO3+H2SO4=K2SO4+NO+H2O+O2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">comb_algorithm</span><span class="p">()</span>
<span class="go">[1, 2, 1, 1, 2, 2, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reaction</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;Fe2O3+C=Fe3O4+FeO+Fe+Fe3C+CO+CO2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Balancer</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactant_matrix</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">product_matrix</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">comb_algorithm</span><span class="p">()</span>
<span class="go">[4, 5, 1, 1, 1, 1, 1, 3]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-chemsynthcalc.reaction_matrix">
<span id="chemsynthcalc-reaction-matrix-module"></span><h2>chemsynthcalc.reaction_matrix module<a class="headerlink" href="#module-chemsynthcalc.reaction_matrix" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_matrix.ChemicalReactionMatrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chemsynthcalc.reaction_matrix.</span></span><span class="sig-name descname"><span class="pre">ChemicalReactionMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_all</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemsynthcalc.reaction_matrix.ChemicalReactionMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class that creates a reaction matrix from parsed formulas of the parsed reaction string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_all</strong> (<em>list</em>) -- list of all parsed formulas</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_matrix.ChemicalReactionMatrix.merged_dict">
<span class="sig-name descname"><span class="pre">merged_dict</span></span><a class="headerlink" href="#chemsynthcalc.reaction_matrix.ChemicalReactionMatrix.merged_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>merged total dict of all parsed formulas</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_matrix.ChemicalReactionMatrix.electronegativity">
<span class="sig-name descname"><span class="pre">electronegativity</span></span><a class="headerlink" href="#chemsynthcalc.reaction_matrix.ChemicalReactionMatrix.electronegativity" title="Permalink to this definition">¶</a></dt>
<dd><p>list of (atom, electronegativity) tuples formed from <a class="reference internal" href="#module-chemsynthcalc.periodic_table" title="chemsynthcalc.periodic_table"><code class="xref py py-mod docutils literal notranslate"><span class="pre">chemsynthcalc.periodic_table</span></code></a> file</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_matrix.ChemicalReactionMatrix.electronegativity_pattern">
<span class="sig-name descname"><span class="pre">electronegativity_pattern</span></span><a class="headerlink" href="#chemsynthcalc.reaction_matrix.ChemicalReactionMatrix.electronegativity_pattern" title="Permalink to this definition">¶</a></dt>
<dd><p>list of atoms sorted by their Pauling electronegativities</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_matrix.ChemicalReactionMatrix.list_of_atoms">
<span class="sig-name descname"><span class="pre">list_of_atoms</span></span><a class="headerlink" href="#chemsynthcalc.reaction_matrix.ChemicalReactionMatrix.list_of_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>list of atoms from <a class="reference internal" href="#module-chemsynthcalc.periodic_table" title="chemsynthcalc.periodic_table"><code class="xref py py-mod docutils literal notranslate"><span class="pre">chemsynthcalc.periodic_table</span></code></a> file.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemsynthcalc.reaction_matrix.ChemicalReactionMatrix.create_reaction_matrix">
<span class="sig-name descname"><span class="pre">create_reaction_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.array</span></span></span><a class="headerlink" href="#chemsynthcalc.reaction_matrix.ChemicalReactionMatrix.create_reaction_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Create chemical reaction matrix.</p>
<p>Method that creates a chemical matrix of reaction from the list of
parsed compound. Initially contains a species type (atom label)
at the start of each row of matrix (might be used in case of future
expansion of matrix representation in print). Retruns 2D
NumPy array (since Matrix class is no longer recommended
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.matrix.html">https://numpy.org/doc/stable/reference/generated/numpy.matrix.html</a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the 2D array of chemical reaction matrix
(amounts of all atoms in all compounds of reaction)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parsed</span> <span class="o">=</span> <span class="n">ChemicalReaction</span><span class="p">(</span><span class="s2">&quot;H2+O2=H2O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">parsed_formulas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ChemicalReactionMatrix</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span><span class="o">.</span><span class="n">create_reaction_matrix</span><span class="p">()</span>
<span class="go">[[2. 0. 2.]</span>
<span class="go"> [0. 2. 1.]]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="license.html" class="btn btn-neutral float-right" title="License" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="API.html" class="btn btn-neutral float-left" title="API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Egor Syrov.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>